<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>pynever.strategies.abstraction API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../strategies.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pynever.strategies</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger_empty">logger_empty</a>
            </li>
            <li>
                    <a class="variable" href="#logger_lp">logger_lp</a>
            </li>
            <li>
                    <a class="variable" href="#logger_lb">logger_lb</a>
            </li>
            <li>
                    <a class="variable" href="#logger_ub">logger_ub</a>
            </li>
            <li>
                    <a class="variable" href="#parallel">parallel</a>
            </li>
            <li>
                    <a class="class" href="#AbsElement">AbsElement</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AbsElement.__init__">AbsElement</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Star">Star</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Star.__init__">Star</a>
                        </li>
                        <li>
                                <a class="variable" href="#Star.predicate_matrix">predicate_matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#Star.predicate_bias">predicate_bias</a>
                        </li>
                        <li>
                                <a class="variable" href="#Star.lbs">lbs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Star.ubs">ubs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Star.is_empty">is_empty</a>
                        </li>
                        <li>
                                <a class="function" href="#Star.check_if_empty">check_if_empty</a>
                        </li>
                        <li>
                                <a class="function" href="#Star.get_bounds">get_bounds</a>
                        </li>
                        <li>
                                <a class="function" href="#Star.check_alpha_inside">check_alpha_inside</a>
                        </li>
                        <li>
                                <a class="function" href="#Star.check_point_inside">check_point_inside</a>
                        </li>
                        <li>
                                <a class="function" href="#Star.get_samples">get_samples</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#StarSet">StarSet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StarSet.__init__">StarSet</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#intersect_with_halfspace">intersect_with_halfspace</a>
            </li>
            <li>
                    <a class="function" href="#mixed_single_relu_forward">mixed_single_relu_forward</a>
            </li>
            <li>
                    <a class="function" href="#single_fc_forward">single_fc_forward</a>
            </li>
            <li>
                    <a class="function" href="#sig">sig</a>
            </li>
            <li>
                    <a class="function" href="#sig_fod">sig_fod</a>
            </li>
            <li>
                    <a class="function" href="#area_sig_triangle">area_sig_triangle</a>
            </li>
            <li>
                    <a class="function" href="#single_sigmoid_forward">single_sigmoid_forward</a>
            </li>
            <li>
                    <a class="class" href="#RefinementState">RefinementState</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsLayerNode">AbsLayerNode</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AbsLayerNode.identifier">identifier</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsLayerNode.ref_node">ref_node</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsLayerNode.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsLayerNode.backward">backward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsFullyConnectedNode">AbsFullyConnectedNode</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AbsFullyConnectedNode.__init__">AbsFullyConnectedNode</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsFullyConnectedNode.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsFullyConnectedNode.backward">backward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsReLUNode">AbsReLUNode</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AbsReLUNode.__init__">AbsReLUNode</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsReLUNode.heuristic">heuristic</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsReLUNode.params">params</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsReLUNode.layer_bounds">layer_bounds</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsReLUNode.n_areas">n_areas</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsReLUNode.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsReLUNode.backward">backward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsSigmoidNode">AbsSigmoidNode</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AbsSigmoidNode.__init__">AbsSigmoidNode</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsSigmoidNode.approx_levels">approx_levels</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSigmoidNode.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSigmoidNode.backward">backward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsNeuralNetwork">AbsNeuralNetwork</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AbsNeuralNetwork.nodes">nodes</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsNeuralNetwork.edges">edges</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsNeuralNetwork.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsNeuralNetwork.backward">backward</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsSeqNetwork">AbsSeqNetwork</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AbsSeqNetwork.__init__">AbsSeqNetwork</a>
                        </li>
                        <li>
                                <a class="variable" href="#AbsSeqNetwork.identifier">identifier</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSeqNetwork.add_node">add_node</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSeqNetwork.get_first_node">get_first_node</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSeqNetwork.get_next_node">get_next_node</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSeqNetwork.get_last_node">get_last_node</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSeqNetwork.forward">forward</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsSeqNetwork.backward">backward</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../pynever.html">pynever</a><wbr>.<a href="./../strategies.html">strategies</a><wbr>.abstraction    </h1>

                
                        <input id="mod-abstraction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-abstraction-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">import</span> <span class="nn">abc</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="kn">import</span> <span class="nn">itertools</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">import</span> <span class="nn">multiprocessing</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">uuid</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Set</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="k">as</span> <span class="nn">la</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">ortools.linear_solver</span> <span class="kn">import</span> <span class="n">pywraplp</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span> <span class="nn">pynever.nodes</span> <span class="k">as</span> <span class="nn">nodes</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span> <span class="nn">pynever.strategies.bp.bounds</span> <span class="kn">import</span> <span class="n">AbstractBounds</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">pynever.tensor</span> <span class="kn">import</span> <span class="n">Tensor</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="n">logger_empty</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;pynever.strategies.abstraction.empty_times&quot;</span><span class="p">)</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="n">logger_lp</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;pynever.strategies.abstraction.lp_times&quot;</span><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="n">logger_lb</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;pynever.strategies.abstraction.lb_times&quot;</span><span class="p">)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="n">logger_ub</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;pynever.strategies.abstraction.ub_times&quot;</span><span class="p">)</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="n">parallel</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="k">class</span> <span class="nc">AbsElement</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">    An abstract class used for our internal representation of a generic Abstract Element (e.g., interval, zonotope,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">    polyhedra etc.)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">    Attributes</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">    ----------</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">    identifier : str</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">        Identifier of the AbsElement.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="k">class</span> <span class="nc">Star</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">    A concrete class used for our internal representation of a Star.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">    The Star is defined as {x | x = c + Va such that Ca &lt;= d}</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">    where c is a n-dimensional vector corresponding to the center of the Star.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">    V is the n-by-m matrix composed by the basis vectors.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">    a is the vector of m variables, C (p-by-m) and d (p-dim) are the matrix and the biases</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">    defining a set of constraints.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">    We refer to &lt;Star-Based Reachability Analysis of Deep Neural Networks&gt;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">    (https://link.springer.com/chapter/10.1007/978-3-030-30942-8_39) for details.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">    Attributes</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">    ----------</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">    center : Tensor</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">        Center of the Star.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">    basis_matrix : Tensor</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">        Matrix composed by the basis vectors of the Star</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">    predicate_matrix : Tensor</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">        Matrix of the Predicate.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    predicate_bias : Tensor</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">        Bias of the Predicate.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">    ubs : list</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">        Upper bounds of the points defined by the Star.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    lbs : list</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">        Lower bounds of the points defined by the Star.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">    is_empty : bool</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">        Boolean flag: True if the Star defines an empty set of points, False otherwise</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    Methods</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    ----------</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    get_bounds()</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">        Function used to get the upper and lower bounds of the n variables of the star.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    check_if_empty()</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">        Function used to check if the star corresponds to an empty set.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate_matrix</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">predicate_bias</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>                 <span class="n">basis_matrix</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>        <span class="n">predicate_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the first dimension of the predicate_matrix (</span><span class="si">{</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>                                <span class="sa">f</span><span class="s2">&quot;must be equal to the dimension of the predicate_bias (</span><span class="si">{</span><span class="n">predicate_bias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="k">assert</span> <span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">predicate_bias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">predicate_dim_message</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span> <span class="o">=</span> <span class="n">predicate_matrix</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span> <span class="o">=</span> <span class="n">predicate_bias</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>        <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">basis_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>            <span class="n">center_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the first dimension of the basis_matrix (</span><span class="si">{</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>                                 <span class="sa">f</span><span class="s2">&quot;must be equal to the dimension of the center (</span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>            <span class="k">assert</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">center_dim_message</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>            <span class="n">basis_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the second dimension of the basis_matrix (</span><span class="si">{</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>                                <span class="sa">f</span><span class="s2">&quot;must be equal to the second dimension of the predicate_matrix &quot;</span> \
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>                                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>            <span class="k">assert</span> <span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">basis_dim_message</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span> <span class="o">=</span> <span class="n">basis_matrix</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="n">is_empty</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>        <span class="c1"># Private Attributes used for the sampling of the star.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="k">def</span> <span class="nf">check_if_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">        Function used to check if the set of points defined by the star is empty.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">        Return</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">        ---------</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">        bool</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">            True if the star defines an empty set of points, False otherwise.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">INFEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">ABNORMAL</span><span class="p">:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="n">logger_empty</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>    <span class="k">def</span> <span class="nf">get_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">        Function used to get the upper and lower bounds of the n variables of the star.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        Return</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        ---------</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        (float, float)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variable i of the star</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>            <span class="c1"># print(&quot;Computing bounds&quot;)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>            <span class="n">lb_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>            <span class="n">lb_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">INFEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">ABNORMAL</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>                <span class="n">ub_end</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>                <span class="n">ub_start</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>                <span class="n">lb</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>                <span class="n">ub_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>                <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>                <span class="n">ub_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>                <span class="n">ub</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lb</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ub</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>            <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>            <span class="n">logger_lp</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>            <span class="n">logger_lb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ub_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ub_start</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>            <span class="n">logger_ub</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lb_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lb_start</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>    <span class="k">def</span> <span class="nf">check_alpha_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_point</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        Function which checks if the alpha point passed as input is valid with respect to the constraints defined by the</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        predicate matrix and bias of the star.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        Parameters</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        ----------</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">        alpha_point : Tensor</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">            Point (with respect ot the predicate variables) whose validity is to test.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        Returns</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">        -------</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">        bool</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">            The result of the check as a boolean (True if the point is valid, False otherwise)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>        <span class="n">dim_error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Wrong dimensionality for alpha_point: it should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> by one.&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>        <span class="k">assert</span> <span class="n">alpha_point</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dim_error_msg</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>        <span class="n">tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">alpha_point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>        <span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tests</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="k">return</span> <span class="n">test</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>    <span class="k">def</span> <span class="nf">check_point_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">        Function which checks if the point passed as input is valid with respect to the constraints defined by the</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        predicate matrix and bias of the star.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        Parameters</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">        ----------</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">        point : Tensor</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">            Point whose validity is to test.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">        epsilon : float</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">            Acceptable deviation from real point.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        Returns</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        -------</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        bool</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">            The result of the check as a boolean (True if the point is valid, False otherwise)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">epsilon</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsilon</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="k">return</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">FEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>    <span class="k">def</span> <span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reset_auxiliary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">new_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="c1"># As first thing we need to get a valid starting point:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_if_empty</span><span class="p">():</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">reset_auxiliary</span><span class="p">:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>            <span class="n">auxiliary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_auxiliary_points</span><span class="p">()</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>            <span class="n">auxiliary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new_start</span><span class="p">:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>            <span class="n">starting_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_starting_point</span><span class="p">()</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>            <span class="n">current_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>            <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="c1"># We begin the iterative process to generate the samples of interest.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>        <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_samples</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>            <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>            <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">/</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>            <span class="n">lambdas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">direction</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>                    <span class="n">lambdas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>                    <span class="n">temp</span> <span class="o">=</span> <span class="n">auxiliary_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_point</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>                    <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>                                                                                    <span class="n">direction</span><span class="p">))</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>                    <span class="n">lambdas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>            <span class="n">lambdas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lambdas</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>                <span class="n">lam_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lambdas</span><span class="p">[</span><span class="n">lambdas</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>                <span class="n">lam_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lambdas</span><span class="p">[</span><span class="n">lambdas</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The current direction does not intersect&quot;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>                                   <span class="s2">&quot;any of the hyperplanes.&quot;</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>            <span class="n">increment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">lam_lower</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">lam_upper</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>            <span class="n">next_point</span> <span class="o">=</span> <span class="n">current_point</span> <span class="o">+</span> <span class="n">increment</span> <span class="o">*</span> <span class="n">direction</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_alpha_inside</span><span class="p">(</span><span class="n">next_point</span><span class="p">):</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>                <span class="n">current_point</span> <span class="o">=</span> <span class="n">next_point</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>                <span class="n">star_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">,</span> <span class="n">current_point</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>                <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">star_point</span><span class="p">)</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="o">=</span> <span class="n">current_point</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="k">return</span> <span class="n">samples</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>    <span class="k">def</span> <span class="nf">__get_auxiliary_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">        Function which returns the auxiliary points for each plane of the predicate.</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">        Returns</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">        -------</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        List[Tensor]</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">            List of the auxiliary points: one for each plane of the predicate.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="n">aux_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>            <span class="n">plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>            <span class="n">max_nonzero_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">plane</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>            <span class="n">p</span><span class="p">[</span><span class="n">max_nonzero_index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">plane</span><span class="p">[</span><span class="n">max_nonzero_index</span><span class="p">]</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="n">aux_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="k">return</span> <span class="n">aux_points</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="k">def</span> <span class="nf">__get_starting_point_by_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        Function used to get the starting point for the hit and run algorithm.</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        Return</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">        ---------</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        (float, float)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variables of the predicate</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>                    <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>                    <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>            <span class="n">starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">lb</span> <span class="o">+</span> <span class="n">ub</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">])</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="k">return</span> <span class="n">starting_point</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>    <span class="k">def</span> <span class="nf">__get_starting_point</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">        Function used to get the starting point for the hit and run algorithm.</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        Return</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        ---------</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">        (float, float)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variables of the predicate</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;radius&#39;</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>            <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:],</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;It was impossible to compute the Chebyshev center of the predicate.&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>        <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>            <span class="c1"># print(alpha.solution_value())</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>            <span class="n">starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">alpha</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()])</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>        <span class="c1"># print(radius.solution_value())</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="k">return</span> <span class="n">starting_point</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>    <span class="k">def</span> <span class="nf">__get_predicate_lp_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a><span class="sd">        Creates an lp solver using pywraplp and adds the variables and constraints</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a><span class="sd">        corresponding to the predicate of the star.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a><span class="sd">        Returns</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a><span class="sd">        ---------</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a><span class="sd">        (pywraplp.Solver, list, list)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a><span class="sd">            Respectively the lp solver, the variables and the constraints.</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="k">return</span> <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="k">class</span> <span class="nc">StarSet</span><span class="p">(</span><span class="n">AbsElement</span><span class="p">):</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">    Concrete class for our internal representation of a StarSet abstract element. A StarSet consist in a set</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">    of Star objects.</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a><span class="sd">    Attributes</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">    ----------</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="sd">    stars : Set[Star]</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">        Set of Star objects.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stars</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="n">stars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">stars</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="k">def</span> <span class="nf">intersect_with_halfspace</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">coef_mat</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bias_mat</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Star</span><span class="p">:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">    Function which takes as input a Star and a halfspace defined by its coefficient matrix and bias vector</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">    and returns the Star resulting from the intersection of the input Star with the halfspace.</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>    <span class="n">new_center</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>    <span class="n">new_basis_matrix</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>    <span class="n">hs_pred_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">coef_mat</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>    <span class="n">hs_pred_bias</span> <span class="o">=</span> <span class="n">bias_mat</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">coef_mat</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>    <span class="n">new_pred_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">hs_pred_matrix</span><span class="p">))</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>    <span class="n">new_pred_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">,</span> <span class="n">hs_pred_bias</span><span class="p">))</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>    <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_pred_matrix</span><span class="p">,</span> <span class="n">new_pred_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_matrix</span><span class="p">)</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>    <span class="k">return</span> <span class="n">new_star</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="k">def</span> <span class="nf">__mixed_step_relu</span><span class="p">(</span><span class="n">abs_input</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">],</span> <span class="n">var_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">refinement_flag</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>                      <span class="n">symb_lb</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">symb_ub</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>    <span class="n">abs_input</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>    <span class="n">abs_output</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>    <span class="n">guard</span> <span class="o">=</span> <span class="mf">10e-15</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>    <span class="k">if</span> <span class="n">symb_lb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="n">symb_lb</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>    <span class="k">if</span> <span class="n">symb_ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="n">symb_ub</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)):</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>        <span class="n">is_pos_stable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        <span class="n">is_neg_stable</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="n">star</span> <span class="o">=</span> <span class="n">abs_input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>        <span class="c1"># Check abstract bounds for stability</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>        <span class="k">if</span> <span class="n">symb_lb</span> <span class="o">&gt;=</span> <span class="n">guard</span><span class="p">:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>            <span class="n">is_pos_stable</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="k">elif</span> <span class="n">symb_ub</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">guard</span><span class="p">:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>            <span class="n">is_neg_stable</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>            <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">var_index</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">star</span><span class="o">.</span><span class="n">is_empty</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="n">mask</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="n">var_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>            <span class="k">if</span> <span class="n">is_pos_stable</span> <span class="ow">or</span> <span class="p">(</span><span class="n">lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lb</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>                <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="n">star</span><span class="p">})</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>            <span class="k">elif</span> <span class="n">is_neg_stable</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ub</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>                <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>                <span class="n">new_basis_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>                <span class="n">new_pred_mat</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                <span class="n">new_pred_bias</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_pred_mat</span><span class="p">,</span> <span class="n">new_pred_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_mat</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="n">new_star</span><span class="p">})</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>                <span class="k">if</span> <span class="n">refinement_flag</span><span class="p">:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>                    <span class="c1"># Creating lower bound star.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>                    <span class="n">lower_star_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                    <span class="n">lower_star_basis_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>                    <span class="c1"># Adding x &lt;= 0 constraints to the predicate.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>                    <span class="n">lower_predicate_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]))</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>                    <span class="n">lower_predicate_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">,</span> <span class="o">-</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]))</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>                    <span class="n">lower_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">lower_predicate_matrix</span><span class="p">,</span> <span class="n">lower_predicate_bias</span><span class="p">,</span> <span class="n">lower_star_center</span><span class="p">,</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>                                      <span class="n">lower_star_basis_mat</span><span class="p">)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>                    <span class="c1"># Creating upper bound star.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>                    <span class="n">upper_star_center</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>                    <span class="n">upper_star_basis_mat</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>                    <span class="c1"># Adding x &gt;= 0 constraints to the predicate.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>                    <span class="n">upper_predicate_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="o">-</span><span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]))</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>                    <span class="n">upper_predicate_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]))</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>                    <span class="n">upper_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">upper_predicate_matrix</span><span class="p">,</span> <span class="n">upper_predicate_bias</span><span class="p">,</span> <span class="n">upper_star_center</span><span class="p">,</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>                                      <span class="n">upper_star_basis_mat</span><span class="p">)</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>                    <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="n">lower_star</span><span class="p">,</span> <span class="n">upper_star</span><span class="p">})</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>                    <span class="n">col_c_mat</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>                    <span class="n">row_c_mat</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                    <span class="n">c_mat_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_c_mat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>                    <span class="n">c_mat_1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_c_mat</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>                    <span class="n">c_mat_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>                    <span class="n">coef_3</span> <span class="o">=</span> <span class="o">-</span> <span class="n">ub</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>                    <span class="n">c_mat_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">coef_3</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>                    <span class="n">c_mat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">row_c_mat</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>                    <span class="n">d_0</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>                    <span class="n">d_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>                    <span class="n">d_2</span> <span class="o">=</span> <span class="o">-</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>                    <span class="n">d_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">ub</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)])</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>                    <span class="n">new_pred_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">c_mat_0</span><span class="p">,</span> <span class="n">c_mat_1</span><span class="p">,</span> <span class="n">c_mat_2</span><span class="p">,</span> <span class="n">c_mat_3</span><span class="p">))</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>                    <span class="n">new_pred_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">d_0</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">d_3</span><span class="p">))</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                    <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>                    <span class="n">temp_basis_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>                    <span class="n">temp_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                    <span class="n">temp_vec</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                    <span class="n">new_basis_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">temp_basis_mat</span><span class="p">,</span> <span class="n">temp_vec</span><span class="p">))</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>                    <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_pred_mat</span><span class="p">,</span> <span class="n">new_pred_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_mat</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>                    <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="n">new_star</span><span class="p">})</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>    <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="k">def</span> <span class="nf">mixed_single_relu_forward</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">layer_bounds</span><span class="p">:</span> <span class="n">AbstractBounds</span><span class="p">)</span> \
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>        <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">    Utility function for the management of the forward for AbsReLUNode. It is outside</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="sd">    the class scope since multiprocessing does not support parallelization with</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">    function internal to classes.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>    <span class="k">assert</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;given_flags&quot;</span> <span class="ow">or</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons&quot;</span> <span class="ow">or</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons_rel&quot;</span><span class="p">,</span> \
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>        <span class="s2">&quot;Heuristic Selected is not valid&quot;</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>    <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="p">{</span><span class="n">star</span><span class="p">}</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>    <span class="k">if</span> <span class="n">star</span><span class="o">.</span><span class="n">check_if_empty</span><span class="p">():</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="p">(),</span> <span class="kc">None</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>        <span class="n">n_areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>            <span class="k">if</span> <span class="n">layer_bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_lower</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_upper</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>                <span class="n">n_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>                <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                <span class="n">n_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">lb</span> <span class="o">*</span> <span class="n">ub</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="n">n_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_areas</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="k">if</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons&quot;</span> <span class="ow">or</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons_rel&quot;</span><span class="p">:</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>            <span class="n">n_neurons</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>            <span class="k">if</span> <span class="n">n_neurons</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>                <span class="c1"># We compute the ordered indexes of the neurons with decreasing values of the areas.</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>                <span class="c1"># Our idea is that a greater value for the area correspond to greater loss of precision if the</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                <span class="c1"># star is not refined for the corresponding neuron.</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                <span class="k">if</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons_rel&quot;</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>                    <span class="n">relevances</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>                    <span class="n">n_areas</span> <span class="o">=</span> <span class="n">n_areas</span> <span class="o">*</span> <span class="n">relevances</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>                <span class="n">sorted_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">n_areas</span><span class="p">))</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>                <span class="n">index_to_refine</span> <span class="o">=</span> <span class="n">sorted_indexes</span><span class="p">[:</span><span class="n">n_neurons</span><span class="p">]</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>                <span class="n">index_to_refine</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>            <span class="n">refinement_flags</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_to_refine</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                    <span class="n">refinement_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>                    <span class="n">refinement_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="k">elif</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;given_flags&quot;</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>            <span class="n">refinement_flags</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="k">if</span> <span class="n">layer_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>                <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="n">__mixed_step_relu</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">refinement_flags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>                <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="n">__mixed_step_relu</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">refinement_flags</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>                                                   <span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_lower</span><span class="p">()[</span><span class="n">i</span><span class="p">],</span> <span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_upper</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>        <span class="k">return</span> <span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">n_areas</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="k">def</span> <span class="nf">single_fc_forward</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">    Utility function for the management of the forward for AbsFullyConnectedNode. It is outside</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">    the class scope since multiprocessing does not support parallelization with</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">    function internal to classes.</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>    <span class="k">assert</span> <span class="p">(</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>    <span class="n">new_basis_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>    <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span> <span class="o">+</span> <span class="n">bias</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>    <span class="n">new_predicate_matrix</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>    <span class="n">new_predicate_bias</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>    <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_predicate_matrix</span><span class="p">,</span> <span class="n">new_predicate_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_matrix</span><span class="p">)</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>    <span class="k">return</span> <span class="p">{</span><span class="n">new_star</span><span class="p">}</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="k">def</span> <span class="nf">sig</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">    Utility function computing the logistic function of the input.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="k">def</span> <span class="nf">sig_fod</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">    Utility function computing the first order derivative of the logistic function of the input.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="k">def</span> <span class="nf">area_sig_triangle</span><span class="p">(</span><span class="n">lb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ub</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a><span class="sd">    Utility function computing the area of the triangle defined by an upper bound and a lower bound on the</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">    logistic function. In particular is the triangle composed by the two tangents and line passing by the two bounds.</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>    <span class="n">x_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span> <span class="o">*</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">lb</span> <span class="o">*</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">-</span> \
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>          <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>    <span class="n">y_p</span> <span class="o">=</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">ub</span><span class="p">)</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="n">height</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_p</span> <span class="o">-</span> <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_p</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">-</span> <span class="n">lb</span> <span class="o">*</span> <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">))</span> <span class="o">/</span> \
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>             <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">((</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>    <span class="n">base</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>    <span class="k">return</span> <span class="n">base</span> <span class="o">*</span> <span class="n">height</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="k">def</span> <span class="nf">__recursive_step_sigmoid</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">var_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">approx_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ub</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> \
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>        <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>    <span class="k">assert</span> <span class="n">approx_level</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>        <span class="k">if</span> <span class="n">ub</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>            <span class="k">if</span> <span class="n">ub</span> <span class="o">+</span> <span class="n">tolerance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                <span class="n">ub</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>                <span class="n">ub</span> <span class="o">=</span> <span class="n">ub</span> <span class="o">+</span> <span class="n">tolerance</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span> <span class="o">-</span> <span class="n">tolerance</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="k">if</span> <span class="n">lb</span> <span class="o">-</span> <span class="n">tolerance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>                <span class="n">lb</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>                <span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span> <span class="o">-</span> <span class="n">tolerance</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">ub</span> <span class="o">+</span> <span class="n">tolerance</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>    <span class="k">assert</span> <span class="p">(</span><span class="n">lb</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ub</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">lb</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ub</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>    <span class="n">mask</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="n">var_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>    <span class="k">if</span> <span class="n">approx_level</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="k">if</span> <span class="n">lb</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ub</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>            <span class="n">c_mat_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>            <span class="n">c_mat_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>            <span class="n">coef_3</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>            <span class="n">c_mat_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">coef_3</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>            <span class="n">d_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)])</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>            <span class="n">d_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)])</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>            <span class="n">d_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">coef_3</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)])</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>            <span class="n">c_mat_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>            <span class="n">c_mat_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="n">coef_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>            <span class="n">c_mat_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">coef_3</span> <span class="o">*</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="p">:]]),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>            <span class="n">d_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)])</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>            <span class="n">d_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">ub</span><span class="p">)</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)])</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>            <span class="n">d_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">coef_3</span> <span class="o">*</span> <span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)])</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>        <span class="n">col_c_mat</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="c1"># Adding lb and ub bounds to enhance stability</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>        <span class="n">c_mat_lb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_c_mat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="n">c_mat_lb</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_c_mat</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>        <span class="n">d_lb</span> <span class="o">=</span> <span class="o">-</span><span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">c_mat_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_c_mat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="n">c_mat_ub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_c_mat</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="n">d_ub</span> <span class="o">=</span> <span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="n">row_c_mat</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>        <span class="n">c_mat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">row_c_mat</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="n">d_0</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="n">new_pred_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">c_mat_0</span><span class="p">,</span> <span class="n">c_mat_1</span><span class="p">,</span> <span class="n">c_mat_2</span><span class="p">,</span> <span class="n">c_mat_3</span><span class="p">,</span> <span class="n">c_mat_lb</span><span class="p">,</span> <span class="n">c_mat_ub</span><span class="p">))</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>        <span class="n">new_pred_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">d_0</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">d_3</span><span class="p">,</span> <span class="n">d_lb</span><span class="p">,</span> <span class="n">d_ub</span><span class="p">))</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="n">temp_basis_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="n">temp_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>        <span class="n">temp_vec</span><span class="p">[</span><span class="n">var_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="n">new_basis_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">temp_basis_mat</span><span class="p">,</span> <span class="n">temp_vec</span><span class="p">))</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_pred_mat</span><span class="p">,</span> <span class="n">new_pred_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_mat</span><span class="p">)</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">new_star</span><span class="p">}</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>        <span class="c1"># We need to select the boundary between lb and ub. The optimal boundary is the one which minimizes the</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="c1"># area of the two resulting triangle. Since computing the optimal is too slow we do an approximate search</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="c1"># between lb and ub considering s search points.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>        <span class="n">num_search_points</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        <span class="n">boundaries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">num_search_points</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>        <span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>        <span class="n">best_boundary</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="n">smallest_area</span> <span class="o">=</span> <span class="mi">99999999</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>        <span class="k">for</span> <span class="n">boundary</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>            <span class="n">area_1</span> <span class="o">=</span> <span class="n">area_sig_triangle</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">boundary</span><span class="p">)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>            <span class="n">area_2</span> <span class="o">=</span> <span class="n">area_sig_triangle</span><span class="p">(</span><span class="n">boundary</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="k">if</span> <span class="n">area_1</span> <span class="o">+</span> <span class="n">area_2</span> <span class="o">&lt;</span> <span class="n">smallest_area</span><span class="p">:</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>                <span class="n">smallest_area</span> <span class="o">=</span> <span class="n">area_1</span> <span class="o">+</span> <span class="n">area_2</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>                <span class="n">best_boundary</span> <span class="o">=</span> <span class="n">boundary</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="n">star_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>        <span class="n">star_set</span> <span class="o">=</span> <span class="n">star_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>            <span class="n">__recursive_step_sigmoid</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">var_index</span><span class="p">,</span> <span class="n">approx_level</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">best_boundary</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">))</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="n">star_set</span> <span class="o">=</span> <span class="n">star_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>            <span class="n">__recursive_step_sigmoid</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">var_index</span><span class="p">,</span> <span class="n">approx_level</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">best_boundary</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">))</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>        <span class="k">return</span> <span class="n">star_set</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="k">def</span> <span class="nf">__approx_step_sigmoid</span><span class="p">(</span><span class="n">abs_input</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">],</span> <span class="n">var_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">approx_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>    <span class="n">abs_output</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>    <span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">abs_input</span><span class="p">:</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">star</span><span class="o">.</span><span class="n">check_if_empty</span><span class="p">():</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>            <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">var_index</span><span class="p">)</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">lb</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ub</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>                <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">__recursive_step_sigmoid</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">var_index</span><span class="p">,</span> <span class="n">approx_level</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>                                                                       <span class="n">tolerance</span><span class="p">))</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">__recursive_step_sigmoid</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">var_index</span><span class="p">,</span> <span class="n">approx_level</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>                                                                       <span class="n">tolerance</span><span class="p">))</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>                <span class="n">abs_output</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">__recursive_step_sigmoid</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="n">var_index</span><span class="p">,</span> <span class="n">approx_level</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>                                                                       <span class="n">ub</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">))</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>    <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="k">def</span> <span class="nf">single_sigmoid_forward</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">    Utility function for the management of the forward for AbsSigmoidNode. It is outside</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">    the class scope since multiprocessing does not support parallelization with</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">    function internal to classes.</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>    <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.01</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>    <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="p">{</span><span class="n">star</span><span class="p">}</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>        <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="n">__approx_step_sigmoid</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tolerance</span><span class="p">)</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, NumStar: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>    <span class="k">return</span> <span class="n">temp_abs_input</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="k">class</span> <span class="nc">RefinementState</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">    A class used for the internal control of the refinement strategies/heuristics applied in the abstraction refinement</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">    step. At present is not still used and it is just an abstract placeholder. It will be used in future</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">    implementations.</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>    <span class="k">pass</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="k">class</span> <span class="nc">AbsLayerNode</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">    An abstract class used for our internal representation of a generic Abstract Transformer Layer of an</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">    AbsNeural Network. Its concrete children correspond to real abstract interpretation network layers.</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">    Attributes</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">    ----------</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">    identifier : str</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">        Identifier of the AbsLayerNode.</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">    ref_node : SingleInputLayerNode</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a><span class="sd">        Reference SingleInputLayerNode for the abstract transformer.</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a><span class="sd">    Methods</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">    ----------</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">        transformer.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">SingleInputLayerNode</span><span class="p">):</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span> <span class="o">=</span> <span class="n">ref_node</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">        Parameters</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a><span class="sd">        ----------</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">            The input abstract element.</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="sd">        Returns</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">        ----------</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="sd">        AbsElement</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>        <span class="k">pass</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">        Parameters</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">        ----------</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>        <span class="k">pass</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="k">class</span> <span class="nc">AbsFullyConnectedNode</span><span class="p">(</span><span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">    A class used for our internal representation of a Fully Connected Abstract transformer.</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">    Attributes</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">    ----------</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a><span class="sd">    identifier : str</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a><span class="sd">        Identifier of the SingleInputLayerNode.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">    ref_node : FullyConnectedNode</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="sd">        SingleInputLayerNode di riferimento per l&#39;abstract transformer.</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">    Methods</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="sd">    ----------</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">        transformer.</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FullyConnectedNode</span><span class="p">):</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">        Parameters</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">        ----------</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">            The input abstract element.</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">        Returns</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">        ----------</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">        AbsElement</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">            </span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>    <span class="k">def</span> <span class="nf">__starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="n">my_pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>        <span class="c1"># Need to expand bias since they are memorized like one-dimensional vectors in FC nodes.</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>            <span class="n">bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">bias</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="n">parallel_results</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">single_fc_forward</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">,</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>                                                                  <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">weight</span><span class="p">),</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>                                                                  <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">bias</span><span class="p">)))</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="n">my_pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>        <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>        <span class="k">for</span> <span class="n">star_set</span> <span class="ow">in</span> <span class="n">parallel_results</span><span class="p">:</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>            <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">star_set</span><span class="p">)</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        Parameters</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">        ----------</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>        <span class="k">pass</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="k">class</span> <span class="nc">AbsReLUNode</span><span class="p">(</span><span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">    A class used for our internal representation of a ReLU Abstract transformer.</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">    Attributes</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">    ----------</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">    identifier : str</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">        Identifier of the SingleInputLayerNode.</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">    ref_node : ReLUNode</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        Reference SingleInputLayerNode for the abstract transformer.</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">    heuristic : str</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">        Heuristic used to decide the refinement level of the abstraction.</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">        At present can be only one of the following:</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">        - complete: for each star all the neurons are processed with a precise abstraction</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">        - mixed: for each star a given number of neurons is processed with a precise abstraction</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">        - overapprox: for each star all the neurons are processed with a coarse abstraction</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">    params : List</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">        Parameters for the heuristic of interest.</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">        It is a List with the number of neurons to process with a precise abstraction in this layer.</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">    Methods</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">    ----------</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">        transformer.</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ReLUNode</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span> <span class="o">=</span> <span class="n">heuristic</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">AbstractBounds</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">        Parameters</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a><span class="sd">        ----------</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">            The input abstract element.</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">        bounds : dict</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="sd">            Optional bounds for this layer as computed by the previous</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">        Returns</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">        ----------</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        AbsElement</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span> <span class="o">=</span> <span class="n">bounds</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>            <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parallel_starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="sd">        Parameters</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a><span class="sd">        ----------</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>        <span class="k">pass</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>    <span class="k">def</span> <span class="nf">__parallel_starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>        <span class="n">my_pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>        <span class="n">parallel_results</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">mixed_single_relu_forward</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">,</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>                                                                          <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span><span class="p">),</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>                                                                          <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>                                                                          <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span><span class="p">)))</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>        <span class="n">my_pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>        <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>        <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">)</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>        <span class="n">num_areas</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>        <span class="k">for</span> <span class="n">star_set</span><span class="p">,</span> <span class="n">areas</span> <span class="ow">in</span> <span class="n">parallel_results</span><span class="p">:</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>            <span class="k">if</span> <span class="n">star_set</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>                <span class="n">num_areas</span> <span class="o">=</span> <span class="n">num_areas</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>                <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">+</span> <span class="n">areas</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>            <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">star_set</span><span class="p">)</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">/</span> <span class="n">num_areas</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>    <span class="k">def</span> <span class="nf">__starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">        Forward function specialized for the concrete AbsElement StarSet.</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>        <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>        <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">)</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>        <span class="n">num_areas</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>        <span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">:</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>            <span class="n">result</span><span class="p">,</span> <span class="n">areas</span> <span class="o">=</span> <span class="n">mixed_single_relu_forward</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span><span class="p">)</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>            <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>            <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">+</span> <span class="n">areas</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>            <span class="n">num_areas</span> <span class="o">=</span> <span class="n">num_areas</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">/</span> <span class="n">num_areas</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="k">class</span> <span class="nc">AbsSigmoidNode</span><span class="p">(</span><span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">    A class used for our internal representation of a Sigmoid transformer.</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="sd">    Attributes</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a><span class="sd">    ----------</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="sd">    identifier : str</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        Identifier of the SingleInputLayerNode.</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a><span class="sd">    ref_node : SigmoidNode</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="sd">        SingleInputLayerNode di riferimento per l&#39;abstract transformer.</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="sd">    refinement_level : Union[int, List[int]]</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">        Refinement level for the sigmoid nodes: if it is a single int then that refinement level is applied to all</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="sd">        the neurons of the layers, otherwise it is a list containing the refinement levels for each layers.</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">    Methods</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a><span class="sd">    ----------</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">        transformer.</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">SigmoidNode</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="k">if</span> <span class="n">approx_levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>            <span class="n">approx_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">approx_levels</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>            <span class="n">approx_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">approx_levels</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span> <span class="o">=</span> <span class="n">approx_levels</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">        Parameters</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">        ----------</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">            The input abstract element.</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">        Returns</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        ----------</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">        AbsElement</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>    <span class="k">def</span> <span class="nf">__starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="c1"># parallel = True</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>        <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>            <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>            <span class="n">my_pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>            <span class="n">parallel_results</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">single_sigmoid_forward</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">,</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>                                                                           <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span><span class="p">)))</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>            <span class="n">my_pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>            <span class="k">for</span> <span class="n">star_set</span> <span class="ow">in</span> <span class="n">parallel_results</span><span class="p">:</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>                <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">star_set</span><span class="p">)</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>            <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>            <span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">:</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>                <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">single_sigmoid_forward</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span><span class="p">))</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">        Parameters</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a><span class="sd">        ----------</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>        <span class="k">pass</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="k">class</span> <span class="nc">AbsNeuralNetwork</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">    An abstract class used for our internal representation of a generic NeuralNetwork for Abstract Interpretation.</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">    It consists of a graph of AbsLayerNodes. The properties of the computational graph are specialized in the</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">    concrete classes. The method forward and backward calls the corresponding methods in the AbsLayerNodes following the</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">    correct order to compute the output AbsElement.</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">    Attributes</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">    ----------</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">    nodes : dict &lt;str, SingleInputLayerNode&gt;</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">        Dictionary containing str keys and AbsLayerNodes values. It contains the nodes of the graph,</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">        the identifier of the node of interest is used as a key in the nodes dictionary.</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">    edges : dict &lt;str, list &lt;str&gt;&gt;</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">        Dictionary of identifiers of AbsLayerNodes, it contains for each nodes identified by the keys, the list of nodes</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">        connected to it.</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">    Methods</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">    ----------</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the AbsLayerNode</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">        of the network.</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the AbsLayerNodes</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">        to control the refinement component of the abstraction. At present the function is just a placeholder</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">        for future implementations.</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a><span class="sd">        concrete abstract transformers.</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">        Parameters</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a><span class="sd">        ----------</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="sd">            The input abstract element.</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a><span class="sd">        Returns</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        ----------</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        AbsElement</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>        <span class="k">pass</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">        Parameters</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">        ----------</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="k">pass</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a><span class="k">class</span> <span class="nc">AbsSeqNetwork</span><span class="p">(</span><span class="n">AbsNeuralNetwork</span><span class="p">):</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="sd">    Concrete children of AbsNeuralNetwork representing a sequential AbsNeuralNetwork.</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a><span class="sd">    It consists of a graph of LayerNodes. The computational graph of a SequentialNetwork must</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="sd">    correspond to a standard list. The method forward and backward calls the corresponding methods</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">    in the AbsLayerNodes following the correct order to compute the output AbsElement.</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a><span class="sd">    Attributes</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">    ----------</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a><span class="sd">    identifier : str</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a><span class="sd">        Identifier of the Sequential AbsNeuralNetwork.</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">    Methods</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">    -------</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">    add_node(SingleInputLayerNode)</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">        Procedure to add a new AbsLayerNode to the sequential AbsNeuralNetwork.</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">    get_first_node()</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">        Procedure to extract the first AbsLayerNode of the sequential AbsNeuralNetwork.</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">    get_next_node(SingleInputLayerNode)</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">        Procedure to get the next AbsLayerNode of the AbsNeuralNetwork given an input AbsLayerNode</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">    get_last_node()</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">        Procedure to extract the last AbsLayerNode of the sequential AbsNeuralNetwork.</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the AbsLayerNode</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">        of the network.</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the AbsLayerNodes</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a><span class="sd">        to control the refinement component of the abstraction. At present the function is just a placeholder for</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">        future implementations.</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>    <span class="k">def</span> <span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">        Procedure to add a new AbsLayerNode. In sequential network the new node must be connected directly to the</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">        previous node forming a list.</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a><span class="sd">        Parameters</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a><span class="sd">        ----------</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="sd">        node : AbsLayerNode</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a><span class="sd">            New node to add to the Sequential network.</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>            <span class="n">previous_node_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_node</span><span class="p">()</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">previous_node_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>    <span class="k">def</span> <span class="nf">get_first_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a><span class="sd">        Procedure to get the first AbsLayerNode of the network.</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a><span class="sd">        Return</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a><span class="sd">        ---------</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a><span class="sd">        AbsLayerNode</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="sd">            The first node of the network.</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>            <span class="k">for</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>                <span class="k">if</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>                    <span class="n">keys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sub_key</span><span class="p">)</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>    <span class="k">def</span> <span class="nf">get_next_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AbsLayerNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a><span class="sd">        Procedure to get the next AbsLayerNode of the network given an input AbsLayerNode.</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">        Return</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a><span class="sd">        ---------</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        SingleInputLayerNode</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">            The next node of the network.</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>        <span class="n">next_node</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>            <span class="n">current_key</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">current_key</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>                <span class="n">next_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">current_key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>                <span class="n">next_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">next_key</span><span class="p">]</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>            <span class="n">next_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>        <span class="k">return</span> <span class="n">next_node</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>    <span class="k">def</span> <span class="nf">get_last_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a><span class="sd">        Procedure to get the last AbsLayerNode of the network.</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="sd">        Return</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a><span class="sd">        ---------</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="sd">        AbsLayerNode</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">            The last node of the network.</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="k">return</span> <span class="n">current_node</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">        concrete abstract transformers.</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">        Parameters</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        ----------</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a><span class="sd">            The input abstract element.</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="sd">        Returns</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">        ----------</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">        AbsElement</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>        <span class="k">while</span> <span class="n">current_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>            <span class="n">abs_input</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>        <span class="k">return</span> <span class="n">abs_input</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">        Parameters</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">        ----------</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>        <span class="k">pass</span>
</span></pre></div>


            </section>
                <section id="logger_empty">
                    <div class="attr variable">
            <span class="name">logger_empty</span>        =
<span class="default_value">&lt;Logger pynever.strategies.abstraction.empty_times (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger_empty"></a>
    
    

                </section>
                <section id="logger_lp">
                    <div class="attr variable">
            <span class="name">logger_lp</span>        =
<span class="default_value">&lt;Logger pynever.strategies.abstraction.lp_times (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger_lp"></a>
    
    

                </section>
                <section id="logger_lb">
                    <div class="attr variable">
            <span class="name">logger_lb</span>        =
<span class="default_value">&lt;Logger pynever.strategies.abstraction.lb_times (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger_lb"></a>
    
    

                </section>
                <section id="logger_ub">
                    <div class="attr variable">
            <span class="name">logger_ub</span>        =
<span class="default_value">&lt;Logger pynever.strategies.abstraction.ub_times (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger_ub"></a>
    
    

                </section>
                <section id="parallel">
                    <div class="attr variable">
            <span class="name">parallel</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#parallel"></a>
    
    

                </section>
                <section id="AbsElement">
                            <input id="AbsElement-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsElement</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="AbsElement-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsElement"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsElement-27"><a href="#AbsElement-27"><span class="linenos">27</span></a><span class="k">class</span> <span class="nc">AbsElement</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="AbsElement-28"><a href="#AbsElement-28"><span class="linenos">28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsElement-29"><a href="#AbsElement-29"><span class="linenos">29</span></a><span class="sd">    An abstract class used for our internal representation of a generic Abstract Element (e.g., interval, zonotope,</span>
</span><span id="AbsElement-30"><a href="#AbsElement-30"><span class="linenos">30</span></a><span class="sd">    polyhedra etc.)</span>
</span><span id="AbsElement-31"><a href="#AbsElement-31"><span class="linenos">31</span></a>
</span><span id="AbsElement-32"><a href="#AbsElement-32"><span class="linenos">32</span></a><span class="sd">    Attributes</span>
</span><span id="AbsElement-33"><a href="#AbsElement-33"><span class="linenos">33</span></a><span class="sd">    ----------</span>
</span><span id="AbsElement-34"><a href="#AbsElement-34"><span class="linenos">34</span></a><span class="sd">    identifier : str</span>
</span><span id="AbsElement-35"><a href="#AbsElement-35"><span class="linenos">35</span></a><span class="sd">        Identifier of the AbsElement.</span>
</span><span id="AbsElement-36"><a href="#AbsElement-36"><span class="linenos">36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsElement-37"><a href="#AbsElement-37"><span class="linenos">37</span></a>
</span><span id="AbsElement-38"><a href="#AbsElement-38"><span class="linenos">38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="AbsElement-39"><a href="#AbsElement-39"><span class="linenos">39</span></a>        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsElement-40"><a href="#AbsElement-40"><span class="linenos">40</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
</span><span id="AbsElement-41"><a href="#AbsElement-41"><span class="linenos">41</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsElement-42"><a href="#AbsElement-42"><span class="linenos">42</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span></pre></div>


            <div class="docstring"><p>An abstract class used for our internal representation of a generic Abstract Element (e.g., interval, zonotope,
polyhedra etc.)</p>

<h2 id="attributes">Attributes</h2>

<p>identifier : str
    Identifier of the AbsElement.</p>
</div>


                            <div id="AbsElement.__init__" class="classattr">
                                        <input id="AbsElement.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AbsElement</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="AbsElement.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsElement.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsElement.__init__-38"><a href="#AbsElement.__init__-38"><span class="linenos">38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="AbsElement.__init__-39"><a href="#AbsElement.__init__-39"><span class="linenos">39</span></a>        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsElement.__init__-40"><a href="#AbsElement.__init__-40"><span class="linenos">40</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
</span><span id="AbsElement.__init__-41"><a href="#AbsElement.__init__-41"><span class="linenos">41</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsElement.__init__-42"><a href="#AbsElement.__init__-42"><span class="linenos">42</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="Star">
                            <input id="Star-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Star</span>:

                <label class="view-source-button" for="Star-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star-45"><a href="#Star-45"><span class="linenos"> 45</span></a><span class="k">class</span> <span class="nc">Star</span><span class="p">:</span>
</span><span id="Star-46"><a href="#Star-46"><span class="linenos"> 46</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-47"><a href="#Star-47"><span class="linenos"> 47</span></a><span class="sd">    A concrete class used for our internal representation of a Star.</span>
</span><span id="Star-48"><a href="#Star-48"><span class="linenos"> 48</span></a><span class="sd">    The Star is defined as {x | x = c + Va such that Ca &lt;= d}</span>
</span><span id="Star-49"><a href="#Star-49"><span class="linenos"> 49</span></a><span class="sd">    where c is a n-dimensional vector corresponding to the center of the Star.</span>
</span><span id="Star-50"><a href="#Star-50"><span class="linenos"> 50</span></a><span class="sd">    V is the n-by-m matrix composed by the basis vectors.</span>
</span><span id="Star-51"><a href="#Star-51"><span class="linenos"> 51</span></a><span class="sd">    a is the vector of m variables, C (p-by-m) and d (p-dim) are the matrix and the biases</span>
</span><span id="Star-52"><a href="#Star-52"><span class="linenos"> 52</span></a><span class="sd">    defining a set of constraints.</span>
</span><span id="Star-53"><a href="#Star-53"><span class="linenos"> 53</span></a>
</span><span id="Star-54"><a href="#Star-54"><span class="linenos"> 54</span></a><span class="sd">    We refer to &lt;Star-Based Reachability Analysis of Deep Neural Networks&gt;</span>
</span><span id="Star-55"><a href="#Star-55"><span class="linenos"> 55</span></a><span class="sd">    (https://link.springer.com/chapter/10.1007/978-3-030-30942-8_39) for details.</span>
</span><span id="Star-56"><a href="#Star-56"><span class="linenos"> 56</span></a>
</span><span id="Star-57"><a href="#Star-57"><span class="linenos"> 57</span></a><span class="sd">    Attributes</span>
</span><span id="Star-58"><a href="#Star-58"><span class="linenos"> 58</span></a><span class="sd">    ----------</span>
</span><span id="Star-59"><a href="#Star-59"><span class="linenos"> 59</span></a><span class="sd">    center : Tensor</span>
</span><span id="Star-60"><a href="#Star-60"><span class="linenos"> 60</span></a><span class="sd">        Center of the Star.</span>
</span><span id="Star-61"><a href="#Star-61"><span class="linenos"> 61</span></a><span class="sd">    basis_matrix : Tensor</span>
</span><span id="Star-62"><a href="#Star-62"><span class="linenos"> 62</span></a><span class="sd">        Matrix composed by the basis vectors of the Star</span>
</span><span id="Star-63"><a href="#Star-63"><span class="linenos"> 63</span></a><span class="sd">    predicate_matrix : Tensor</span>
</span><span id="Star-64"><a href="#Star-64"><span class="linenos"> 64</span></a><span class="sd">        Matrix of the Predicate.</span>
</span><span id="Star-65"><a href="#Star-65"><span class="linenos"> 65</span></a><span class="sd">    predicate_bias : Tensor</span>
</span><span id="Star-66"><a href="#Star-66"><span class="linenos"> 66</span></a><span class="sd">        Bias of the Predicate.</span>
</span><span id="Star-67"><a href="#Star-67"><span class="linenos"> 67</span></a><span class="sd">    ubs : list</span>
</span><span id="Star-68"><a href="#Star-68"><span class="linenos"> 68</span></a><span class="sd">        Upper bounds of the points defined by the Star.</span>
</span><span id="Star-69"><a href="#Star-69"><span class="linenos"> 69</span></a><span class="sd">    lbs : list</span>
</span><span id="Star-70"><a href="#Star-70"><span class="linenos"> 70</span></a><span class="sd">        Lower bounds of the points defined by the Star.</span>
</span><span id="Star-71"><a href="#Star-71"><span class="linenos"> 71</span></a><span class="sd">    is_empty : bool</span>
</span><span id="Star-72"><a href="#Star-72"><span class="linenos"> 72</span></a><span class="sd">        Boolean flag: True if the Star defines an empty set of points, False otherwise</span>
</span><span id="Star-73"><a href="#Star-73"><span class="linenos"> 73</span></a>
</span><span id="Star-74"><a href="#Star-74"><span class="linenos"> 74</span></a><span class="sd">    Methods</span>
</span><span id="Star-75"><a href="#Star-75"><span class="linenos"> 75</span></a><span class="sd">    ----------</span>
</span><span id="Star-76"><a href="#Star-76"><span class="linenos"> 76</span></a><span class="sd">    get_bounds()</span>
</span><span id="Star-77"><a href="#Star-77"><span class="linenos"> 77</span></a><span class="sd">        Function used to get the upper and lower bounds of the n variables of the star.</span>
</span><span id="Star-78"><a href="#Star-78"><span class="linenos"> 78</span></a><span class="sd">    check_if_empty()</span>
</span><span id="Star-79"><a href="#Star-79"><span class="linenos"> 79</span></a><span class="sd">        Function used to check if the star corresponds to an empty set.</span>
</span><span id="Star-80"><a href="#Star-80"><span class="linenos"> 80</span></a>
</span><span id="Star-81"><a href="#Star-81"><span class="linenos"> 81</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Star-82"><a href="#Star-82"><span class="linenos"> 82</span></a>
</span><span id="Star-83"><a href="#Star-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate_matrix</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">predicate_bias</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Star-84"><a href="#Star-84"><span class="linenos"> 84</span></a>                 <span class="n">basis_matrix</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Star-85"><a href="#Star-85"><span class="linenos"> 85</span></a>
</span><span id="Star-86"><a href="#Star-86"><span class="linenos"> 86</span></a>        <span class="n">predicate_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the first dimension of the predicate_matrix (</span><span class="si">{</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="Star-87"><a href="#Star-87"><span class="linenos"> 87</span></a>                                <span class="sa">f</span><span class="s2">&quot;must be equal to the dimension of the predicate_bias (</span><span class="si">{</span><span class="n">predicate_bias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Star-88"><a href="#Star-88"><span class="linenos"> 88</span></a>        <span class="k">assert</span> <span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">predicate_bias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">predicate_dim_message</span>
</span><span id="Star-89"><a href="#Star-89"><span class="linenos"> 89</span></a>
</span><span id="Star-90"><a href="#Star-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span> <span class="o">=</span> <span class="n">predicate_matrix</span>
</span><span id="Star-91"><a href="#Star-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span> <span class="o">=</span> <span class="n">predicate_bias</span>
</span><span id="Star-92"><a href="#Star-92"><span class="linenos"> 92</span></a>
</span><span id="Star-93"><a href="#Star-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">basis_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Star-94"><a href="#Star-94"><span class="linenos"> 94</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Star-95"><a href="#Star-95"><span class="linenos"> 95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Star-96"><a href="#Star-96"><span class="linenos"> 96</span></a>
</span><span id="Star-97"><a href="#Star-97"><span class="linenos"> 97</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Star-98"><a href="#Star-98"><span class="linenos"> 98</span></a>            <span class="n">center_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the first dimension of the basis_matrix (</span><span class="si">{</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="Star-99"><a href="#Star-99"><span class="linenos"> 99</span></a>                                 <span class="sa">f</span><span class="s2">&quot;must be equal to the dimension of the center (</span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Star-100"><a href="#Star-100"><span class="linenos">100</span></a>            <span class="k">assert</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">center_dim_message</span>
</span><span id="Star-101"><a href="#Star-101"><span class="linenos">101</span></a>
</span><span id="Star-102"><a href="#Star-102"><span class="linenos">102</span></a>            <span class="n">basis_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the second dimension of the basis_matrix (</span><span class="si">{</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="Star-103"><a href="#Star-103"><span class="linenos">103</span></a>                                <span class="sa">f</span><span class="s2">&quot;must be equal to the second dimension of the predicate_matrix &quot;</span> \
</span><span id="Star-104"><a href="#Star-104"><span class="linenos">104</span></a>                                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Star-105"><a href="#Star-105"><span class="linenos">105</span></a>            <span class="k">assert</span> <span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">basis_dim_message</span>
</span><span id="Star-106"><a href="#Star-106"><span class="linenos">106</span></a>
</span><span id="Star-107"><a href="#Star-107"><span class="linenos">107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
</span><span id="Star-108"><a href="#Star-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span> <span class="o">=</span> <span class="n">basis_matrix</span>
</span><span id="Star-109"><a href="#Star-109"><span class="linenos">109</span></a>
</span><span id="Star-110"><a href="#Star-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="Star-111"><a href="#Star-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="Star-112"><a href="#Star-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="n">is_empty</span>
</span><span id="Star-113"><a href="#Star-113"><span class="linenos">113</span></a>
</span><span id="Star-114"><a href="#Star-114"><span class="linenos">114</span></a>        <span class="c1"># Private Attributes used for the sampling of the star.</span>
</span><span id="Star-115"><a href="#Star-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star-116"><a href="#Star-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star-117"><a href="#Star-117"><span class="linenos">117</span></a>
</span><span id="Star-118"><a href="#Star-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">check_if_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Star-119"><a href="#Star-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-120"><a href="#Star-120"><span class="linenos">120</span></a><span class="sd">        Function used to check if the set of points defined by the star is empty.</span>
</span><span id="Star-121"><a href="#Star-121"><span class="linenos">121</span></a>
</span><span id="Star-122"><a href="#Star-122"><span class="linenos">122</span></a><span class="sd">        Return</span>
</span><span id="Star-123"><a href="#Star-123"><span class="linenos">123</span></a><span class="sd">        ---------</span>
</span><span id="Star-124"><a href="#Star-124"><span class="linenos">124</span></a><span class="sd">        bool</span>
</span><span id="Star-125"><a href="#Star-125"><span class="linenos">125</span></a><span class="sd">            True if the star defines an empty set of points, False otherwise.</span>
</span><span id="Star-126"><a href="#Star-126"><span class="linenos">126</span></a>
</span><span id="Star-127"><a href="#Star-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-128"><a href="#Star-128"><span class="linenos">128</span></a>
</span><span id="Star-129"><a href="#Star-129"><span class="linenos">129</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-130"><a href="#Star-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Star-131"><a href="#Star-131"><span class="linenos">131</span></a>
</span><span id="Star-132"><a href="#Star-132"><span class="linenos">132</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="Star-133"><a href="#Star-133"><span class="linenos">133</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star-134"><a href="#Star-134"><span class="linenos">134</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-135"><a href="#Star-135"><span class="linenos">135</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Star-136"><a href="#Star-136"><span class="linenos">136</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Star-137"><a href="#Star-137"><span class="linenos">137</span></a>
</span><span id="Star-138"><a href="#Star-138"><span class="linenos">138</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star-139"><a href="#Star-139"><span class="linenos">139</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-140"><a href="#Star-140"><span class="linenos">140</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">INFEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">ABNORMAL</span><span class="p">:</span>
</span><span id="Star-141"><a href="#Star-141"><span class="linenos">141</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Star-142"><a href="#Star-142"><span class="linenos">142</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Star-143"><a href="#Star-143"><span class="linenos">143</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Star-144"><a href="#Star-144"><span class="linenos">144</span></a>
</span><span id="Star-145"><a href="#Star-145"><span class="linenos">145</span></a>        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-146"><a href="#Star-146"><span class="linenos">146</span></a>        <span class="n">logger_empty</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star-147"><a href="#Star-147"><span class="linenos">147</span></a>
</span><span id="Star-148"><a href="#Star-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>
</span><span id="Star-149"><a href="#Star-149"><span class="linenos">149</span></a>
</span><span id="Star-150"><a href="#Star-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">get_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="Star-151"><a href="#Star-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-152"><a href="#Star-152"><span class="linenos">152</span></a><span class="sd">        Function used to get the upper and lower bounds of the n variables of the star.</span>
</span><span id="Star-153"><a href="#Star-153"><span class="linenos">153</span></a>
</span><span id="Star-154"><a href="#Star-154"><span class="linenos">154</span></a><span class="sd">        Return</span>
</span><span id="Star-155"><a href="#Star-155"><span class="linenos">155</span></a><span class="sd">        ---------</span>
</span><span id="Star-156"><a href="#Star-156"><span class="linenos">156</span></a><span class="sd">        (float, float)</span>
</span><span id="Star-157"><a href="#Star-157"><span class="linenos">157</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variable i of the star</span>
</span><span id="Star-158"><a href="#Star-158"><span class="linenos">158</span></a>
</span><span id="Star-159"><a href="#Star-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-160"><a href="#Star-160"><span class="linenos">160</span></a>
</span><span id="Star-161"><a href="#Star-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Star-162"><a href="#Star-162"><span class="linenos">162</span></a>
</span><span id="Star-163"><a href="#Star-163"><span class="linenos">163</span></a>            <span class="c1"># print(&quot;Computing bounds&quot;)</span>
</span><span id="Star-164"><a href="#Star-164"><span class="linenos">164</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-165"><a href="#Star-165"><span class="linenos">165</span></a>
</span><span id="Star-166"><a href="#Star-166"><span class="linenos">166</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="Star-167"><a href="#Star-167"><span class="linenos">167</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star-168"><a href="#Star-168"><span class="linenos">168</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-169"><a href="#Star-169"><span class="linenos">169</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star-170"><a href="#Star-170"><span class="linenos">170</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star-171"><a href="#Star-171"><span class="linenos">171</span></a>
</span><span id="Star-172"><a href="#Star-172"><span class="linenos">172</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star-173"><a href="#Star-173"><span class="linenos">173</span></a>
</span><span id="Star-174"><a href="#Star-174"><span class="linenos">174</span></a>            <span class="n">lb_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-175"><a href="#Star-175"><span class="linenos">175</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-176"><a href="#Star-176"><span class="linenos">176</span></a>            <span class="n">lb_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-177"><a href="#Star-177"><span class="linenos">177</span></a>
</span><span id="Star-178"><a href="#Star-178"><span class="linenos">178</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="Star-179"><a href="#Star-179"><span class="linenos">179</span></a>
</span><span id="Star-180"><a href="#Star-180"><span class="linenos">180</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">INFEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">ABNORMAL</span><span class="p">:</span>
</span><span id="Star-181"><a href="#Star-181"><span class="linenos">181</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Star-182"><a href="#Star-182"><span class="linenos">182</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star-183"><a href="#Star-183"><span class="linenos">183</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star-184"><a href="#Star-184"><span class="linenos">184</span></a>                <span class="n">ub_end</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Star-185"><a href="#Star-185"><span class="linenos">185</span></a>                <span class="n">ub_start</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Star-186"><a href="#Star-186"><span class="linenos">186</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Star-187"><a href="#Star-187"><span class="linenos">187</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Star-188"><a href="#Star-188"><span class="linenos">188</span></a>
</span><span id="Star-189"><a href="#Star-189"><span class="linenos">189</span></a>                <span class="n">lb</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="Star-190"><a href="#Star-190"><span class="linenos">190</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="Star-191"><a href="#Star-191"><span class="linenos">191</span></a>                <span class="n">ub_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-192"><a href="#Star-192"><span class="linenos">192</span></a>                <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-193"><a href="#Star-193"><span class="linenos">193</span></a>                <span class="n">ub_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-194"><a href="#Star-194"><span class="linenos">194</span></a>                <span class="n">ub</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="Star-195"><a href="#Star-195"><span class="linenos">195</span></a>
</span><span id="Star-196"><a href="#Star-196"><span class="linenos">196</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lb</span>
</span><span id="Star-197"><a href="#Star-197"><span class="linenos">197</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ub</span>
</span><span id="Star-198"><a href="#Star-198"><span class="linenos">198</span></a>
</span><span id="Star-199"><a href="#Star-199"><span class="linenos">199</span></a>            <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star-200"><a href="#Star-200"><span class="linenos">200</span></a>
</span><span id="Star-201"><a href="#Star-201"><span class="linenos">201</span></a>            <span class="n">logger_lp</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star-202"><a href="#Star-202"><span class="linenos">202</span></a>            <span class="n">logger_lb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ub_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ub_start</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star-203"><a href="#Star-203"><span class="linenos">203</span></a>            <span class="n">logger_ub</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lb_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lb_start</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star-204"><a href="#Star-204"><span class="linenos">204</span></a>
</span><span id="Star-205"><a href="#Star-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Star-206"><a href="#Star-206"><span class="linenos">206</span></a>
</span><span id="Star-207"><a href="#Star-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">check_alpha_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_point</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Star-208"><a href="#Star-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-209"><a href="#Star-209"><span class="linenos">209</span></a><span class="sd">        Function which checks if the alpha point passed as input is valid with respect to the constraints defined by the</span>
</span><span id="Star-210"><a href="#Star-210"><span class="linenos">210</span></a><span class="sd">        predicate matrix and bias of the star.</span>
</span><span id="Star-211"><a href="#Star-211"><span class="linenos">211</span></a>
</span><span id="Star-212"><a href="#Star-212"><span class="linenos">212</span></a><span class="sd">        Parameters</span>
</span><span id="Star-213"><a href="#Star-213"><span class="linenos">213</span></a><span class="sd">        ----------</span>
</span><span id="Star-214"><a href="#Star-214"><span class="linenos">214</span></a><span class="sd">        alpha_point : Tensor</span>
</span><span id="Star-215"><a href="#Star-215"><span class="linenos">215</span></a><span class="sd">            Point (with respect ot the predicate variables) whose validity is to test.</span>
</span><span id="Star-216"><a href="#Star-216"><span class="linenos">216</span></a>
</span><span id="Star-217"><a href="#Star-217"><span class="linenos">217</span></a><span class="sd">        Returns</span>
</span><span id="Star-218"><a href="#Star-218"><span class="linenos">218</span></a><span class="sd">        -------</span>
</span><span id="Star-219"><a href="#Star-219"><span class="linenos">219</span></a><span class="sd">        bool</span>
</span><span id="Star-220"><a href="#Star-220"><span class="linenos">220</span></a><span class="sd">            The result of the check as a boolean (True if the point is valid, False otherwise)</span>
</span><span id="Star-221"><a href="#Star-221"><span class="linenos">221</span></a>
</span><span id="Star-222"><a href="#Star-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-223"><a href="#Star-223"><span class="linenos">223</span></a>
</span><span id="Star-224"><a href="#Star-224"><span class="linenos">224</span></a>        <span class="n">dim_error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Wrong dimensionality for alpha_point: it should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> by one.&quot;</span>
</span><span id="Star-225"><a href="#Star-225"><span class="linenos">225</span></a>        <span class="k">assert</span> <span class="n">alpha_point</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dim_error_msg</span>
</span><span id="Star-226"><a href="#Star-226"><span class="linenos">226</span></a>
</span><span id="Star-227"><a href="#Star-227"><span class="linenos">227</span></a>        <span class="n">tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">alpha_point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="Star-228"><a href="#Star-228"><span class="linenos">228</span></a>        <span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tests</span><span class="p">)</span>
</span><span id="Star-229"><a href="#Star-229"><span class="linenos">229</span></a>
</span><span id="Star-230"><a href="#Star-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="n">test</span>
</span><span id="Star-231"><a href="#Star-231"><span class="linenos">231</span></a>
</span><span id="Star-232"><a href="#Star-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">check_point_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Star-233"><a href="#Star-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-234"><a href="#Star-234"><span class="linenos">234</span></a><span class="sd">        Function which checks if the point passed as input is valid with respect to the constraints defined by the</span>
</span><span id="Star-235"><a href="#Star-235"><span class="linenos">235</span></a><span class="sd">        predicate matrix and bias of the star.</span>
</span><span id="Star-236"><a href="#Star-236"><span class="linenos">236</span></a>
</span><span id="Star-237"><a href="#Star-237"><span class="linenos">237</span></a><span class="sd">        Parameters</span>
</span><span id="Star-238"><a href="#Star-238"><span class="linenos">238</span></a><span class="sd">        ----------</span>
</span><span id="Star-239"><a href="#Star-239"><span class="linenos">239</span></a><span class="sd">        point : Tensor</span>
</span><span id="Star-240"><a href="#Star-240"><span class="linenos">240</span></a><span class="sd">            Point whose validity is to test.</span>
</span><span id="Star-241"><a href="#Star-241"><span class="linenos">241</span></a><span class="sd">        epsilon : float</span>
</span><span id="Star-242"><a href="#Star-242"><span class="linenos">242</span></a><span class="sd">            Acceptable deviation from real point.</span>
</span><span id="Star-243"><a href="#Star-243"><span class="linenos">243</span></a>
</span><span id="Star-244"><a href="#Star-244"><span class="linenos">244</span></a><span class="sd">        Returns</span>
</span><span id="Star-245"><a href="#Star-245"><span class="linenos">245</span></a><span class="sd">        -------</span>
</span><span id="Star-246"><a href="#Star-246"><span class="linenos">246</span></a><span class="sd">        bool</span>
</span><span id="Star-247"><a href="#Star-247"><span class="linenos">247</span></a><span class="sd">            The result of the check as a boolean (True if the point is valid, False otherwise)</span>
</span><span id="Star-248"><a href="#Star-248"><span class="linenos">248</span></a>
</span><span id="Star-249"><a href="#Star-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-250"><a href="#Star-250"><span class="linenos">250</span></a>
</span><span id="Star-251"><a href="#Star-251"><span class="linenos">251</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="Star-252"><a href="#Star-252"><span class="linenos">252</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-253"><a href="#Star-253"><span class="linenos">253</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-254"><a href="#Star-254"><span class="linenos">254</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Star-255"><a href="#Star-255"><span class="linenos">255</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="Star-256"><a href="#Star-256"><span class="linenos">256</span></a>
</span><span id="Star-257"><a href="#Star-257"><span class="linenos">257</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-258"><a href="#Star-258"><span class="linenos">258</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star-259"><a href="#Star-259"><span class="linenos">259</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star-260"><a href="#Star-260"><span class="linenos">260</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-261"><a href="#Star-261"><span class="linenos">261</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star-262"><a href="#Star-262"><span class="linenos">262</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="Star-263"><a href="#Star-263"><span class="linenos">263</span></a>
</span><span id="Star-264"><a href="#Star-264"><span class="linenos">264</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star-265"><a href="#Star-265"><span class="linenos">265</span></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">epsilon</span>
</span><span id="Star-266"><a href="#Star-266"><span class="linenos">266</span></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsilon</span>
</span><span id="Star-267"><a href="#Star-267"><span class="linenos">267</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
</span><span id="Star-268"><a href="#Star-268"><span class="linenos">268</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-269"><a href="#Star-269"><span class="linenos">269</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star-270"><a href="#Star-270"><span class="linenos">270</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="Star-271"><a href="#Star-271"><span class="linenos">271</span></a>
</span><span id="Star-272"><a href="#Star-272"><span class="linenos">272</span></a>        <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star-273"><a href="#Star-273"><span class="linenos">273</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-274"><a href="#Star-274"><span class="linenos">274</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Star-275"><a href="#Star-275"><span class="linenos">275</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Star-276"><a href="#Star-276"><span class="linenos">276</span></a>
</span><span id="Star-277"><a href="#Star-277"><span class="linenos">277</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star-278"><a href="#Star-278"><span class="linenos">278</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-279"><a href="#Star-279"><span class="linenos">279</span></a>
</span><span id="Star-280"><a href="#Star-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">FEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span>
</span><span id="Star-281"><a href="#Star-281"><span class="linenos">281</span></a>
</span><span id="Star-282"><a href="#Star-282"><span class="linenos">282</span></a>    <span class="k">def</span> <span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reset_auxiliary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">new_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span id="Star-283"><a href="#Star-283"><span class="linenos">283</span></a>
</span><span id="Star-284"><a href="#Star-284"><span class="linenos">284</span></a>        <span class="c1"># As first thing we need to get a valid starting point:</span>
</span><span id="Star-285"><a href="#Star-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_if_empty</span><span class="p">():</span>
</span><span id="Star-286"><a href="#Star-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="Star-287"><a href="#Star-287"><span class="linenos">287</span></a>
</span><span id="Star-288"><a href="#Star-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">reset_auxiliary</span><span class="p">:</span>
</span><span id="Star-289"><a href="#Star-289"><span class="linenos">289</span></a>            <span class="n">auxiliary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_auxiliary_points</span><span class="p">()</span>
</span><span id="Star-290"><a href="#Star-290"><span class="linenos">290</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Star-291"><a href="#Star-291"><span class="linenos">291</span></a>            <span class="n">auxiliary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span>
</span><span id="Star-292"><a href="#Star-292"><span class="linenos">292</span></a>
</span><span id="Star-293"><a href="#Star-293"><span class="linenos">293</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new_start</span><span class="p">:</span>
</span><span id="Star-294"><a href="#Star-294"><span class="linenos">294</span></a>            <span class="n">starting_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_starting_point</span><span class="p">()</span>
</span><span id="Star-295"><a href="#Star-295"><span class="linenos">295</span></a>            <span class="n">current_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="Star-296"><a href="#Star-296"><span class="linenos">296</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Star-297"><a href="#Star-297"><span class="linenos">297</span></a>            <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span>
</span><span id="Star-298"><a href="#Star-298"><span class="linenos">298</span></a>
</span><span id="Star-299"><a href="#Star-299"><span class="linenos">299</span></a>        <span class="c1"># We begin the iterative process to generate the samples of interest.</span>
</span><span id="Star-300"><a href="#Star-300"><span class="linenos">300</span></a>        <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-301"><a href="#Star-301"><span class="linenos">301</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_samples</span><span class="p">:</span>
</span><span id="Star-302"><a href="#Star-302"><span class="linenos">302</span></a>
</span><span id="Star-303"><a href="#Star-303"><span class="linenos">303</span></a>            <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Star-304"><a href="#Star-304"><span class="linenos">304</span></a>            <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">/</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
</span><span id="Star-305"><a href="#Star-305"><span class="linenos">305</span></a>            <span class="n">lambdas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-306"><a href="#Star-306"><span class="linenos">306</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star-307"><a href="#Star-307"><span class="linenos">307</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">direction</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="Star-308"><a href="#Star-308"><span class="linenos">308</span></a>                    <span class="n">lambdas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</span><span id="Star-309"><a href="#Star-309"><span class="linenos">309</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Star-310"><a href="#Star-310"><span class="linenos">310</span></a>                    <span class="n">temp</span> <span class="o">=</span> <span class="n">auxiliary_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_point</span>
</span><span id="Star-311"><a href="#Star-311"><span class="linenos">311</span></a>                    <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="Star-312"><a href="#Star-312"><span class="linenos">312</span></a>                                                                                    <span class="n">direction</span><span class="p">))</span>
</span><span id="Star-313"><a href="#Star-313"><span class="linenos">313</span></a>                    <span class="n">lambdas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
</span><span id="Star-314"><a href="#Star-314"><span class="linenos">314</span></a>            <span class="n">lambdas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lambdas</span><span class="p">)</span>
</span><span id="Star-315"><a href="#Star-315"><span class="linenos">315</span></a>
</span><span id="Star-316"><a href="#Star-316"><span class="linenos">316</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Star-317"><a href="#Star-317"><span class="linenos">317</span></a>                <span class="n">lam_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lambdas</span><span class="p">[</span><span class="n">lambdas</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star-318"><a href="#Star-318"><span class="linenos">318</span></a>                <span class="n">lam_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lambdas</span><span class="p">[</span><span class="n">lambdas</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star-319"><a href="#Star-319"><span class="linenos">319</span></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Star-320"><a href="#Star-320"><span class="linenos">320</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The current direction does not intersect&quot;</span>
</span><span id="Star-321"><a href="#Star-321"><span class="linenos">321</span></a>                                   <span class="s2">&quot;any of the hyperplanes.&quot;</span><span class="p">)</span>
</span><span id="Star-322"><a href="#Star-322"><span class="linenos">322</span></a>
</span><span id="Star-323"><a href="#Star-323"><span class="linenos">323</span></a>            <span class="n">increment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">lam_lower</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">lam_upper</span><span class="p">)</span>
</span><span id="Star-324"><a href="#Star-324"><span class="linenos">324</span></a>            <span class="n">next_point</span> <span class="o">=</span> <span class="n">current_point</span> <span class="o">+</span> <span class="n">increment</span> <span class="o">*</span> <span class="n">direction</span>
</span><span id="Star-325"><a href="#Star-325"><span class="linenos">325</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_alpha_inside</span><span class="p">(</span><span class="n">next_point</span><span class="p">):</span>
</span><span id="Star-326"><a href="#Star-326"><span class="linenos">326</span></a>                <span class="n">current_point</span> <span class="o">=</span> <span class="n">next_point</span>
</span><span id="Star-327"><a href="#Star-327"><span class="linenos">327</span></a>                <span class="n">star_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">,</span> <span class="n">current_point</span><span class="p">)</span>
</span><span id="Star-328"><a href="#Star-328"><span class="linenos">328</span></a>                <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">star_point</span><span class="p">)</span>
</span><span id="Star-329"><a href="#Star-329"><span class="linenos">329</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="o">=</span> <span class="n">current_point</span>
</span><span id="Star-330"><a href="#Star-330"><span class="linenos">330</span></a>
</span><span id="Star-331"><a href="#Star-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="n">samples</span>
</span><span id="Star-332"><a href="#Star-332"><span class="linenos">332</span></a>
</span><span id="Star-333"><a href="#Star-333"><span class="linenos">333</span></a>    <span class="k">def</span> <span class="nf">__get_auxiliary_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span id="Star-334"><a href="#Star-334"><span class="linenos">334</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-335"><a href="#Star-335"><span class="linenos">335</span></a><span class="sd">        Function which returns the auxiliary points for each plane of the predicate.</span>
</span><span id="Star-336"><a href="#Star-336"><span class="linenos">336</span></a>
</span><span id="Star-337"><a href="#Star-337"><span class="linenos">337</span></a><span class="sd">        Returns</span>
</span><span id="Star-338"><a href="#Star-338"><span class="linenos">338</span></a><span class="sd">        -------</span>
</span><span id="Star-339"><a href="#Star-339"><span class="linenos">339</span></a><span class="sd">        List[Tensor]</span>
</span><span id="Star-340"><a href="#Star-340"><span class="linenos">340</span></a><span class="sd">            List of the auxiliary points: one for each plane of the predicate.</span>
</span><span id="Star-341"><a href="#Star-341"><span class="linenos">341</span></a>
</span><span id="Star-342"><a href="#Star-342"><span class="linenos">342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-343"><a href="#Star-343"><span class="linenos">343</span></a>        <span class="n">aux_points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-344"><a href="#Star-344"><span class="linenos">344</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star-345"><a href="#Star-345"><span class="linenos">345</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Star-346"><a href="#Star-346"><span class="linenos">346</span></a>            <span class="n">plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Star-347"><a href="#Star-347"><span class="linenos">347</span></a>            <span class="n">max_nonzero_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">plane</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">plane</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">))</span>
</span><span id="Star-348"><a href="#Star-348"><span class="linenos">348</span></a>            <span class="n">p</span><span class="p">[</span><span class="n">max_nonzero_index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">plane</span><span class="p">[</span><span class="n">max_nonzero_index</span><span class="p">]</span>
</span><span id="Star-349"><a href="#Star-349"><span class="linenos">349</span></a>            <span class="n">aux_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="Star-350"><a href="#Star-350"><span class="linenos">350</span></a>
</span><span id="Star-351"><a href="#Star-351"><span class="linenos">351</span></a>        <span class="k">return</span> <span class="n">aux_points</span>
</span><span id="Star-352"><a href="#Star-352"><span class="linenos">352</span></a>
</span><span id="Star-353"><a href="#Star-353"><span class="linenos">353</span></a>    <span class="k">def</span> <span class="nf">__get_starting_point_by_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
</span><span id="Star-354"><a href="#Star-354"><span class="linenos">354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-355"><a href="#Star-355"><span class="linenos">355</span></a><span class="sd">        Function used to get the starting point for the hit and run algorithm.</span>
</span><span id="Star-356"><a href="#Star-356"><span class="linenos">356</span></a>
</span><span id="Star-357"><a href="#Star-357"><span class="linenos">357</span></a><span class="sd">        Return</span>
</span><span id="Star-358"><a href="#Star-358"><span class="linenos">358</span></a><span class="sd">        ---------</span>
</span><span id="Star-359"><a href="#Star-359"><span class="linenos">359</span></a><span class="sd">        (float, float)</span>
</span><span id="Star-360"><a href="#Star-360"><span class="linenos">360</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variables of the predicate</span>
</span><span id="Star-361"><a href="#Star-361"><span class="linenos">361</span></a>
</span><span id="Star-362"><a href="#Star-362"><span class="linenos">362</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-363"><a href="#Star-363"><span class="linenos">363</span></a>
</span><span id="Star-364"><a href="#Star-364"><span class="linenos">364</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-365"><a href="#Star-365"><span class="linenos">365</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-366"><a href="#Star-366"><span class="linenos">366</span></a>
</span><span id="Star-367"><a href="#Star-367"><span class="linenos">367</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="Star-368"><a href="#Star-368"><span class="linenos">368</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star-369"><a href="#Star-369"><span class="linenos">369</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-370"><a href="#Star-370"><span class="linenos">370</span></a>                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
</span><span id="Star-371"><a href="#Star-371"><span class="linenos">371</span></a>                    <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Star-372"><a href="#Star-372"><span class="linenos">372</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Star-373"><a href="#Star-373"><span class="linenos">373</span></a>                    <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Star-374"><a href="#Star-374"><span class="linenos">374</span></a>
</span><span id="Star-375"><a href="#Star-375"><span class="linenos">375</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star-376"><a href="#Star-376"><span class="linenos">376</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-377"><a href="#Star-377"><span class="linenos">377</span></a>
</span><span id="Star-378"><a href="#Star-378"><span class="linenos">378</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="Star-379"><a href="#Star-379"><span class="linenos">379</span></a>
</span><span id="Star-380"><a href="#Star-380"><span class="linenos">380</span></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="Star-381"><a href="#Star-381"><span class="linenos">381</span></a>
</span><span id="Star-382"><a href="#Star-382"><span class="linenos">382</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="Star-383"><a href="#Star-383"><span class="linenos">383</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-384"><a href="#Star-384"><span class="linenos">384</span></a>
</span><span id="Star-385"><a href="#Star-385"><span class="linenos">385</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="Star-386"><a href="#Star-386"><span class="linenos">386</span></a>
</span><span id="Star-387"><a href="#Star-387"><span class="linenos">387</span></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="Star-388"><a href="#Star-388"><span class="linenos">388</span></a>
</span><span id="Star-389"><a href="#Star-389"><span class="linenos">389</span></a>            <span class="n">starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">lb</span> <span class="o">+</span> <span class="n">ub</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">])</span>
</span><span id="Star-390"><a href="#Star-390"><span class="linenos">390</span></a>
</span><span id="Star-391"><a href="#Star-391"><span class="linenos">391</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="Star-392"><a href="#Star-392"><span class="linenos">392</span></a>        <span class="k">return</span> <span class="n">starting_point</span>
</span><span id="Star-393"><a href="#Star-393"><span class="linenos">393</span></a>
</span><span id="Star-394"><a href="#Star-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="nf">__get_starting_point</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
</span><span id="Star-395"><a href="#Star-395"><span class="linenos">395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-396"><a href="#Star-396"><span class="linenos">396</span></a><span class="sd">        Function used to get the starting point for the hit and run algorithm.</span>
</span><span id="Star-397"><a href="#Star-397"><span class="linenos">397</span></a>
</span><span id="Star-398"><a href="#Star-398"><span class="linenos">398</span></a><span class="sd">        Return</span>
</span><span id="Star-399"><a href="#Star-399"><span class="linenos">399</span></a><span class="sd">        ---------</span>
</span><span id="Star-400"><a href="#Star-400"><span class="linenos">400</span></a><span class="sd">        (float, float)</span>
</span><span id="Star-401"><a href="#Star-401"><span class="linenos">401</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variables of the predicate</span>
</span><span id="Star-402"><a href="#Star-402"><span class="linenos">402</span></a>
</span><span id="Star-403"><a href="#Star-403"><span class="linenos">403</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-404"><a href="#Star-404"><span class="linenos">404</span></a>
</span><span id="Star-405"><a href="#Star-405"><span class="linenos">405</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-406"><a href="#Star-406"><span class="linenos">406</span></a>
</span><span id="Star-407"><a href="#Star-407"><span class="linenos">407</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="Star-408"><a href="#Star-408"><span class="linenos">408</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-409"><a href="#Star-409"><span class="linenos">409</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-410"><a href="#Star-410"><span class="linenos">410</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Star-411"><a href="#Star-411"><span class="linenos">411</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="Star-412"><a href="#Star-412"><span class="linenos">412</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;radius&#39;</span><span class="p">)</span>
</span><span id="Star-413"><a href="#Star-413"><span class="linenos">413</span></a>
</span><span id="Star-414"><a href="#Star-414"><span class="linenos">414</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-415"><a href="#Star-415"><span class="linenos">415</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star-416"><a href="#Star-416"><span class="linenos">416</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star-417"><a href="#Star-417"><span class="linenos">417</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-418"><a href="#Star-418"><span class="linenos">418</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star-419"><a href="#Star-419"><span class="linenos">419</span></a>            <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:],</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="Star-420"><a href="#Star-420"><span class="linenos">420</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="Star-421"><a href="#Star-421"><span class="linenos">421</span></a>
</span><span id="Star-422"><a href="#Star-422"><span class="linenos">422</span></a>        <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star-423"><a href="#Star-423"><span class="linenos">423</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-424"><a href="#Star-424"><span class="linenos">424</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Star-425"><a href="#Star-425"><span class="linenos">425</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Star-426"><a href="#Star-426"><span class="linenos">426</span></a>
</span><span id="Star-427"><a href="#Star-427"><span class="linenos">427</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="Star-428"><a href="#Star-428"><span class="linenos">428</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star-429"><a href="#Star-429"><span class="linenos">429</span></a>
</span><span id="Star-430"><a href="#Star-430"><span class="linenos">430</span></a>        <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;It was impossible to compute the Chebyshev center of the predicate.&quot;</span>
</span><span id="Star-431"><a href="#Star-431"><span class="linenos">431</span></a>
</span><span id="Star-432"><a href="#Star-432"><span class="linenos">432</span></a>        <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
</span><span id="Star-433"><a href="#Star-433"><span class="linenos">433</span></a>            <span class="c1"># print(alpha.solution_value())</span>
</span><span id="Star-434"><a href="#Star-434"><span class="linenos">434</span></a>            <span class="n">starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">alpha</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()])</span>
</span><span id="Star-435"><a href="#Star-435"><span class="linenos">435</span></a>        <span class="c1"># print(radius.solution_value())</span>
</span><span id="Star-436"><a href="#Star-436"><span class="linenos">436</span></a>
</span><span id="Star-437"><a href="#Star-437"><span class="linenos">437</span></a>        <span class="n">starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="Star-438"><a href="#Star-438"><span class="linenos">438</span></a>
</span><span id="Star-439"><a href="#Star-439"><span class="linenos">439</span></a>        <span class="k">return</span> <span class="n">starting_point</span>
</span><span id="Star-440"><a href="#Star-440"><span class="linenos">440</span></a>
</span><span id="Star-441"><a href="#Star-441"><span class="linenos">441</span></a>    <span class="k">def</span> <span class="nf">__get_predicate_lp_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
</span><span id="Star-442"><a href="#Star-442"><span class="linenos">442</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star-443"><a href="#Star-443"><span class="linenos">443</span></a><span class="sd">        Creates an lp solver using pywraplp and adds the variables and constraints</span>
</span><span id="Star-444"><a href="#Star-444"><span class="linenos">444</span></a><span class="sd">        corresponding to the predicate of the star.</span>
</span><span id="Star-445"><a href="#Star-445"><span class="linenos">445</span></a>
</span><span id="Star-446"><a href="#Star-446"><span class="linenos">446</span></a><span class="sd">        Returns</span>
</span><span id="Star-447"><a href="#Star-447"><span class="linenos">447</span></a><span class="sd">        ---------</span>
</span><span id="Star-448"><a href="#Star-448"><span class="linenos">448</span></a><span class="sd">        (pywraplp.Solver, list, list)</span>
</span><span id="Star-449"><a href="#Star-449"><span class="linenos">449</span></a><span class="sd">            Respectively the lp solver, the variables and the constraints.</span>
</span><span id="Star-450"><a href="#Star-450"><span class="linenos">450</span></a>
</span><span id="Star-451"><a href="#Star-451"><span class="linenos">451</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star-452"><a href="#Star-452"><span class="linenos">452</span></a>
</span><span id="Star-453"><a href="#Star-453"><span class="linenos">453</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="Star-454"><a href="#Star-454"><span class="linenos">454</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-455"><a href="#Star-455"><span class="linenos">455</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-456"><a href="#Star-456"><span class="linenos">456</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Star-457"><a href="#Star-457"><span class="linenos">457</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="Star-458"><a href="#Star-458"><span class="linenos">458</span></a>
</span><span id="Star-459"><a href="#Star-459"><span class="linenos">459</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star-460"><a href="#Star-460"><span class="linenos">460</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star-461"><a href="#Star-461"><span class="linenos">461</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star-462"><a href="#Star-462"><span class="linenos">462</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star-463"><a href="#Star-463"><span class="linenos">463</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star-464"><a href="#Star-464"><span class="linenos">464</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="Star-465"><a href="#Star-465"><span class="linenos">465</span></a>
</span><span id="Star-466"><a href="#Star-466"><span class="linenos">466</span></a>        <span class="k">return</span> <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span>
</span></pre></div>


            <div class="docstring"><p>A concrete class used for our internal representation of a Star.
The Star is defined as {x | x = c + Va such that Ca &lt;= d}
where c is a n-dimensional vector corresponding to the center of the Star.
V is the n-by-m matrix composed by the basis vectors.
a is the vector of m variables, C (p-by-m) and d (p-dim) are the matrix and the biases
defining a set of constraints.</p>

<p>We refer to <Star-Based Reachability Analysis of Deep Neural Networks>
(<a href="https://link.springer.com/chapter/10.1007/978-3-030-30942-8_39">https://link.springer.com/chapter/10.1007/978-3-030-30942-8_39</a>) for details.</p>

<h2 id="attributes">Attributes</h2>

<p>center : Tensor
    Center of the Star.
basis_matrix : Tensor
    Matrix composed by the basis vectors of the Star
predicate_matrix : Tensor
    Matrix of the Predicate.
predicate_bias : Tensor
    Bias of the Predicate.
ubs : list
    Upper bounds of the points defined by the Star.
lbs : list
    Lower bounds of the points defined by the Star.
is_empty : bool
    Boolean flag: True if the Star defines an empty set of points, False otherwise</p>

<h2 id="methods">Methods</h2>

<p>get_bounds()
    Function used to get the upper and lower bounds of the n variables of the star.
check_if_empty()
    Function used to check if the star corresponds to an empty set.</p>
</div>


                            <div id="Star.__init__" class="classattr">
                                        <input id="Star.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Star</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">predicate_matrix</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span>,</span><span class="param">	<span class="n">predicate_bias</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span>,</span><span class="param">	<span class="n">center</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">basis_matrix</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">is_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Star.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star.__init__-83"><a href="#Star.__init__-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate_matrix</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">predicate_bias</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Star.__init__-84"><a href="#Star.__init__-84"><span class="linenos"> 84</span></a>                 <span class="n">basis_matrix</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_empty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Star.__init__-85"><a href="#Star.__init__-85"><span class="linenos"> 85</span></a>
</span><span id="Star.__init__-86"><a href="#Star.__init__-86"><span class="linenos"> 86</span></a>        <span class="n">predicate_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the first dimension of the predicate_matrix (</span><span class="si">{</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="Star.__init__-87"><a href="#Star.__init__-87"><span class="linenos"> 87</span></a>                                <span class="sa">f</span><span class="s2">&quot;must be equal to the dimension of the predicate_bias (</span><span class="si">{</span><span class="n">predicate_bias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Star.__init__-88"><a href="#Star.__init__-88"><span class="linenos"> 88</span></a>        <span class="k">assert</span> <span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">predicate_bias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">predicate_dim_message</span>
</span><span id="Star.__init__-89"><a href="#Star.__init__-89"><span class="linenos"> 89</span></a>
</span><span id="Star.__init__-90"><a href="#Star.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span> <span class="o">=</span> <span class="n">predicate_matrix</span>
</span><span id="Star.__init__-91"><a href="#Star.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span> <span class="o">=</span> <span class="n">predicate_bias</span>
</span><span id="Star.__init__-92"><a href="#Star.__init__-92"><span class="linenos"> 92</span></a>
</span><span id="Star.__init__-93"><a href="#Star.__init__-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">basis_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Star.__init__-94"><a href="#Star.__init__-94"><span class="linenos"> 94</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="Star.__init__-95"><a href="#Star.__init__-95"><span class="linenos"> 95</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Star.__init__-96"><a href="#Star.__init__-96"><span class="linenos"> 96</span></a>
</span><span id="Star.__init__-97"><a href="#Star.__init__-97"><span class="linenos"> 97</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Star.__init__-98"><a href="#Star.__init__-98"><span class="linenos"> 98</span></a>            <span class="n">center_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the first dimension of the basis_matrix (</span><span class="si">{</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="Star.__init__-99"><a href="#Star.__init__-99"><span class="linenos"> 99</span></a>                                 <span class="sa">f</span><span class="s2">&quot;must be equal to the dimension of the center (</span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Star.__init__-100"><a href="#Star.__init__-100"><span class="linenos">100</span></a>            <span class="k">assert</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">center_dim_message</span>
</span><span id="Star.__init__-101"><a href="#Star.__init__-101"><span class="linenos">101</span></a>
</span><span id="Star.__init__-102"><a href="#Star.__init__-102"><span class="linenos">102</span></a>            <span class="n">basis_dim_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: the second dimension of the basis_matrix (</span><span class="si">{</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) &quot;</span> \
</span><span id="Star.__init__-103"><a href="#Star.__init__-103"><span class="linenos">103</span></a>                                <span class="sa">f</span><span class="s2">&quot;must be equal to the second dimension of the predicate_matrix &quot;</span> \
</span><span id="Star.__init__-104"><a href="#Star.__init__-104"><span class="linenos">104</span></a>                                <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Star.__init__-105"><a href="#Star.__init__-105"><span class="linenos">105</span></a>            <span class="k">assert</span> <span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">basis_dim_message</span>
</span><span id="Star.__init__-106"><a href="#Star.__init__-106"><span class="linenos">106</span></a>
</span><span id="Star.__init__-107"><a href="#Star.__init__-107"><span class="linenos">107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
</span><span id="Star.__init__-108"><a href="#Star.__init__-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span> <span class="o">=</span> <span class="n">basis_matrix</span>
</span><span id="Star.__init__-109"><a href="#Star.__init__-109"><span class="linenos">109</span></a>
</span><span id="Star.__init__-110"><a href="#Star.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="Star.__init__-111"><a href="#Star.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</span><span id="Star.__init__-112"><a href="#Star.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="n">is_empty</span>
</span><span id="Star.__init__-113"><a href="#Star.__init__-113"><span class="linenos">113</span></a>
</span><span id="Star.__init__-114"><a href="#Star.__init__-114"><span class="linenos">114</span></a>        <span class="c1"># Private Attributes used for the sampling of the star.</span>
</span><span id="Star.__init__-115"><a href="#Star.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star.__init__-116"><a href="#Star.__init__-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="Star.predicate_matrix" class="classattr">
                                <div class="attr variable">
            <span class="name">predicate_matrix</span>

        
    </div>
    <a class="headerlink" href="#Star.predicate_matrix"></a>
    
    

                            </div>
                            <div id="Star.predicate_bias" class="classattr">
                                <div class="attr variable">
            <span class="name">predicate_bias</span>

        
    </div>
    <a class="headerlink" href="#Star.predicate_bias"></a>
    
    

                            </div>
                            <div id="Star.lbs" class="classattr">
                                <div class="attr variable">
            <span class="name">lbs</span>

        
    </div>
    <a class="headerlink" href="#Star.lbs"></a>
    
    

                            </div>
                            <div id="Star.ubs" class="classattr">
                                <div class="attr variable">
            <span class="name">ubs</span>

        
    </div>
    <a class="headerlink" href="#Star.ubs"></a>
    
    

                            </div>
                            <div id="Star.is_empty" class="classattr">
                                <div class="attr variable">
            <span class="name">is_empty</span>

        
    </div>
    <a class="headerlink" href="#Star.is_empty"></a>
    
    

                            </div>
                            <div id="Star.check_if_empty" class="classattr">
                                        <input id="Star.check_if_empty-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_if_empty</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Star.check_if_empty-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star.check_if_empty"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star.check_if_empty-118"><a href="#Star.check_if_empty-118"><span class="linenos">118</span></a>    <span class="k">def</span> <span class="nf">check_if_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Star.check_if_empty-119"><a href="#Star.check_if_empty-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star.check_if_empty-120"><a href="#Star.check_if_empty-120"><span class="linenos">120</span></a><span class="sd">        Function used to check if the set of points defined by the star is empty.</span>
</span><span id="Star.check_if_empty-121"><a href="#Star.check_if_empty-121"><span class="linenos">121</span></a>
</span><span id="Star.check_if_empty-122"><a href="#Star.check_if_empty-122"><span class="linenos">122</span></a><span class="sd">        Return</span>
</span><span id="Star.check_if_empty-123"><a href="#Star.check_if_empty-123"><span class="linenos">123</span></a><span class="sd">        ---------</span>
</span><span id="Star.check_if_empty-124"><a href="#Star.check_if_empty-124"><span class="linenos">124</span></a><span class="sd">        bool</span>
</span><span id="Star.check_if_empty-125"><a href="#Star.check_if_empty-125"><span class="linenos">125</span></a><span class="sd">            True if the star defines an empty set of points, False otherwise.</span>
</span><span id="Star.check_if_empty-126"><a href="#Star.check_if_empty-126"><span class="linenos">126</span></a>
</span><span id="Star.check_if_empty-127"><a href="#Star.check_if_empty-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star.check_if_empty-128"><a href="#Star.check_if_empty-128"><span class="linenos">128</span></a>
</span><span id="Star.check_if_empty-129"><a href="#Star.check_if_empty-129"><span class="linenos">129</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.check_if_empty-130"><a href="#Star.check_if_empty-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Star.check_if_empty-131"><a href="#Star.check_if_empty-131"><span class="linenos">131</span></a>
</span><span id="Star.check_if_empty-132"><a href="#Star.check_if_empty-132"><span class="linenos">132</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="Star.check_if_empty-133"><a href="#Star.check_if_empty-133"><span class="linenos">133</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star.check_if_empty-134"><a href="#Star.check_if_empty-134"><span class="linenos">134</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star.check_if_empty-135"><a href="#Star.check_if_empty-135"><span class="linenos">135</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Star.check_if_empty-136"><a href="#Star.check_if_empty-136"><span class="linenos">136</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Star.check_if_empty-137"><a href="#Star.check_if_empty-137"><span class="linenos">137</span></a>
</span><span id="Star.check_if_empty-138"><a href="#Star.check_if_empty-138"><span class="linenos">138</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star.check_if_empty-139"><a href="#Star.check_if_empty-139"><span class="linenos">139</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star.check_if_empty-140"><a href="#Star.check_if_empty-140"><span class="linenos">140</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">INFEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">ABNORMAL</span><span class="p">:</span>
</span><span id="Star.check_if_empty-141"><a href="#Star.check_if_empty-141"><span class="linenos">141</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Star.check_if_empty-142"><a href="#Star.check_if_empty-142"><span class="linenos">142</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Star.check_if_empty-143"><a href="#Star.check_if_empty-143"><span class="linenos">143</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Star.check_if_empty-144"><a href="#Star.check_if_empty-144"><span class="linenos">144</span></a>
</span><span id="Star.check_if_empty-145"><a href="#Star.check_if_empty-145"><span class="linenos">145</span></a>        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.check_if_empty-146"><a href="#Star.check_if_empty-146"><span class="linenos">146</span></a>        <span class="n">logger_empty</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star.check_if_empty-147"><a href="#Star.check_if_empty-147"><span class="linenos">147</span></a>
</span><span id="Star.check_if_empty-148"><a href="#Star.check_if_empty-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span>
</span></pre></div>


            <div class="docstring"><p>Function used to check if the set of points defined by the star is empty.</p>

<h2 id="return">Return</h2>

<p>bool
    True if the star defines an empty set of points, False otherwise.</p>
</div>


                            </div>
                            <div id="Star.get_bounds" class="classattr">
                                        <input id="Star.get_bounds-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_bounds</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">i</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Star.get_bounds-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star.get_bounds"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star.get_bounds-150"><a href="#Star.get_bounds-150"><span class="linenos">150</span></a>    <span class="k">def</span> <span class="nf">get_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="Star.get_bounds-151"><a href="#Star.get_bounds-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star.get_bounds-152"><a href="#Star.get_bounds-152"><span class="linenos">152</span></a><span class="sd">        Function used to get the upper and lower bounds of the n variables of the star.</span>
</span><span id="Star.get_bounds-153"><a href="#Star.get_bounds-153"><span class="linenos">153</span></a>
</span><span id="Star.get_bounds-154"><a href="#Star.get_bounds-154"><span class="linenos">154</span></a><span class="sd">        Return</span>
</span><span id="Star.get_bounds-155"><a href="#Star.get_bounds-155"><span class="linenos">155</span></a><span class="sd">        ---------</span>
</span><span id="Star.get_bounds-156"><a href="#Star.get_bounds-156"><span class="linenos">156</span></a><span class="sd">        (float, float)</span>
</span><span id="Star.get_bounds-157"><a href="#Star.get_bounds-157"><span class="linenos">157</span></a><span class="sd">            Tuple containing the lower and upper bounds of the variable i of the star</span>
</span><span id="Star.get_bounds-158"><a href="#Star.get_bounds-158"><span class="linenos">158</span></a>
</span><span id="Star.get_bounds-159"><a href="#Star.get_bounds-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star.get_bounds-160"><a href="#Star.get_bounds-160"><span class="linenos">160</span></a>
</span><span id="Star.get_bounds-161"><a href="#Star.get_bounds-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Star.get_bounds-162"><a href="#Star.get_bounds-162"><span class="linenos">162</span></a>
</span><span id="Star.get_bounds-163"><a href="#Star.get_bounds-163"><span class="linenos">163</span></a>            <span class="c1"># print(&quot;Computing bounds&quot;)</span>
</span><span id="Star.get_bounds-164"><a href="#Star.get_bounds-164"><span class="linenos">164</span></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.get_bounds-165"><a href="#Star.get_bounds-165"><span class="linenos">165</span></a>
</span><span id="Star.get_bounds-166"><a href="#Star.get_bounds-166"><span class="linenos">166</span></a>            <span class="n">solver</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_predicate_lp_solver</span><span class="p">()</span>
</span><span id="Star.get_bounds-167"><a href="#Star.get_bounds-167"><span class="linenos">167</span></a>            <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star.get_bounds-168"><a href="#Star.get_bounds-168"><span class="linenos">168</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star.get_bounds-169"><a href="#Star.get_bounds-169"><span class="linenos">169</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star.get_bounds-170"><a href="#Star.get_bounds-170"><span class="linenos">170</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star.get_bounds-171"><a href="#Star.get_bounds-171"><span class="linenos">171</span></a>
</span><span id="Star.get_bounds-172"><a href="#Star.get_bounds-172"><span class="linenos">172</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star.get_bounds-173"><a href="#Star.get_bounds-173"><span class="linenos">173</span></a>
</span><span id="Star.get_bounds-174"><a href="#Star.get_bounds-174"><span class="linenos">174</span></a>            <span class="n">lb_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.get_bounds-175"><a href="#Star.get_bounds-175"><span class="linenos">175</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star.get_bounds-176"><a href="#Star.get_bounds-176"><span class="linenos">176</span></a>            <span class="n">lb_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.get_bounds-177"><a href="#Star.get_bounds-177"><span class="linenos">177</span></a>
</span><span id="Star.get_bounds-178"><a href="#Star.get_bounds-178"><span class="linenos">178</span></a>            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">,</span> <span class="s2">&quot;The LP problem was not Optimal&quot;</span>
</span><span id="Star.get_bounds-179"><a href="#Star.get_bounds-179"><span class="linenos">179</span></a>
</span><span id="Star.get_bounds-180"><a href="#Star.get_bounds-180"><span class="linenos">180</span></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">INFEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">ABNORMAL</span><span class="p">:</span>
</span><span id="Star.get_bounds-181"><a href="#Star.get_bounds-181"><span class="linenos">181</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Star.get_bounds-182"><a href="#Star.get_bounds-182"><span class="linenos">182</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star.get_bounds-183"><a href="#Star.get_bounds-183"><span class="linenos">183</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Star.get_bounds-184"><a href="#Star.get_bounds-184"><span class="linenos">184</span></a>                <span class="n">ub_end</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Star.get_bounds-185"><a href="#Star.get_bounds-185"><span class="linenos">185</span></a>                <span class="n">ub_start</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Star.get_bounds-186"><a href="#Star.get_bounds-186"><span class="linenos">186</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Star.get_bounds-187"><a href="#Star.get_bounds-187"><span class="linenos">187</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Star.get_bounds-188"><a href="#Star.get_bounds-188"><span class="linenos">188</span></a>
</span><span id="Star.get_bounds-189"><a href="#Star.get_bounds-189"><span class="linenos">189</span></a>                <span class="n">lb</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="Star.get_bounds-190"><a href="#Star.get_bounds-190"><span class="linenos">190</span></a>                <span class="n">objective</span><span class="o">.</span><span class="n">SetMaximization</span><span class="p">()</span>
</span><span id="Star.get_bounds-191"><a href="#Star.get_bounds-191"><span class="linenos">191</span></a>                <span class="n">ub_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.get_bounds-192"><a href="#Star.get_bounds-192"><span class="linenos">192</span></a>                <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star.get_bounds-193"><a href="#Star.get_bounds-193"><span class="linenos">193</span></a>                <span class="n">ub_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.get_bounds-194"><a href="#Star.get_bounds-194"><span class="linenos">194</span></a>                <span class="n">ub</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span>
</span><span id="Star.get_bounds-195"><a href="#Star.get_bounds-195"><span class="linenos">195</span></a>
</span><span id="Star.get_bounds-196"><a href="#Star.get_bounds-196"><span class="linenos">196</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lb</span>
</span><span id="Star.get_bounds-197"><a href="#Star.get_bounds-197"><span class="linenos">197</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ub</span>
</span><span id="Star.get_bounds-198"><a href="#Star.get_bounds-198"><span class="linenos">198</span></a>
</span><span id="Star.get_bounds-199"><a href="#Star.get_bounds-199"><span class="linenos">199</span></a>            <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Star.get_bounds-200"><a href="#Star.get_bounds-200"><span class="linenos">200</span></a>
</span><span id="Star.get_bounds-201"><a href="#Star.get_bounds-201"><span class="linenos">201</span></a>            <span class="n">logger_lp</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star.get_bounds-202"><a href="#Star.get_bounds-202"><span class="linenos">202</span></a>            <span class="n">logger_lb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ub_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ub_start</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star.get_bounds-203"><a href="#Star.get_bounds-203"><span class="linenos">203</span></a>            <span class="n">logger_ub</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lb_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lb_start</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
</span><span id="Star.get_bounds-204"><a href="#Star.get_bounds-204"><span class="linenos">204</span></a>
</span><span id="Star.get_bounds-205"><a href="#Star.get_bounds-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lbs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ubs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Function used to get the upper and lower bounds of the n variables of the star.</p>

<h2 id="return">Return</h2>

<p>(float, float)
    Tuple containing the lower and upper bounds of the variable i of the star</p>
</div>


                            </div>
                            <div id="Star.check_alpha_inside" class="classattr">
                                        <input id="Star.check_alpha_inside-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_alpha_inside</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">alpha_point</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Star.check_alpha_inside-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star.check_alpha_inside"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star.check_alpha_inside-207"><a href="#Star.check_alpha_inside-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">check_alpha_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha_point</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Star.check_alpha_inside-208"><a href="#Star.check_alpha_inside-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star.check_alpha_inside-209"><a href="#Star.check_alpha_inside-209"><span class="linenos">209</span></a><span class="sd">        Function which checks if the alpha point passed as input is valid with respect to the constraints defined by the</span>
</span><span id="Star.check_alpha_inside-210"><a href="#Star.check_alpha_inside-210"><span class="linenos">210</span></a><span class="sd">        predicate matrix and bias of the star.</span>
</span><span id="Star.check_alpha_inside-211"><a href="#Star.check_alpha_inside-211"><span class="linenos">211</span></a>
</span><span id="Star.check_alpha_inside-212"><a href="#Star.check_alpha_inside-212"><span class="linenos">212</span></a><span class="sd">        Parameters</span>
</span><span id="Star.check_alpha_inside-213"><a href="#Star.check_alpha_inside-213"><span class="linenos">213</span></a><span class="sd">        ----------</span>
</span><span id="Star.check_alpha_inside-214"><a href="#Star.check_alpha_inside-214"><span class="linenos">214</span></a><span class="sd">        alpha_point : Tensor</span>
</span><span id="Star.check_alpha_inside-215"><a href="#Star.check_alpha_inside-215"><span class="linenos">215</span></a><span class="sd">            Point (with respect ot the predicate variables) whose validity is to test.</span>
</span><span id="Star.check_alpha_inside-216"><a href="#Star.check_alpha_inside-216"><span class="linenos">216</span></a>
</span><span id="Star.check_alpha_inside-217"><a href="#Star.check_alpha_inside-217"><span class="linenos">217</span></a><span class="sd">        Returns</span>
</span><span id="Star.check_alpha_inside-218"><a href="#Star.check_alpha_inside-218"><span class="linenos">218</span></a><span class="sd">        -------</span>
</span><span id="Star.check_alpha_inside-219"><a href="#Star.check_alpha_inside-219"><span class="linenos">219</span></a><span class="sd">        bool</span>
</span><span id="Star.check_alpha_inside-220"><a href="#Star.check_alpha_inside-220"><span class="linenos">220</span></a><span class="sd">            The result of the check as a boolean (True if the point is valid, False otherwise)</span>
</span><span id="Star.check_alpha_inside-221"><a href="#Star.check_alpha_inside-221"><span class="linenos">221</span></a>
</span><span id="Star.check_alpha_inside-222"><a href="#Star.check_alpha_inside-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star.check_alpha_inside-223"><a href="#Star.check_alpha_inside-223"><span class="linenos">223</span></a>
</span><span id="Star.check_alpha_inside-224"><a href="#Star.check_alpha_inside-224"><span class="linenos">224</span></a>        <span class="n">dim_error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Wrong dimensionality for alpha_point: it should be </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> by one.&quot;</span>
</span><span id="Star.check_alpha_inside-225"><a href="#Star.check_alpha_inside-225"><span class="linenos">225</span></a>        <span class="k">assert</span> <span class="n">alpha_point</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dim_error_msg</span>
</span><span id="Star.check_alpha_inside-226"><a href="#Star.check_alpha_inside-226"><span class="linenos">226</span></a>
</span><span id="Star.check_alpha_inside-227"><a href="#Star.check_alpha_inside-227"><span class="linenos">227</span></a>        <span class="n">tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">alpha_point</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="Star.check_alpha_inside-228"><a href="#Star.check_alpha_inside-228"><span class="linenos">228</span></a>        <span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tests</span><span class="p">)</span>
</span><span id="Star.check_alpha_inside-229"><a href="#Star.check_alpha_inside-229"><span class="linenos">229</span></a>
</span><span id="Star.check_alpha_inside-230"><a href="#Star.check_alpha_inside-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="n">test</span>
</span></pre></div>


            <div class="docstring"><p>Function which checks if the alpha point passed as input is valid with respect to the constraints defined by the
predicate matrix and bias of the star.</p>

<h2 id="parameters">Parameters</h2>

<p>alpha_point : Tensor
    Point (with respect ot the predicate variables) whose validity is to test.</p>

<h2 id="returns">Returns</h2>

<p>bool
    The result of the check as a boolean (True if the point is valid, False otherwise)</p>
</div>


                            </div>
                            <div id="Star.check_point_inside" class="classattr">
                                        <input id="Star.check_point_inside-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_point_inside</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">point</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span>, </span><span class="param"><span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="Star.check_point_inside-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star.check_point_inside"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star.check_point_inside-232"><a href="#Star.check_point_inside-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">check_point_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Star.check_point_inside-233"><a href="#Star.check_point_inside-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Star.check_point_inside-234"><a href="#Star.check_point_inside-234"><span class="linenos">234</span></a><span class="sd">        Function which checks if the point passed as input is valid with respect to the constraints defined by the</span>
</span><span id="Star.check_point_inside-235"><a href="#Star.check_point_inside-235"><span class="linenos">235</span></a><span class="sd">        predicate matrix and bias of the star.</span>
</span><span id="Star.check_point_inside-236"><a href="#Star.check_point_inside-236"><span class="linenos">236</span></a>
</span><span id="Star.check_point_inside-237"><a href="#Star.check_point_inside-237"><span class="linenos">237</span></a><span class="sd">        Parameters</span>
</span><span id="Star.check_point_inside-238"><a href="#Star.check_point_inside-238"><span class="linenos">238</span></a><span class="sd">        ----------</span>
</span><span id="Star.check_point_inside-239"><a href="#Star.check_point_inside-239"><span class="linenos">239</span></a><span class="sd">        point : Tensor</span>
</span><span id="Star.check_point_inside-240"><a href="#Star.check_point_inside-240"><span class="linenos">240</span></a><span class="sd">            Point whose validity is to test.</span>
</span><span id="Star.check_point_inside-241"><a href="#Star.check_point_inside-241"><span class="linenos">241</span></a><span class="sd">        epsilon : float</span>
</span><span id="Star.check_point_inside-242"><a href="#Star.check_point_inside-242"><span class="linenos">242</span></a><span class="sd">            Acceptable deviation from real point.</span>
</span><span id="Star.check_point_inside-243"><a href="#Star.check_point_inside-243"><span class="linenos">243</span></a>
</span><span id="Star.check_point_inside-244"><a href="#Star.check_point_inside-244"><span class="linenos">244</span></a><span class="sd">        Returns</span>
</span><span id="Star.check_point_inside-245"><a href="#Star.check_point_inside-245"><span class="linenos">245</span></a><span class="sd">        -------</span>
</span><span id="Star.check_point_inside-246"><a href="#Star.check_point_inside-246"><span class="linenos">246</span></a><span class="sd">        bool</span>
</span><span id="Star.check_point_inside-247"><a href="#Star.check_point_inside-247"><span class="linenos">247</span></a><span class="sd">            The result of the check as a boolean (True if the point is valid, False otherwise)</span>
</span><span id="Star.check_point_inside-248"><a href="#Star.check_point_inside-248"><span class="linenos">248</span></a>
</span><span id="Star.check_point_inside-249"><a href="#Star.check_point_inside-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Star.check_point_inside-250"><a href="#Star.check_point_inside-250"><span class="linenos">250</span></a>
</span><span id="Star.check_point_inside-251"><a href="#Star.check_point_inside-251"><span class="linenos">251</span></a>        <span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">CreateSolver</span><span class="p">(</span><span class="s1">&#39;GLOP&#39;</span><span class="p">)</span>
</span><span id="Star.check_point_inside-252"><a href="#Star.check_point_inside-252"><span class="linenos">252</span></a>        <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star.check_point_inside-253"><a href="#Star.check_point_inside-253"><span class="linenos">253</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star.check_point_inside-254"><a href="#Star.check_point_inside-254"><span class="linenos">254</span></a>            <span class="n">new_alpha</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">NumVar</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;alpha_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Star.check_point_inside-255"><a href="#Star.check_point_inside-255"><span class="linenos">255</span></a>            <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_alpha</span><span class="p">)</span>
</span><span id="Star.check_point_inside-256"><a href="#Star.check_point_inside-256"><span class="linenos">256</span></a>
</span><span id="Star.check_point_inside-257"><a href="#Star.check_point_inside-257"><span class="linenos">257</span></a>        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star.check_point_inside-258"><a href="#Star.check_point_inside-258"><span class="linenos">258</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star.check_point_inside-259"><a href="#Star.check_point_inside-259"><span class="linenos">259</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="o">-</span><span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star.check_point_inside-260"><a href="#Star.check_point_inside-260"><span class="linenos">260</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star.check_point_inside-261"><a href="#Star.check_point_inside-261"><span class="linenos">261</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star.check_point_inside-262"><a href="#Star.check_point_inside-262"><span class="linenos">262</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="Star.check_point_inside-263"><a href="#Star.check_point_inside-263"><span class="linenos">263</span></a>
</span><span id="Star.check_point_inside-264"><a href="#Star.check_point_inside-264"><span class="linenos">264</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star.check_point_inside-265"><a href="#Star.check_point_inside-265"><span class="linenos">265</span></a>            <span class="n">lb</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">epsilon</span>
</span><span id="Star.check_point_inside-266"><a href="#Star.check_point_inside-266"><span class="linenos">266</span></a>            <span class="n">ub</span> <span class="o">=</span> <span class="n">point</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsilon</span>
</span><span id="Star.check_point_inside-267"><a href="#Star.check_point_inside-267"><span class="linenos">267</span></a>            <span class="n">new_constraint</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>
</span><span id="Star.check_point_inside-268"><a href="#Star.check_point_inside-268"><span class="linenos">268</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star.check_point_inside-269"><a href="#Star.check_point_inside-269"><span class="linenos">269</span></a>                <span class="n">new_constraint</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
</span><span id="Star.check_point_inside-270"><a href="#Star.check_point_inside-270"><span class="linenos">270</span></a>            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_constraint</span><span class="p">)</span>
</span><span id="Star.check_point_inside-271"><a href="#Star.check_point_inside-271"><span class="linenos">271</span></a>
</span><span id="Star.check_point_inside-272"><a href="#Star.check_point_inside-272"><span class="linenos">272</span></a>        <span class="n">objective</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span>
</span><span id="Star.check_point_inside-273"><a href="#Star.check_point_inside-273"><span class="linenos">273</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Star.check_point_inside-274"><a href="#Star.check_point_inside-274"><span class="linenos">274</span></a>            <span class="n">objective</span><span class="o">.</span><span class="n">SetCoefficient</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Star.check_point_inside-275"><a href="#Star.check_point_inside-275"><span class="linenos">275</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Star.check_point_inside-276"><a href="#Star.check_point_inside-276"><span class="linenos">276</span></a>
</span><span id="Star.check_point_inside-277"><a href="#Star.check_point_inside-277"><span class="linenos">277</span></a>        <span class="n">objective</span><span class="o">.</span><span class="n">SetMinimization</span><span class="p">()</span>
</span><span id="Star.check_point_inside-278"><a href="#Star.check_point_inside-278"><span class="linenos">278</span></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</span><span id="Star.check_point_inside-279"><a href="#Star.check_point_inside-279"><span class="linenos">279</span></a>
</span><span id="Star.check_point_inside-280"><a href="#Star.check_point_inside-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">FEASIBLE</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span>
</span></pre></div>


            <div class="docstring"><p>Function which checks if the point passed as input is valid with respect to the constraints defined by the
predicate matrix and bias of the star.</p>

<h2 id="parameters">Parameters</h2>

<p>point : Tensor
    Point whose validity is to test.
epsilon : float
    Acceptable deviation from real point.</p>

<h2 id="returns">Returns</h2>

<p>bool
    The result of the check as a boolean (True if the point is valid, False otherwise)</p>
</div>


                            </div>
                            <div id="Star.get_samples" class="classattr">
                                        <input id="Star.get_samples-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_samples</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">reset_auxiliary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">new_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Star.get_samples-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Star.get_samples"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Star.get_samples-282"><a href="#Star.get_samples-282"><span class="linenos">282</span></a>    <span class="k">def</span> <span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reset_auxiliary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">new_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span id="Star.get_samples-283"><a href="#Star.get_samples-283"><span class="linenos">283</span></a>
</span><span id="Star.get_samples-284"><a href="#Star.get_samples-284"><span class="linenos">284</span></a>        <span class="c1"># As first thing we need to get a valid starting point:</span>
</span><span id="Star.get_samples-285"><a href="#Star.get_samples-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_if_empty</span><span class="p">():</span>
</span><span id="Star.get_samples-286"><a href="#Star.get_samples-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="Star.get_samples-287"><a href="#Star.get_samples-287"><span class="linenos">287</span></a>
</span><span id="Star.get_samples-288"><a href="#Star.get_samples-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">reset_auxiliary</span><span class="p">:</span>
</span><span id="Star.get_samples-289"><a href="#Star.get_samples-289"><span class="linenos">289</span></a>            <span class="n">auxiliary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_auxiliary_points</span><span class="p">()</span>
</span><span id="Star.get_samples-290"><a href="#Star.get_samples-290"><span class="linenos">290</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Star.get_samples-291"><a href="#Star.get_samples-291"><span class="linenos">291</span></a>            <span class="n">auxiliary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__auxiliary_points</span>
</span><span id="Star.get_samples-292"><a href="#Star.get_samples-292"><span class="linenos">292</span></a>
</span><span id="Star.get_samples-293"><a href="#Star.get_samples-293"><span class="linenos">293</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new_start</span><span class="p">:</span>
</span><span id="Star.get_samples-294"><a href="#Star.get_samples-294"><span class="linenos">294</span></a>            <span class="n">starting_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_starting_point</span><span class="p">()</span>
</span><span id="Star.get_samples-295"><a href="#Star.get_samples-295"><span class="linenos">295</span></a>            <span class="n">current_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">starting_point</span><span class="p">)</span>
</span><span id="Star.get_samples-296"><a href="#Star.get_samples-296"><span class="linenos">296</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Star.get_samples-297"><a href="#Star.get_samples-297"><span class="linenos">297</span></a>            <span class="n">current_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span>
</span><span id="Star.get_samples-298"><a href="#Star.get_samples-298"><span class="linenos">298</span></a>
</span><span id="Star.get_samples-299"><a href="#Star.get_samples-299"><span class="linenos">299</span></a>        <span class="c1"># We begin the iterative process to generate the samples of interest.</span>
</span><span id="Star.get_samples-300"><a href="#Star.get_samples-300"><span class="linenos">300</span></a>        <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star.get_samples-301"><a href="#Star.get_samples-301"><span class="linenos">301</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_samples</span><span class="p">:</span>
</span><span id="Star.get_samples-302"><a href="#Star.get_samples-302"><span class="linenos">302</span></a>
</span><span id="Star.get_samples-303"><a href="#Star.get_samples-303"><span class="linenos">303</span></a>            <span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Star.get_samples-304"><a href="#Star.get_samples-304"><span class="linenos">304</span></a>            <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">/</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
</span><span id="Star.get_samples-305"><a href="#Star.get_samples-305"><span class="linenos">305</span></a>            <span class="n">lambdas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Star.get_samples-306"><a href="#Star.get_samples-306"><span class="linenos">306</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Star.get_samples-307"><a href="#Star.get_samples-307"><span class="linenos">307</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">direction</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="Star.get_samples-308"><a href="#Star.get_samples-308"><span class="linenos">308</span></a>                    <span class="n">lambdas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</span><span id="Star.get_samples-309"><a href="#Star.get_samples-309"><span class="linenos">309</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Star.get_samples-310"><a href="#Star.get_samples-310"><span class="linenos">310</span></a>                    <span class="n">temp</span> <span class="o">=</span> <span class="n">auxiliary_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_point</span>
</span><span id="Star.get_samples-311"><a href="#Star.get_samples-311"><span class="linenos">311</span></a>                    <span class="n">lam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="Star.get_samples-312"><a href="#Star.get_samples-312"><span class="linenos">312</span></a>                                                                                    <span class="n">direction</span><span class="p">))</span>
</span><span id="Star.get_samples-313"><a href="#Star.get_samples-313"><span class="linenos">313</span></a>                    <span class="n">lambdas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
</span><span id="Star.get_samples-314"><a href="#Star.get_samples-314"><span class="linenos">314</span></a>            <span class="n">lambdas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lambdas</span><span class="p">)</span>
</span><span id="Star.get_samples-315"><a href="#Star.get_samples-315"><span class="linenos">315</span></a>
</span><span id="Star.get_samples-316"><a href="#Star.get_samples-316"><span class="linenos">316</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Star.get_samples-317"><a href="#Star.get_samples-317"><span class="linenos">317</span></a>                <span class="n">lam_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lambdas</span><span class="p">[</span><span class="n">lambdas</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star.get_samples-318"><a href="#Star.get_samples-318"><span class="linenos">318</span></a>                <span class="n">lam_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lambdas</span><span class="p">[</span><span class="n">lambdas</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Star.get_samples-319"><a href="#Star.get_samples-319"><span class="linenos">319</span></a>            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="Star.get_samples-320"><a href="#Star.get_samples-320"><span class="linenos">320</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The current direction does not intersect&quot;</span>
</span><span id="Star.get_samples-321"><a href="#Star.get_samples-321"><span class="linenos">321</span></a>                                   <span class="s2">&quot;any of the hyperplanes.&quot;</span><span class="p">)</span>
</span><span id="Star.get_samples-322"><a href="#Star.get_samples-322"><span class="linenos">322</span></a>
</span><span id="Star.get_samples-323"><a href="#Star.get_samples-323"><span class="linenos">323</span></a>            <span class="n">increment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">lam_lower</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">lam_upper</span><span class="p">)</span>
</span><span id="Star.get_samples-324"><a href="#Star.get_samples-324"><span class="linenos">324</span></a>            <span class="n">next_point</span> <span class="o">=</span> <span class="n">current_point</span> <span class="o">+</span> <span class="n">increment</span> <span class="o">*</span> <span class="n">direction</span>
</span><span id="Star.get_samples-325"><a href="#Star.get_samples-325"><span class="linenos">325</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_alpha_inside</span><span class="p">(</span><span class="n">next_point</span><span class="p">):</span>
</span><span id="Star.get_samples-326"><a href="#Star.get_samples-326"><span class="linenos">326</span></a>                <span class="n">current_point</span> <span class="o">=</span> <span class="n">next_point</span>
</span><span id="Star.get_samples-327"><a href="#Star.get_samples-327"><span class="linenos">327</span></a>                <span class="n">star_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">,</span> <span class="n">current_point</span><span class="p">)</span>
</span><span id="Star.get_samples-328"><a href="#Star.get_samples-328"><span class="linenos">328</span></a>                <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">star_point</span><span class="p">)</span>
</span><span id="Star.get_samples-329"><a href="#Star.get_samples-329"><span class="linenos">329</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__current_point</span> <span class="o">=</span> <span class="n">current_point</span>
</span><span id="Star.get_samples-330"><a href="#Star.get_samples-330"><span class="linenos">330</span></a>
</span><span id="Star.get_samples-331"><a href="#Star.get_samples-331"><span class="linenos">331</span></a>        <span class="k">return</span> <span class="n">samples</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="StarSet">
                            <input id="StarSet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StarSet</span><wbr>(<span class="base"><a href="#AbsElement">AbsElement</a></span>):

                <label class="view-source-button" for="StarSet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StarSet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StarSet-469"><a href="#StarSet-469"><span class="linenos">469</span></a><span class="k">class</span> <span class="nc">StarSet</span><span class="p">(</span><span class="n">AbsElement</span><span class="p">):</span>
</span><span id="StarSet-470"><a href="#StarSet-470"><span class="linenos">470</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StarSet-471"><a href="#StarSet-471"><span class="linenos">471</span></a><span class="sd">    Concrete class for our internal representation of a StarSet abstract element. A StarSet consist in a set</span>
</span><span id="StarSet-472"><a href="#StarSet-472"><span class="linenos">472</span></a><span class="sd">    of Star objects.</span>
</span><span id="StarSet-473"><a href="#StarSet-473"><span class="linenos">473</span></a>
</span><span id="StarSet-474"><a href="#StarSet-474"><span class="linenos">474</span></a><span class="sd">    Attributes</span>
</span><span id="StarSet-475"><a href="#StarSet-475"><span class="linenos">475</span></a><span class="sd">    ----------</span>
</span><span id="StarSet-476"><a href="#StarSet-476"><span class="linenos">476</span></a><span class="sd">    stars : Set[Star]</span>
</span><span id="StarSet-477"><a href="#StarSet-477"><span class="linenos">477</span></a><span class="sd">        Set of Star objects.</span>
</span><span id="StarSet-478"><a href="#StarSet-478"><span class="linenos">478</span></a>
</span><span id="StarSet-479"><a href="#StarSet-479"><span class="linenos">479</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="StarSet-480"><a href="#StarSet-480"><span class="linenos">480</span></a>
</span><span id="StarSet-481"><a href="#StarSet-481"><span class="linenos">481</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stars</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="StarSet-482"><a href="#StarSet-482"><span class="linenos">482</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
</span><span id="StarSet-483"><a href="#StarSet-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="n">stars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StarSet-484"><a href="#StarSet-484"><span class="linenos">484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="StarSet-485"><a href="#StarSet-485"><span class="linenos">485</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StarSet-486"><a href="#StarSet-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">stars</span>
</span></pre></div>


            <div class="docstring"><p>Concrete class for our internal representation of a StarSet abstract element. A StarSet consist in a set
of Star objects.</p>

<h2 id="attributes">Attributes</h2>

<p>stars : Set[Star]
    Set of Star objects.</p>
</div>


                            <div id="StarSet.__init__" class="classattr">
                                        <input id="StarSet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">StarSet</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">stars</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n"><a href="#Star">Star</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="StarSet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StarSet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StarSet.__init__-481"><a href="#StarSet.__init__-481"><span class="linenos">481</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stars</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="StarSet.__init__-482"><a href="#StarSet.__init__-482"><span class="linenos">482</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
</span><span id="StarSet.__init__-483"><a href="#StarSet.__init__-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="n">stars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StarSet.__init__-484"><a href="#StarSet.__init__-484"><span class="linenos">484</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="StarSet.__init__-485"><a href="#StarSet.__init__-485"><span class="linenos">485</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="StarSet.__init__-486"><a href="#StarSet.__init__-486"><span class="linenos">486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">stars</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="intersect_with_halfspace">
                            <input id="intersect_with_halfspace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersect_with_halfspace</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">star</span><span class="p">:</span> <span class="n"><a href="#Star">Star</a></span>,</span><span class="param">	<span class="n">coef_mat</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span>,</span><span class="param">	<span class="n">bias_mat</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Star">Star</a></span>:</span></span>

                <label class="view-source-button" for="intersect_with_halfspace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#intersect_with_halfspace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="intersect_with_halfspace-489"><a href="#intersect_with_halfspace-489"><span class="linenos">489</span></a><span class="k">def</span> <span class="nf">intersect_with_halfspace</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">coef_mat</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bias_mat</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Star</span><span class="p">:</span>
</span><span id="intersect_with_halfspace-490"><a href="#intersect_with_halfspace-490"><span class="linenos">490</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="intersect_with_halfspace-491"><a href="#intersect_with_halfspace-491"><span class="linenos">491</span></a><span class="sd">    Function which takes as input a Star and a halfspace defined by its coefficient matrix and bias vector</span>
</span><span id="intersect_with_halfspace-492"><a href="#intersect_with_halfspace-492"><span class="linenos">492</span></a><span class="sd">    and returns the Star resulting from the intersection of the input Star with the halfspace.</span>
</span><span id="intersect_with_halfspace-493"><a href="#intersect_with_halfspace-493"><span class="linenos">493</span></a>
</span><span id="intersect_with_halfspace-494"><a href="#intersect_with_halfspace-494"><span class="linenos">494</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="intersect_with_halfspace-495"><a href="#intersect_with_halfspace-495"><span class="linenos">495</span></a>
</span><span id="intersect_with_halfspace-496"><a href="#intersect_with_halfspace-496"><span class="linenos">496</span></a>    <span class="n">new_center</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span>
</span><span id="intersect_with_halfspace-497"><a href="#intersect_with_halfspace-497"><span class="linenos">497</span></a>    <span class="n">new_basis_matrix</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span>
</span><span id="intersect_with_halfspace-498"><a href="#intersect_with_halfspace-498"><span class="linenos">498</span></a>    <span class="n">hs_pred_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">coef_mat</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="intersect_with_halfspace-499"><a href="#intersect_with_halfspace-499"><span class="linenos">499</span></a>    <span class="n">hs_pred_bias</span> <span class="o">=</span> <span class="n">bias_mat</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">coef_mat</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
</span><span id="intersect_with_halfspace-500"><a href="#intersect_with_halfspace-500"><span class="linenos">500</span></a>    <span class="n">new_pred_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span><span class="p">,</span> <span class="n">hs_pred_matrix</span><span class="p">))</span>
</span><span id="intersect_with_halfspace-501"><a href="#intersect_with_halfspace-501"><span class="linenos">501</span></a>    <span class="n">new_pred_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span><span class="p">,</span> <span class="n">hs_pred_bias</span><span class="p">))</span>
</span><span id="intersect_with_halfspace-502"><a href="#intersect_with_halfspace-502"><span class="linenos">502</span></a>
</span><span id="intersect_with_halfspace-503"><a href="#intersect_with_halfspace-503"><span class="linenos">503</span></a>    <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_pred_matrix</span><span class="p">,</span> <span class="n">new_pred_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_matrix</span><span class="p">)</span>
</span><span id="intersect_with_halfspace-504"><a href="#intersect_with_halfspace-504"><span class="linenos">504</span></a>
</span><span id="intersect_with_halfspace-505"><a href="#intersect_with_halfspace-505"><span class="linenos">505</span></a>    <span class="k">return</span> <span class="n">new_star</span>
</span></pre></div>


            <div class="docstring"><p>Function which takes as input a Star and a halfspace defined by its coefficient matrix and bias vector
and returns the Star resulting from the intersection of the input Star with the halfspace.</p>
</div>


                </section>
                <section id="mixed_single_relu_forward">
                            <input id="mixed_single_relu_forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mixed_single_relu_forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">star</span><span class="p">:</span> <span class="n"><a href="#Star">Star</a></span>,</span><span class="param">	<span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">params</span><span class="p">:</span> <span class="n">List</span>,</span><span class="param">	<span class="n">layer_bounds</span><span class="p">:</span> <span class="n"><a href="bp/bounds.html#AbstractBounds">pynever.strategies.bp.bounds.AbstractBounds</a></span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n"><a href="#Star">Star</a></span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="mixed_single_relu_forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#mixed_single_relu_forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="mixed_single_relu_forward-611"><a href="#mixed_single_relu_forward-611"><span class="linenos">611</span></a><span class="k">def</span> <span class="nf">mixed_single_relu_forward</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">layer_bounds</span><span class="p">:</span> <span class="n">AbstractBounds</span><span class="p">)</span> \
</span><span id="mixed_single_relu_forward-612"><a href="#mixed_single_relu_forward-612"><span class="linenos">612</span></a>        <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
</span><span id="mixed_single_relu_forward-613"><a href="#mixed_single_relu_forward-613"><span class="linenos">613</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="mixed_single_relu_forward-614"><a href="#mixed_single_relu_forward-614"><span class="linenos">614</span></a><span class="sd">    Utility function for the management of the forward for AbsReLUNode. It is outside</span>
</span><span id="mixed_single_relu_forward-615"><a href="#mixed_single_relu_forward-615"><span class="linenos">615</span></a><span class="sd">    the class scope since multiprocessing does not support parallelization with</span>
</span><span id="mixed_single_relu_forward-616"><a href="#mixed_single_relu_forward-616"><span class="linenos">616</span></a><span class="sd">    function internal to classes.</span>
</span><span id="mixed_single_relu_forward-617"><a href="#mixed_single_relu_forward-617"><span class="linenos">617</span></a>
</span><span id="mixed_single_relu_forward-618"><a href="#mixed_single_relu_forward-618"><span class="linenos">618</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="mixed_single_relu_forward-619"><a href="#mixed_single_relu_forward-619"><span class="linenos">619</span></a>
</span><span id="mixed_single_relu_forward-620"><a href="#mixed_single_relu_forward-620"><span class="linenos">620</span></a>    <span class="k">assert</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;given_flags&quot;</span> <span class="ow">or</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons&quot;</span> <span class="ow">or</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons_rel&quot;</span><span class="p">,</span> \
</span><span id="mixed_single_relu_forward-621"><a href="#mixed_single_relu_forward-621"><span class="linenos">621</span></a>        <span class="s2">&quot;Heuristic Selected is not valid&quot;</span>
</span><span id="mixed_single_relu_forward-622"><a href="#mixed_single_relu_forward-622"><span class="linenos">622</span></a>
</span><span id="mixed_single_relu_forward-623"><a href="#mixed_single_relu_forward-623"><span class="linenos">623</span></a>    <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="p">{</span><span class="n">star</span><span class="p">}</span>
</span><span id="mixed_single_relu_forward-624"><a href="#mixed_single_relu_forward-624"><span class="linenos">624</span></a>    <span class="k">if</span> <span class="n">star</span><span class="o">.</span><span class="n">check_if_empty</span><span class="p">():</span>
</span><span id="mixed_single_relu_forward-625"><a href="#mixed_single_relu_forward-625"><span class="linenos">625</span></a>        <span class="k">return</span> <span class="nb">set</span><span class="p">(),</span> <span class="kc">None</span>
</span><span id="mixed_single_relu_forward-626"><a href="#mixed_single_relu_forward-626"><span class="linenos">626</span></a>
</span><span id="mixed_single_relu_forward-627"><a href="#mixed_single_relu_forward-627"><span class="linenos">627</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-628"><a href="#mixed_single_relu_forward-628"><span class="linenos">628</span></a>        <span class="n">n_areas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="mixed_single_relu_forward-629"><a href="#mixed_single_relu_forward-629"><span class="linenos">629</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="mixed_single_relu_forward-630"><a href="#mixed_single_relu_forward-630"><span class="linenos">630</span></a>            <span class="k">if</span> <span class="n">layer_bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_lower</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_upper</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="mixed_single_relu_forward-631"><a href="#mixed_single_relu_forward-631"><span class="linenos">631</span></a>                <span class="n">n_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="mixed_single_relu_forward-632"><a href="#mixed_single_relu_forward-632"><span class="linenos">632</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-633"><a href="#mixed_single_relu_forward-633"><span class="linenos">633</span></a>                <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="mixed_single_relu_forward-634"><a href="#mixed_single_relu_forward-634"><span class="linenos">634</span></a>                <span class="n">n_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">lb</span> <span class="o">*</span> <span class="n">ub</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
</span><span id="mixed_single_relu_forward-635"><a href="#mixed_single_relu_forward-635"><span class="linenos">635</span></a>
</span><span id="mixed_single_relu_forward-636"><a href="#mixed_single_relu_forward-636"><span class="linenos">636</span></a>        <span class="n">n_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_areas</span><span class="p">)</span>
</span><span id="mixed_single_relu_forward-637"><a href="#mixed_single_relu_forward-637"><span class="linenos">637</span></a>
</span><span id="mixed_single_relu_forward-638"><a href="#mixed_single_relu_forward-638"><span class="linenos">638</span></a>        <span class="k">if</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons&quot;</span> <span class="ow">or</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons_rel&quot;</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-639"><a href="#mixed_single_relu_forward-639"><span class="linenos">639</span></a>
</span><span id="mixed_single_relu_forward-640"><a href="#mixed_single_relu_forward-640"><span class="linenos">640</span></a>            <span class="n">n_neurons</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="mixed_single_relu_forward-641"><a href="#mixed_single_relu_forward-641"><span class="linenos">641</span></a>
</span><span id="mixed_single_relu_forward-642"><a href="#mixed_single_relu_forward-642"><span class="linenos">642</span></a>            <span class="k">if</span> <span class="n">n_neurons</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-643"><a href="#mixed_single_relu_forward-643"><span class="linenos">643</span></a>
</span><span id="mixed_single_relu_forward-644"><a href="#mixed_single_relu_forward-644"><span class="linenos">644</span></a>                <span class="c1"># We compute the ordered indexes of the neurons with decreasing values of the areas.</span>
</span><span id="mixed_single_relu_forward-645"><a href="#mixed_single_relu_forward-645"><span class="linenos">645</span></a>                <span class="c1"># Our idea is that a greater value for the area correspond to greater loss of precision if the</span>
</span><span id="mixed_single_relu_forward-646"><a href="#mixed_single_relu_forward-646"><span class="linenos">646</span></a>                <span class="c1"># star is not refined for the corresponding neuron.</span>
</span><span id="mixed_single_relu_forward-647"><a href="#mixed_single_relu_forward-647"><span class="linenos">647</span></a>                <span class="k">if</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;best_n_neurons_rel&quot;</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-648"><a href="#mixed_single_relu_forward-648"><span class="linenos">648</span></a>                    <span class="n">relevances</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="mixed_single_relu_forward-649"><a href="#mixed_single_relu_forward-649"><span class="linenos">649</span></a>                    <span class="n">n_areas</span> <span class="o">=</span> <span class="n">n_areas</span> <span class="o">*</span> <span class="n">relevances</span>
</span><span id="mixed_single_relu_forward-650"><a href="#mixed_single_relu_forward-650"><span class="linenos">650</span></a>
</span><span id="mixed_single_relu_forward-651"><a href="#mixed_single_relu_forward-651"><span class="linenos">651</span></a>                <span class="n">sorted_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">n_areas</span><span class="p">))</span>
</span><span id="mixed_single_relu_forward-652"><a href="#mixed_single_relu_forward-652"><span class="linenos">652</span></a>                <span class="n">index_to_refine</span> <span class="o">=</span> <span class="n">sorted_indexes</span><span class="p">[:</span><span class="n">n_neurons</span><span class="p">]</span>
</span><span id="mixed_single_relu_forward-653"><a href="#mixed_single_relu_forward-653"><span class="linenos">653</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-654"><a href="#mixed_single_relu_forward-654"><span class="linenos">654</span></a>                <span class="n">index_to_refine</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="mixed_single_relu_forward-655"><a href="#mixed_single_relu_forward-655"><span class="linenos">655</span></a>
</span><span id="mixed_single_relu_forward-656"><a href="#mixed_single_relu_forward-656"><span class="linenos">656</span></a>            <span class="n">refinement_flags</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="mixed_single_relu_forward-657"><a href="#mixed_single_relu_forward-657"><span class="linenos">657</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="mixed_single_relu_forward-658"><a href="#mixed_single_relu_forward-658"><span class="linenos">658</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_to_refine</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-659"><a href="#mixed_single_relu_forward-659"><span class="linenos">659</span></a>                    <span class="n">refinement_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="mixed_single_relu_forward-660"><a href="#mixed_single_relu_forward-660"><span class="linenos">660</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-661"><a href="#mixed_single_relu_forward-661"><span class="linenos">661</span></a>                    <span class="n">refinement_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="mixed_single_relu_forward-662"><a href="#mixed_single_relu_forward-662"><span class="linenos">662</span></a>
</span><span id="mixed_single_relu_forward-663"><a href="#mixed_single_relu_forward-663"><span class="linenos">663</span></a>        <span class="k">elif</span> <span class="n">heuristic</span> <span class="o">==</span> <span class="s2">&quot;given_flags&quot;</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-664"><a href="#mixed_single_relu_forward-664"><span class="linenos">664</span></a>            <span class="n">refinement_flags</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="mixed_single_relu_forward-665"><a href="#mixed_single_relu_forward-665"><span class="linenos">665</span></a>
</span><span id="mixed_single_relu_forward-666"><a href="#mixed_single_relu_forward-666"><span class="linenos">666</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-667"><a href="#mixed_single_relu_forward-667"><span class="linenos">667</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="mixed_single_relu_forward-668"><a href="#mixed_single_relu_forward-668"><span class="linenos">668</span></a>
</span><span id="mixed_single_relu_forward-669"><a href="#mixed_single_relu_forward-669"><span class="linenos">669</span></a>        <span class="k">if</span> <span class="n">layer_bounds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-670"><a href="#mixed_single_relu_forward-670"><span class="linenos">670</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="mixed_single_relu_forward-671"><a href="#mixed_single_relu_forward-671"><span class="linenos">671</span></a>                <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="n">__mixed_step_relu</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">refinement_flags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="mixed_single_relu_forward-672"><a href="#mixed_single_relu_forward-672"><span class="linenos">672</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="mixed_single_relu_forward-673"><a href="#mixed_single_relu_forward-673"><span class="linenos">673</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="mixed_single_relu_forward-674"><a href="#mixed_single_relu_forward-674"><span class="linenos">674</span></a>                <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="n">__mixed_step_relu</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">refinement_flags</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="mixed_single_relu_forward-675"><a href="#mixed_single_relu_forward-675"><span class="linenos">675</span></a>                                                   <span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_lower</span><span class="p">()[</span><span class="n">i</span><span class="p">],</span> <span class="n">layer_bounds</span><span class="o">.</span><span class="n">get_upper</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
</span><span id="mixed_single_relu_forward-676"><a href="#mixed_single_relu_forward-676"><span class="linenos">676</span></a>
</span><span id="mixed_single_relu_forward-677"><a href="#mixed_single_relu_forward-677"><span class="linenos">677</span></a>        <span class="k">return</span> <span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">n_areas</span>
</span></pre></div>


            <div class="docstring"><p>Utility function for the management of the forward for AbsReLUNode. It is outside
the class scope since multiprocessing does not support parallelization with
function internal to classes.</p>
</div>


                </section>
                <section id="single_fc_forward">
                            <input id="single_fc_forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">single_fc_forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">star</span><span class="p">:</span> <span class="n"><a href="#Star">Star</a></span>,</span><span class="param">	<span class="n">weight</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span>,</span><span class="param">	<span class="n">bias</span><span class="p">:</span> <span class="n"><a href="../tensor.html#Tensor">pynever.tensor.Tensor</a></span></span><span class="return-annotation">) -> <span class="n">Set</span><span class="p">[</span><span class="n"><a href="#Star">Star</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="single_fc_forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#single_fc_forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="single_fc_forward-680"><a href="#single_fc_forward-680"><span class="linenos">680</span></a><span class="k">def</span> <span class="nf">single_fc_forward</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="single_fc_forward-681"><a href="#single_fc_forward-681"><span class="linenos">681</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="single_fc_forward-682"><a href="#single_fc_forward-682"><span class="linenos">682</span></a><span class="sd">    Utility function for the management of the forward for AbsFullyConnectedNode. It is outside</span>
</span><span id="single_fc_forward-683"><a href="#single_fc_forward-683"><span class="linenos">683</span></a><span class="sd">    the class scope since multiprocessing does not support parallelization with</span>
</span><span id="single_fc_forward-684"><a href="#single_fc_forward-684"><span class="linenos">684</span></a><span class="sd">    function internal to classes.</span>
</span><span id="single_fc_forward-685"><a href="#single_fc_forward-685"><span class="linenos">685</span></a>
</span><span id="single_fc_forward-686"><a href="#single_fc_forward-686"><span class="linenos">686</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="single_fc_forward-687"><a href="#single_fc_forward-687"><span class="linenos">687</span></a>
</span><span id="single_fc_forward-688"><a href="#single_fc_forward-688"><span class="linenos">688</span></a>    <span class="k">assert</span> <span class="p">(</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="single_fc_forward-689"><a href="#single_fc_forward-689"><span class="linenos">689</span></a>
</span><span id="single_fc_forward-690"><a href="#single_fc_forward-690"><span class="linenos">690</span></a>    <span class="n">new_basis_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">)</span>
</span><span id="single_fc_forward-691"><a href="#single_fc_forward-691"><span class="linenos">691</span></a>    <span class="n">new_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="p">)</span> <span class="o">+</span> <span class="n">bias</span>
</span><span id="single_fc_forward-692"><a href="#single_fc_forward-692"><span class="linenos">692</span></a>    <span class="n">new_predicate_matrix</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_matrix</span>
</span><span id="single_fc_forward-693"><a href="#single_fc_forward-693"><span class="linenos">693</span></a>    <span class="n">new_predicate_bias</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">predicate_bias</span>
</span><span id="single_fc_forward-694"><a href="#single_fc_forward-694"><span class="linenos">694</span></a>
</span><span id="single_fc_forward-695"><a href="#single_fc_forward-695"><span class="linenos">695</span></a>    <span class="n">new_star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">new_predicate_matrix</span><span class="p">,</span> <span class="n">new_predicate_bias</span><span class="p">,</span> <span class="n">new_center</span><span class="p">,</span> <span class="n">new_basis_matrix</span><span class="p">)</span>
</span><span id="single_fc_forward-696"><a href="#single_fc_forward-696"><span class="linenos">696</span></a>
</span><span id="single_fc_forward-697"><a href="#single_fc_forward-697"><span class="linenos">697</span></a>    <span class="k">return</span> <span class="p">{</span><span class="n">new_star</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Utility function for the management of the forward for AbsFullyConnectedNode. It is outside
the class scope since multiprocessing does not support parallelization with
function internal to classes.</p>
</div>


                </section>
                <section id="sig">
                            <input id="sig-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sig</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="sig-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sig"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sig-700"><a href="#sig-700"><span class="linenos">700</span></a><span class="k">def</span> <span class="nf">sig</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="sig-701"><a href="#sig-701"><span class="linenos">701</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="sig-702"><a href="#sig-702"><span class="linenos">702</span></a><span class="sd">    Utility function computing the logistic function of the input.</span>
</span><span id="sig-703"><a href="#sig-703"><span class="linenos">703</span></a>
</span><span id="sig-704"><a href="#sig-704"><span class="linenos">704</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sig-705"><a href="#sig-705"><span class="linenos">705</span></a>
</span><span id="sig-706"><a href="#sig-706"><span class="linenos">706</span></a>    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Utility function computing the logistic function of the input.</p>
</div>


                </section>
                <section id="sig_fod">
                            <input id="sig_fod-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sig_fod</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="sig_fod-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sig_fod"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sig_fod-709"><a href="#sig_fod-709"><span class="linenos">709</span></a><span class="k">def</span> <span class="nf">sig_fod</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="sig_fod-710"><a href="#sig_fod-710"><span class="linenos">710</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="sig_fod-711"><a href="#sig_fod-711"><span class="linenos">711</span></a><span class="sd">    Utility function computing the first order derivative of the logistic function of the input.</span>
</span><span id="sig_fod-712"><a href="#sig_fod-712"><span class="linenos">712</span></a>
</span><span id="sig_fod-713"><a href="#sig_fod-713"><span class="linenos">713</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sig_fod-714"><a href="#sig_fod-714"><span class="linenos">714</span></a>
</span><span id="sig_fod-715"><a href="#sig_fod-715"><span class="linenos">715</span></a>    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Utility function computing the first order derivative of the logistic function of the input.</p>
</div>


                </section>
                <section id="area_sig_triangle">
                            <input id="area_sig_triangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">area_sig_triangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">lb</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">ub</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="area_sig_triangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#area_sig_triangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="area_sig_triangle-718"><a href="#area_sig_triangle-718"><span class="linenos">718</span></a><span class="k">def</span> <span class="nf">area_sig_triangle</span><span class="p">(</span><span class="n">lb</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ub</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="area_sig_triangle-719"><a href="#area_sig_triangle-719"><span class="linenos">719</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="area_sig_triangle-720"><a href="#area_sig_triangle-720"><span class="linenos">720</span></a><span class="sd">    Utility function computing the area of the triangle defined by an upper bound and a lower bound on the</span>
</span><span id="area_sig_triangle-721"><a href="#area_sig_triangle-721"><span class="linenos">721</span></a><span class="sd">    logistic function. In particular is the triangle composed by the two tangents and line passing by the two bounds.</span>
</span><span id="area_sig_triangle-722"><a href="#area_sig_triangle-722"><span class="linenos">722</span></a>
</span><span id="area_sig_triangle-723"><a href="#area_sig_triangle-723"><span class="linenos">723</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="area_sig_triangle-724"><a href="#area_sig_triangle-724"><span class="linenos">724</span></a>
</span><span id="area_sig_triangle-725"><a href="#area_sig_triangle-725"><span class="linenos">725</span></a>    <span class="n">x_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">ub</span> <span class="o">*</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">lb</span> <span class="o">*</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">-</span> \
</span><span id="area_sig_triangle-726"><a href="#area_sig_triangle-726"><span class="linenos">726</span></a>          <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span>
</span><span id="area_sig_triangle-727"><a href="#area_sig_triangle-727"><span class="linenos">727</span></a>
</span><span id="area_sig_triangle-728"><a href="#area_sig_triangle-728"><span class="linenos">728</span></a>    <span class="n">y_p</span> <span class="o">=</span> <span class="n">sig_fod</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">ub</span><span class="p">)</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span>
</span><span id="area_sig_triangle-729"><a href="#area_sig_triangle-729"><span class="linenos">729</span></a>
</span><span id="area_sig_triangle-730"><a href="#area_sig_triangle-730"><span class="linenos">730</span></a>    <span class="n">height</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y_p</span> <span class="o">-</span> <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_p</span> <span class="o">+</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">)</span> <span class="o">-</span> <span class="n">lb</span> <span class="o">*</span> <span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">))</span> <span class="o">/</span> \
</span><span id="area_sig_triangle-731"><a href="#area_sig_triangle-731"><span class="linenos">731</span></a>             <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">((</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="area_sig_triangle-732"><a href="#area_sig_triangle-732"><span class="linenos">732</span></a>
</span><span id="area_sig_triangle-733"><a href="#area_sig_triangle-733"><span class="linenos">733</span></a>    <span class="n">base</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">ub</span> <span class="o">-</span> <span class="n">lb</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">sig</span><span class="p">(</span><span class="n">ub</span><span class="p">)</span> <span class="o">-</span> <span class="n">sig</span><span class="p">(</span><span class="n">lb</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
</span><span id="area_sig_triangle-734"><a href="#area_sig_triangle-734"><span class="linenos">734</span></a>
</span><span id="area_sig_triangle-735"><a href="#area_sig_triangle-735"><span class="linenos">735</span></a>    <span class="k">return</span> <span class="n">base</span> <span class="o">*</span> <span class="n">height</span> <span class="o">/</span> <span class="mf">2.0</span>
</span></pre></div>


            <div class="docstring"><p>Utility function computing the area of the triangle defined by an upper bound and a lower bound on the
logistic function. In particular is the triangle composed by the two tangents and line passing by the two bounds.</p>
</div>


                </section>
                <section id="single_sigmoid_forward">
                            <input id="single_sigmoid_forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">single_sigmoid_forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">star</span><span class="p">:</span> <span class="n"><a href="#Star">Star</a></span>,</span><span class="param">	<span class="n">approx_levels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Set</span><span class="p">[</span><span class="n"><a href="#Star">Star</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="single_sigmoid_forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#single_sigmoid_forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="single_sigmoid_forward-861"><a href="#single_sigmoid_forward-861"><span class="linenos">861</span></a><span class="k">def</span> <span class="nf">single_sigmoid_forward</span><span class="p">(</span><span class="n">star</span><span class="p">:</span> <span class="n">Star</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Star</span><span class="p">]:</span>
</span><span id="single_sigmoid_forward-862"><a href="#single_sigmoid_forward-862"><span class="linenos">862</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="single_sigmoid_forward-863"><a href="#single_sigmoid_forward-863"><span class="linenos">863</span></a><span class="sd">    Utility function for the management of the forward for AbsSigmoidNode. It is outside</span>
</span><span id="single_sigmoid_forward-864"><a href="#single_sigmoid_forward-864"><span class="linenos">864</span></a><span class="sd">    the class scope since multiprocessing does not support parallelization with</span>
</span><span id="single_sigmoid_forward-865"><a href="#single_sigmoid_forward-865"><span class="linenos">865</span></a><span class="sd">    function internal to classes.</span>
</span><span id="single_sigmoid_forward-866"><a href="#single_sigmoid_forward-866"><span class="linenos">866</span></a>
</span><span id="single_sigmoid_forward-867"><a href="#single_sigmoid_forward-867"><span class="linenos">867</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="single_sigmoid_forward-868"><a href="#single_sigmoid_forward-868"><span class="linenos">868</span></a>
</span><span id="single_sigmoid_forward-869"><a href="#single_sigmoid_forward-869"><span class="linenos">869</span></a>    <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.01</span>
</span><span id="single_sigmoid_forward-870"><a href="#single_sigmoid_forward-870"><span class="linenos">870</span></a>    <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="p">{</span><span class="n">star</span><span class="p">}</span>
</span><span id="single_sigmoid_forward-871"><a href="#single_sigmoid_forward-871"><span class="linenos">871</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="single_sigmoid_forward-872"><a href="#single_sigmoid_forward-872"><span class="linenos">872</span></a>        <span class="n">temp_abs_input</span> <span class="o">=</span> <span class="n">__approx_step_sigmoid</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tolerance</span><span class="p">)</span>
</span><span id="single_sigmoid_forward-873"><a href="#single_sigmoid_forward-873"><span class="linenos">873</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, NumStar: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_abs_input</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="single_sigmoid_forward-874"><a href="#single_sigmoid_forward-874"><span class="linenos">874</span></a>    <span class="k">return</span> <span class="n">temp_abs_input</span>
</span></pre></div>


            <div class="docstring"><p>Utility function for the management of the forward for AbsSigmoidNode. It is outside
the class scope since multiprocessing does not support parallelization with
function internal to classes.</p>
</div>


                </section>
                <section id="RefinementState">
                            <input id="RefinementState-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RefinementState</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="RefinementState-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RefinementState"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RefinementState-877"><a href="#RefinementState-877"><span class="linenos">877</span></a><span class="k">class</span> <span class="nc">RefinementState</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="RefinementState-878"><a href="#RefinementState-878"><span class="linenos">878</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RefinementState-879"><a href="#RefinementState-879"><span class="linenos">879</span></a><span class="sd">    A class used for the internal control of the refinement strategies/heuristics applied in the abstraction refinement</span>
</span><span id="RefinementState-880"><a href="#RefinementState-880"><span class="linenos">880</span></a><span class="sd">    step. At present is not still used and it is just an abstract placeholder. It will be used in future</span>
</span><span id="RefinementState-881"><a href="#RefinementState-881"><span class="linenos">881</span></a><span class="sd">    implementations.</span>
</span><span id="RefinementState-882"><a href="#RefinementState-882"><span class="linenos">882</span></a>
</span><span id="RefinementState-883"><a href="#RefinementState-883"><span class="linenos">883</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RefinementState-884"><a href="#RefinementState-884"><span class="linenos">884</span></a>
</span><span id="RefinementState-885"><a href="#RefinementState-885"><span class="linenos">885</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>A class used for the internal control of the refinement strategies/heuristics applied in the abstraction refinement
step. At present is not still used and it is just an abstract placeholder. It will be used in future
implementations.</p>
</div>


                </section>
                <section id="AbsLayerNode">
                            <input id="AbsLayerNode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsLayerNode</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="AbsLayerNode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsLayerNode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsLayerNode-888"><a href="#AbsLayerNode-888"><span class="linenos">888</span></a><span class="k">class</span> <span class="nc">AbsLayerNode</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="AbsLayerNode-889"><a href="#AbsLayerNode-889"><span class="linenos">889</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsLayerNode-890"><a href="#AbsLayerNode-890"><span class="linenos">890</span></a><span class="sd">    An abstract class used for our internal representation of a generic Abstract Transformer Layer of an</span>
</span><span id="AbsLayerNode-891"><a href="#AbsLayerNode-891"><span class="linenos">891</span></a><span class="sd">    AbsNeural Network. Its concrete children correspond to real abstract interpretation network layers.</span>
</span><span id="AbsLayerNode-892"><a href="#AbsLayerNode-892"><span class="linenos">892</span></a>
</span><span id="AbsLayerNode-893"><a href="#AbsLayerNode-893"><span class="linenos">893</span></a><span class="sd">    Attributes</span>
</span><span id="AbsLayerNode-894"><a href="#AbsLayerNode-894"><span class="linenos">894</span></a><span class="sd">    ----------</span>
</span><span id="AbsLayerNode-895"><a href="#AbsLayerNode-895"><span class="linenos">895</span></a><span class="sd">    identifier : str</span>
</span><span id="AbsLayerNode-896"><a href="#AbsLayerNode-896"><span class="linenos">896</span></a><span class="sd">        Identifier of the AbsLayerNode.</span>
</span><span id="AbsLayerNode-897"><a href="#AbsLayerNode-897"><span class="linenos">897</span></a>
</span><span id="AbsLayerNode-898"><a href="#AbsLayerNode-898"><span class="linenos">898</span></a><span class="sd">    ref_node : SingleInputLayerNode</span>
</span><span id="AbsLayerNode-899"><a href="#AbsLayerNode-899"><span class="linenos">899</span></a><span class="sd">        Reference SingleInputLayerNode for the abstract transformer.</span>
</span><span id="AbsLayerNode-900"><a href="#AbsLayerNode-900"><span class="linenos">900</span></a>
</span><span id="AbsLayerNode-901"><a href="#AbsLayerNode-901"><span class="linenos">901</span></a><span class="sd">    Methods</span>
</span><span id="AbsLayerNode-902"><a href="#AbsLayerNode-902"><span class="linenos">902</span></a><span class="sd">    ----------</span>
</span><span id="AbsLayerNode-903"><a href="#AbsLayerNode-903"><span class="linenos">903</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="AbsLayerNode-904"><a href="#AbsLayerNode-904"><span class="linenos">904</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="AbsLayerNode-905"><a href="#AbsLayerNode-905"><span class="linenos">905</span></a><span class="sd">        transformer.</span>
</span><span id="AbsLayerNode-906"><a href="#AbsLayerNode-906"><span class="linenos">906</span></a>
</span><span id="AbsLayerNode-907"><a href="#AbsLayerNode-907"><span class="linenos">907</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="AbsLayerNode-908"><a href="#AbsLayerNode-908"><span class="linenos">908</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="AbsLayerNode-909"><a href="#AbsLayerNode-909"><span class="linenos">909</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="AbsLayerNode-910"><a href="#AbsLayerNode-910"><span class="linenos">910</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="AbsLayerNode-911"><a href="#AbsLayerNode-911"><span class="linenos">911</span></a>
</span><span id="AbsLayerNode-912"><a href="#AbsLayerNode-912"><span class="linenos">912</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsLayerNode-913"><a href="#AbsLayerNode-913"><span class="linenos">913</span></a>
</span><span id="AbsLayerNode-914"><a href="#AbsLayerNode-914"><span class="linenos">914</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">SingleInputLayerNode</span><span class="p">):</span>
</span><span id="AbsLayerNode-915"><a href="#AbsLayerNode-915"><span class="linenos">915</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span><span id="AbsLayerNode-916"><a href="#AbsLayerNode-916"><span class="linenos">916</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span> <span class="o">=</span> <span class="n">ref_node</span>
</span><span id="AbsLayerNode-917"><a href="#AbsLayerNode-917"><span class="linenos">917</span></a>
</span><span id="AbsLayerNode-918"><a href="#AbsLayerNode-918"><span class="linenos">918</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AbsLayerNode-919"><a href="#AbsLayerNode-919"><span class="linenos">919</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsLayerNode-920"><a href="#AbsLayerNode-920"><span class="linenos">920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsLayerNode-921"><a href="#AbsLayerNode-921"><span class="linenos">921</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsLayerNode-922"><a href="#AbsLayerNode-922"><span class="linenos">922</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsLayerNode-923"><a href="#AbsLayerNode-923"><span class="linenos">923</span></a>
</span><span id="AbsLayerNode-924"><a href="#AbsLayerNode-924"><span class="linenos">924</span></a><span class="sd">        Parameters</span>
</span><span id="AbsLayerNode-925"><a href="#AbsLayerNode-925"><span class="linenos">925</span></a><span class="sd">        ----------</span>
</span><span id="AbsLayerNode-926"><a href="#AbsLayerNode-926"><span class="linenos">926</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsLayerNode-927"><a href="#AbsLayerNode-927"><span class="linenos">927</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsLayerNode-928"><a href="#AbsLayerNode-928"><span class="linenos">928</span></a>
</span><span id="AbsLayerNode-929"><a href="#AbsLayerNode-929"><span class="linenos">929</span></a><span class="sd">        Returns</span>
</span><span id="AbsLayerNode-930"><a href="#AbsLayerNode-930"><span class="linenos">930</span></a><span class="sd">        ----------</span>
</span><span id="AbsLayerNode-931"><a href="#AbsLayerNode-931"><span class="linenos">931</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsLayerNode-932"><a href="#AbsLayerNode-932"><span class="linenos">932</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsLayerNode-933"><a href="#AbsLayerNode-933"><span class="linenos">933</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsLayerNode-934"><a href="#AbsLayerNode-934"><span class="linenos">934</span></a>
</span><span id="AbsLayerNode-935"><a href="#AbsLayerNode-935"><span class="linenos">935</span></a>        <span class="k">pass</span>
</span><span id="AbsLayerNode-936"><a href="#AbsLayerNode-936"><span class="linenos">936</span></a>
</span><span id="AbsLayerNode-937"><a href="#AbsLayerNode-937"><span class="linenos">937</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AbsLayerNode-938"><a href="#AbsLayerNode-938"><span class="linenos">938</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsLayerNode-939"><a href="#AbsLayerNode-939"><span class="linenos">939</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsLayerNode-940"><a href="#AbsLayerNode-940"><span class="linenos">940</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsLayerNode-941"><a href="#AbsLayerNode-941"><span class="linenos">941</span></a>
</span><span id="AbsLayerNode-942"><a href="#AbsLayerNode-942"><span class="linenos">942</span></a><span class="sd">        Parameters</span>
</span><span id="AbsLayerNode-943"><a href="#AbsLayerNode-943"><span class="linenos">943</span></a><span class="sd">        ----------</span>
</span><span id="AbsLayerNode-944"><a href="#AbsLayerNode-944"><span class="linenos">944</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsLayerNode-945"><a href="#AbsLayerNode-945"><span class="linenos">945</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsLayerNode-946"><a href="#AbsLayerNode-946"><span class="linenos">946</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsLayerNode-947"><a href="#AbsLayerNode-947"><span class="linenos">947</span></a>
</span><span id="AbsLayerNode-948"><a href="#AbsLayerNode-948"><span class="linenos">948</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>An abstract class used for our internal representation of a generic Abstract Transformer Layer of an
AbsNeural Network. Its concrete children correspond to real abstract interpretation network layers.</p>

<h2 id="attributes">Attributes</h2>

<p>identifier : str
    Identifier of the AbsLayerNode.</p>

<p>ref_node : SingleInputLayerNode
    Reference SingleInputLayerNode for the abstract transformer.</p>

<h2 id="methods">Methods</h2>

<p>forward(AbsElement)
    Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract
    transformer.</p>

<p>backward(RefinementState)
    Function which takes a reference to the refinement state and update both it and the state of the abstract
    transformer to control the refinement component of the abstraction. At present the function is just a
    placeholder for future implementations.</p>
</div>


                            <div id="AbsLayerNode.identifier" class="classattr">
                                <div class="attr variable">
            <span class="name">identifier</span>

        
    </div>
    <a class="headerlink" href="#AbsLayerNode.identifier"></a>
    
    

                            </div>
                            <div id="AbsLayerNode.ref_node" class="classattr">
                                <div class="attr variable">
            <span class="name">ref_node</span>

        
    </div>
    <a class="headerlink" href="#AbsLayerNode.ref_node"></a>
    
    

                            </div>
                            <div id="AbsLayerNode.forward" class="classattr">
                                        <input id="AbsLayerNode.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abc.abstractmethod</div>

        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">abs_input</span><span class="p">:</span> <span class="n"><a href="#AbsElement">AbsElement</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsElement">AbsElement</a></span>:</span></span>

                <label class="view-source-button" for="AbsLayerNode.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsLayerNode.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsLayerNode.forward-918"><a href="#AbsLayerNode.forward-918"><span class="linenos">918</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AbsLayerNode.forward-919"><a href="#AbsLayerNode.forward-919"><span class="linenos">919</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsLayerNode.forward-920"><a href="#AbsLayerNode.forward-920"><span class="linenos">920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsLayerNode.forward-921"><a href="#AbsLayerNode.forward-921"><span class="linenos">921</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsLayerNode.forward-922"><a href="#AbsLayerNode.forward-922"><span class="linenos">922</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsLayerNode.forward-923"><a href="#AbsLayerNode.forward-923"><span class="linenos">923</span></a>
</span><span id="AbsLayerNode.forward-924"><a href="#AbsLayerNode.forward-924"><span class="linenos">924</span></a><span class="sd">        Parameters</span>
</span><span id="AbsLayerNode.forward-925"><a href="#AbsLayerNode.forward-925"><span class="linenos">925</span></a><span class="sd">        ----------</span>
</span><span id="AbsLayerNode.forward-926"><a href="#AbsLayerNode.forward-926"><span class="linenos">926</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsLayerNode.forward-927"><a href="#AbsLayerNode.forward-927"><span class="linenos">927</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsLayerNode.forward-928"><a href="#AbsLayerNode.forward-928"><span class="linenos">928</span></a>
</span><span id="AbsLayerNode.forward-929"><a href="#AbsLayerNode.forward-929"><span class="linenos">929</span></a><span class="sd">        Returns</span>
</span><span id="AbsLayerNode.forward-930"><a href="#AbsLayerNode.forward-930"><span class="linenos">930</span></a><span class="sd">        ----------</span>
</span><span id="AbsLayerNode.forward-931"><a href="#AbsLayerNode.forward-931"><span class="linenos">931</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsLayerNode.forward-932"><a href="#AbsLayerNode.forward-932"><span class="linenos">932</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsLayerNode.forward-933"><a href="#AbsLayerNode.forward-933"><span class="linenos">933</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsLayerNode.forward-934"><a href="#AbsLayerNode.forward-934"><span class="linenos">934</span></a>
</span><span id="AbsLayerNode.forward-935"><a href="#AbsLayerNode.forward-935"><span class="linenos">935</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Compute the output AbsElement based on the input AbsElement and the characteristics of the
concrete abstract transformer.</p>

<h2 id="parameters">Parameters</h2>

<p>abs_input : AbsElement
    The input abstract element.</p>

<h2 id="returns">Returns</h2>

<p>AbsElement
    The AbsElement resulting from the computation corresponding to the abstract transformer.</p>
</div>


                            </div>
                            <div id="AbsLayerNode.backward" class="classattr">
                                        <input id="AbsLayerNode.backward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abc.abstractmethod</div>

        <span class="def">def</span>
        <span class="name">backward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ref_state</span><span class="p">:</span> <span class="n"><a href="#RefinementState">RefinementState</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsLayerNode.backward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsLayerNode.backward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsLayerNode.backward-937"><a href="#AbsLayerNode.backward-937"><span class="linenos">937</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AbsLayerNode.backward-938"><a href="#AbsLayerNode.backward-938"><span class="linenos">938</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsLayerNode.backward-939"><a href="#AbsLayerNode.backward-939"><span class="linenos">939</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsLayerNode.backward-940"><a href="#AbsLayerNode.backward-940"><span class="linenos">940</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsLayerNode.backward-941"><a href="#AbsLayerNode.backward-941"><span class="linenos">941</span></a>
</span><span id="AbsLayerNode.backward-942"><a href="#AbsLayerNode.backward-942"><span class="linenos">942</span></a><span class="sd">        Parameters</span>
</span><span id="AbsLayerNode.backward-943"><a href="#AbsLayerNode.backward-943"><span class="linenos">943</span></a><span class="sd">        ----------</span>
</span><span id="AbsLayerNode.backward-944"><a href="#AbsLayerNode.backward-944"><span class="linenos">944</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsLayerNode.backward-945"><a href="#AbsLayerNode.backward-945"><span class="linenos">945</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsLayerNode.backward-946"><a href="#AbsLayerNode.backward-946"><span class="linenos">946</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsLayerNode.backward-947"><a href="#AbsLayerNode.backward-947"><span class="linenos">947</span></a>
</span><span id="AbsLayerNode.backward-948"><a href="#AbsLayerNode.backward-948"><span class="linenos">948</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the RefinementState. At present the function is just a placeholder for future implementations.</p>

<h2 id="parameters">Parameters</h2>

<p>ref_state: RefinementState
    The RefinementState to update.</p>
</div>


                            </div>
                </section>
                <section id="AbsFullyConnectedNode">
                            <input id="AbsFullyConnectedNode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsFullyConnectedNode</span><wbr>(<span class="base"><a href="#AbsLayerNode">AbsLayerNode</a></span>):

                <label class="view-source-button" for="AbsFullyConnectedNode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsFullyConnectedNode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsFullyConnectedNode-951"><a href="#AbsFullyConnectedNode-951"><span class="linenos"> 951</span></a><span class="k">class</span> <span class="nc">AbsFullyConnectedNode</span><span class="p">(</span><span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode-952"><a href="#AbsFullyConnectedNode-952"><span class="linenos"> 952</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode-953"><a href="#AbsFullyConnectedNode-953"><span class="linenos"> 953</span></a><span class="sd">    A class used for our internal representation of a Fully Connected Abstract transformer.</span>
</span><span id="AbsFullyConnectedNode-954"><a href="#AbsFullyConnectedNode-954"><span class="linenos"> 954</span></a>
</span><span id="AbsFullyConnectedNode-955"><a href="#AbsFullyConnectedNode-955"><span class="linenos"> 955</span></a><span class="sd">    Attributes</span>
</span><span id="AbsFullyConnectedNode-956"><a href="#AbsFullyConnectedNode-956"><span class="linenos"> 956</span></a><span class="sd">    ----------</span>
</span><span id="AbsFullyConnectedNode-957"><a href="#AbsFullyConnectedNode-957"><span class="linenos"> 957</span></a><span class="sd">    identifier : str</span>
</span><span id="AbsFullyConnectedNode-958"><a href="#AbsFullyConnectedNode-958"><span class="linenos"> 958</span></a><span class="sd">        Identifier of the SingleInputLayerNode.</span>
</span><span id="AbsFullyConnectedNode-959"><a href="#AbsFullyConnectedNode-959"><span class="linenos"> 959</span></a>
</span><span id="AbsFullyConnectedNode-960"><a href="#AbsFullyConnectedNode-960"><span class="linenos"> 960</span></a><span class="sd">    ref_node : FullyConnectedNode</span>
</span><span id="AbsFullyConnectedNode-961"><a href="#AbsFullyConnectedNode-961"><span class="linenos"> 961</span></a><span class="sd">        SingleInputLayerNode di riferimento per l&#39;abstract transformer.</span>
</span><span id="AbsFullyConnectedNode-962"><a href="#AbsFullyConnectedNode-962"><span class="linenos"> 962</span></a>
</span><span id="AbsFullyConnectedNode-963"><a href="#AbsFullyConnectedNode-963"><span class="linenos"> 963</span></a><span class="sd">    Methods</span>
</span><span id="AbsFullyConnectedNode-964"><a href="#AbsFullyConnectedNode-964"><span class="linenos"> 964</span></a><span class="sd">    ----------</span>
</span><span id="AbsFullyConnectedNode-965"><a href="#AbsFullyConnectedNode-965"><span class="linenos"> 965</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="AbsFullyConnectedNode-966"><a href="#AbsFullyConnectedNode-966"><span class="linenos"> 966</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="AbsFullyConnectedNode-967"><a href="#AbsFullyConnectedNode-967"><span class="linenos"> 967</span></a><span class="sd">        transformer.</span>
</span><span id="AbsFullyConnectedNode-968"><a href="#AbsFullyConnectedNode-968"><span class="linenos"> 968</span></a>
</span><span id="AbsFullyConnectedNode-969"><a href="#AbsFullyConnectedNode-969"><span class="linenos"> 969</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="AbsFullyConnectedNode-970"><a href="#AbsFullyConnectedNode-970"><span class="linenos"> 970</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="AbsFullyConnectedNode-971"><a href="#AbsFullyConnectedNode-971"><span class="linenos"> 971</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="AbsFullyConnectedNode-972"><a href="#AbsFullyConnectedNode-972"><span class="linenos"> 972</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="AbsFullyConnectedNode-973"><a href="#AbsFullyConnectedNode-973"><span class="linenos"> 973</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode-974"><a href="#AbsFullyConnectedNode-974"><span class="linenos"> 974</span></a>
</span><span id="AbsFullyConnectedNode-975"><a href="#AbsFullyConnectedNode-975"><span class="linenos"> 975</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FullyConnectedNode</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode-976"><a href="#AbsFullyConnectedNode-976"><span class="linenos"> 976</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="AbsFullyConnectedNode-977"><a href="#AbsFullyConnectedNode-977"><span class="linenos"> 977</span></a>
</span><span id="AbsFullyConnectedNode-978"><a href="#AbsFullyConnectedNode-978"><span class="linenos"> 978</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode-979"><a href="#AbsFullyConnectedNode-979"><span class="linenos"> 979</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode-980"><a href="#AbsFullyConnectedNode-980"><span class="linenos"> 980</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsFullyConnectedNode-981"><a href="#AbsFullyConnectedNode-981"><span class="linenos"> 981</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsFullyConnectedNode-982"><a href="#AbsFullyConnectedNode-982"><span class="linenos"> 982</span></a>
</span><span id="AbsFullyConnectedNode-983"><a href="#AbsFullyConnectedNode-983"><span class="linenos"> 983</span></a><span class="sd">        Parameters</span>
</span><span id="AbsFullyConnectedNode-984"><a href="#AbsFullyConnectedNode-984"><span class="linenos"> 984</span></a><span class="sd">        ----------</span>
</span><span id="AbsFullyConnectedNode-985"><a href="#AbsFullyConnectedNode-985"><span class="linenos"> 985</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsFullyConnectedNode-986"><a href="#AbsFullyConnectedNode-986"><span class="linenos"> 986</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsFullyConnectedNode-987"><a href="#AbsFullyConnectedNode-987"><span class="linenos"> 987</span></a>
</span><span id="AbsFullyConnectedNode-988"><a href="#AbsFullyConnectedNode-988"><span class="linenos"> 988</span></a><span class="sd">        Returns</span>
</span><span id="AbsFullyConnectedNode-989"><a href="#AbsFullyConnectedNode-989"><span class="linenos"> 989</span></a><span class="sd">        ----------</span>
</span><span id="AbsFullyConnectedNode-990"><a href="#AbsFullyConnectedNode-990"><span class="linenos"> 990</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsFullyConnectedNode-991"><a href="#AbsFullyConnectedNode-991"><span class="linenos"> 991</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsFullyConnectedNode-992"><a href="#AbsFullyConnectedNode-992"><span class="linenos"> 992</span></a><span class="sd">            </span>
</span><span id="AbsFullyConnectedNode-993"><a href="#AbsFullyConnectedNode-993"><span class="linenos"> 993</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode-994"><a href="#AbsFullyConnectedNode-994"><span class="linenos"> 994</span></a>
</span><span id="AbsFullyConnectedNode-995"><a href="#AbsFullyConnectedNode-995"><span class="linenos"> 995</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode-996"><a href="#AbsFullyConnectedNode-996"><span class="linenos"> 996</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsFullyConnectedNode-997"><a href="#AbsFullyConnectedNode-997"><span class="linenos"> 997</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode-998"><a href="#AbsFullyConnectedNode-998"><span class="linenos"> 998</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="AbsFullyConnectedNode-999"><a href="#AbsFullyConnectedNode-999"><span class="linenos"> 999</span></a>
</span><span id="AbsFullyConnectedNode-1000"><a href="#AbsFullyConnectedNode-1000"><span class="linenos">1000</span></a>    <span class="k">def</span> <span class="nf">__starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode-1001"><a href="#AbsFullyConnectedNode-1001"><span class="linenos">1001</span></a>
</span><span id="AbsFullyConnectedNode-1002"><a href="#AbsFullyConnectedNode-1002"><span class="linenos">1002</span></a>        <span class="n">my_pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
</span><span id="AbsFullyConnectedNode-1003"><a href="#AbsFullyConnectedNode-1003"><span class="linenos">1003</span></a>
</span><span id="AbsFullyConnectedNode-1004"><a href="#AbsFullyConnectedNode-1004"><span class="linenos">1004</span></a>        <span class="c1"># Need to expand bias since they are memorized like one-dimensional vectors in FC nodes.</span>
</span><span id="AbsFullyConnectedNode-1005"><a href="#AbsFullyConnectedNode-1005"><span class="linenos">1005</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode-1006"><a href="#AbsFullyConnectedNode-1006"><span class="linenos">1006</span></a>            <span class="n">bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AbsFullyConnectedNode-1007"><a href="#AbsFullyConnectedNode-1007"><span class="linenos">1007</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode-1008"><a href="#AbsFullyConnectedNode-1008"><span class="linenos">1008</span></a>            <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">bias</span>
</span><span id="AbsFullyConnectedNode-1009"><a href="#AbsFullyConnectedNode-1009"><span class="linenos">1009</span></a>        <span class="n">parallel_results</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">single_fc_forward</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">,</span>
</span><span id="AbsFullyConnectedNode-1010"><a href="#AbsFullyConnectedNode-1010"><span class="linenos">1010</span></a>                                                                  <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">weight</span><span class="p">),</span>
</span><span id="AbsFullyConnectedNode-1011"><a href="#AbsFullyConnectedNode-1011"><span class="linenos">1011</span></a>                                                                  <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">bias</span><span class="p">)))</span>
</span><span id="AbsFullyConnectedNode-1012"><a href="#AbsFullyConnectedNode-1012"><span class="linenos">1012</span></a>        <span class="n">my_pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AbsFullyConnectedNode-1013"><a href="#AbsFullyConnectedNode-1013"><span class="linenos">1013</span></a>        <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="AbsFullyConnectedNode-1014"><a href="#AbsFullyConnectedNode-1014"><span class="linenos">1014</span></a>        <span class="k">for</span> <span class="n">star_set</span> <span class="ow">in</span> <span class="n">parallel_results</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode-1015"><a href="#AbsFullyConnectedNode-1015"><span class="linenos">1015</span></a>            <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">star_set</span><span class="p">)</span>
</span><span id="AbsFullyConnectedNode-1016"><a href="#AbsFullyConnectedNode-1016"><span class="linenos">1016</span></a>
</span><span id="AbsFullyConnectedNode-1017"><a href="#AbsFullyConnectedNode-1017"><span class="linenos">1017</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="AbsFullyConnectedNode-1018"><a href="#AbsFullyConnectedNode-1018"><span class="linenos">1018</span></a>
</span><span id="AbsFullyConnectedNode-1019"><a href="#AbsFullyConnectedNode-1019"><span class="linenos">1019</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode-1020"><a href="#AbsFullyConnectedNode-1020"><span class="linenos">1020</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode-1021"><a href="#AbsFullyConnectedNode-1021"><span class="linenos">1021</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsFullyConnectedNode-1022"><a href="#AbsFullyConnectedNode-1022"><span class="linenos">1022</span></a>
</span><span id="AbsFullyConnectedNode-1023"><a href="#AbsFullyConnectedNode-1023"><span class="linenos">1023</span></a><span class="sd">        Parameters</span>
</span><span id="AbsFullyConnectedNode-1024"><a href="#AbsFullyConnectedNode-1024"><span class="linenos">1024</span></a><span class="sd">        ----------</span>
</span><span id="AbsFullyConnectedNode-1025"><a href="#AbsFullyConnectedNode-1025"><span class="linenos">1025</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsFullyConnectedNode-1026"><a href="#AbsFullyConnectedNode-1026"><span class="linenos">1026</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsFullyConnectedNode-1027"><a href="#AbsFullyConnectedNode-1027"><span class="linenos">1027</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode-1028"><a href="#AbsFullyConnectedNode-1028"><span class="linenos">1028</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>A class used for our internal representation of a Fully Connected Abstract transformer.</p>

<h2 id="attributes">Attributes</h2>

<p>identifier : str
    Identifier of the SingleInputLayerNode.</p>

<p>ref_node : FullyConnectedNode
    SingleInputLayerNode di riferimento per l'abstract transformer.</p>

<h2 id="methods">Methods</h2>

<p>forward(AbsElement)
    Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract
    transformer.</p>

<p>backward(RefinementState)
    Function which takes a reference to the refinement state and update both it and the state of the abstract
    transformer to control the refinement component of the abstraction. At present the function is just a
    placeholder for future implementations.</p>
</div>


                            <div id="AbsFullyConnectedNode.__init__" class="classattr">
                                        <input id="AbsFullyConnectedNode.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AbsFullyConnectedNode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">ref_node</span><span class="p">:</span> <span class="n"><a href="../nodes.html#FullyConnectedNode">pynever.nodes.FullyConnectedNode</a></span></span>)</span>

                <label class="view-source-button" for="AbsFullyConnectedNode.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsFullyConnectedNode.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsFullyConnectedNode.__init__-975"><a href="#AbsFullyConnectedNode.__init__-975"><span class="linenos">975</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FullyConnectedNode</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode.__init__-976"><a href="#AbsFullyConnectedNode.__init__-976"><span class="linenos">976</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AbsFullyConnectedNode.forward" class="classattr">
                                        <input id="AbsFullyConnectedNode.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">abs_input</span><span class="p">:</span> <span class="n"><a href="#AbsElement">AbsElement</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsElement">AbsElement</a></span>:</span></span>

                <label class="view-source-button" for="AbsFullyConnectedNode.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsFullyConnectedNode.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsFullyConnectedNode.forward-978"><a href="#AbsFullyConnectedNode.forward-978"><span class="linenos">978</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode.forward-979"><a href="#AbsFullyConnectedNode.forward-979"><span class="linenos">979</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode.forward-980"><a href="#AbsFullyConnectedNode.forward-980"><span class="linenos">980</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsFullyConnectedNode.forward-981"><a href="#AbsFullyConnectedNode.forward-981"><span class="linenos">981</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsFullyConnectedNode.forward-982"><a href="#AbsFullyConnectedNode.forward-982"><span class="linenos">982</span></a>
</span><span id="AbsFullyConnectedNode.forward-983"><a href="#AbsFullyConnectedNode.forward-983"><span class="linenos">983</span></a><span class="sd">        Parameters</span>
</span><span id="AbsFullyConnectedNode.forward-984"><a href="#AbsFullyConnectedNode.forward-984"><span class="linenos">984</span></a><span class="sd">        ----------</span>
</span><span id="AbsFullyConnectedNode.forward-985"><a href="#AbsFullyConnectedNode.forward-985"><span class="linenos">985</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsFullyConnectedNode.forward-986"><a href="#AbsFullyConnectedNode.forward-986"><span class="linenos">986</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsFullyConnectedNode.forward-987"><a href="#AbsFullyConnectedNode.forward-987"><span class="linenos">987</span></a>
</span><span id="AbsFullyConnectedNode.forward-988"><a href="#AbsFullyConnectedNode.forward-988"><span class="linenos">988</span></a><span class="sd">        Returns</span>
</span><span id="AbsFullyConnectedNode.forward-989"><a href="#AbsFullyConnectedNode.forward-989"><span class="linenos">989</span></a><span class="sd">        ----------</span>
</span><span id="AbsFullyConnectedNode.forward-990"><a href="#AbsFullyConnectedNode.forward-990"><span class="linenos">990</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsFullyConnectedNode.forward-991"><a href="#AbsFullyConnectedNode.forward-991"><span class="linenos">991</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsFullyConnectedNode.forward-992"><a href="#AbsFullyConnectedNode.forward-992"><span class="linenos">992</span></a><span class="sd">            </span>
</span><span id="AbsFullyConnectedNode.forward-993"><a href="#AbsFullyConnectedNode.forward-993"><span class="linenos">993</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode.forward-994"><a href="#AbsFullyConnectedNode.forward-994"><span class="linenos">994</span></a>
</span><span id="AbsFullyConnectedNode.forward-995"><a href="#AbsFullyConnectedNode.forward-995"><span class="linenos">995</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode.forward-996"><a href="#AbsFullyConnectedNode.forward-996"><span class="linenos">996</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsFullyConnectedNode.forward-997"><a href="#AbsFullyConnectedNode.forward-997"><span class="linenos">997</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsFullyConnectedNode.forward-998"><a href="#AbsFullyConnectedNode.forward-998"><span class="linenos">998</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Compute the output AbsElement based on the input AbsElement and the characteristics of the
concrete abstract transformer.</p>

<h2 id="parameters">Parameters</h2>

<p>abs_input : AbsElement
    The input abstract element.</p>

<h2 id="returns">Returns</h2>

<p>AbsElement
    The AbsElement resulting from the computation corresponding to the abstract transformer.</p>
</div>


                            </div>
                            <div id="AbsFullyConnectedNode.backward" class="classattr">
                                        <input id="AbsFullyConnectedNode.backward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">backward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ref_state</span><span class="p">:</span> <span class="n"><a href="#RefinementState">RefinementState</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsFullyConnectedNode.backward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsFullyConnectedNode.backward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsFullyConnectedNode.backward-1019"><a href="#AbsFullyConnectedNode.backward-1019"><span class="linenos">1019</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsFullyConnectedNode.backward-1020"><a href="#AbsFullyConnectedNode.backward-1020"><span class="linenos">1020</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode.backward-1021"><a href="#AbsFullyConnectedNode.backward-1021"><span class="linenos">1021</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsFullyConnectedNode.backward-1022"><a href="#AbsFullyConnectedNode.backward-1022"><span class="linenos">1022</span></a>
</span><span id="AbsFullyConnectedNode.backward-1023"><a href="#AbsFullyConnectedNode.backward-1023"><span class="linenos">1023</span></a><span class="sd">        Parameters</span>
</span><span id="AbsFullyConnectedNode.backward-1024"><a href="#AbsFullyConnectedNode.backward-1024"><span class="linenos">1024</span></a><span class="sd">        ----------</span>
</span><span id="AbsFullyConnectedNode.backward-1025"><a href="#AbsFullyConnectedNode.backward-1025"><span class="linenos">1025</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsFullyConnectedNode.backward-1026"><a href="#AbsFullyConnectedNode.backward-1026"><span class="linenos">1026</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsFullyConnectedNode.backward-1027"><a href="#AbsFullyConnectedNode.backward-1027"><span class="linenos">1027</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsFullyConnectedNode.backward-1028"><a href="#AbsFullyConnectedNode.backward-1028"><span class="linenos">1028</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the RefinementState. At present the function is just a placeholder for future implementations.</p>

<h2 id="parameters">Parameters</h2>

<p>ref_state: RefinementState
    The RefinementState to update.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AbsLayerNode">AbsLayerNode</a></dt>
                                <dd id="AbsFullyConnectedNode.identifier" class="variable"><a href="#AbsLayerNode.identifier">identifier</a></dd>
                <dd id="AbsFullyConnectedNode.ref_node" class="variable"><a href="#AbsLayerNode.ref_node">ref_node</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AbsReLUNode">
                            <input id="AbsReLUNode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsReLUNode</span><wbr>(<span class="base"><a href="#AbsLayerNode">AbsLayerNode</a></span>):

                <label class="view-source-button" for="AbsReLUNode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsReLUNode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsReLUNode-1031"><a href="#AbsReLUNode-1031"><span class="linenos">1031</span></a><span class="k">class</span> <span class="nc">AbsReLUNode</span><span class="p">(</span><span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="AbsReLUNode-1032"><a href="#AbsReLUNode-1032"><span class="linenos">1032</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1033"><a href="#AbsReLUNode-1033"><span class="linenos">1033</span></a><span class="sd">    A class used for our internal representation of a ReLU Abstract transformer.</span>
</span><span id="AbsReLUNode-1034"><a href="#AbsReLUNode-1034"><span class="linenos">1034</span></a>
</span><span id="AbsReLUNode-1035"><a href="#AbsReLUNode-1035"><span class="linenos">1035</span></a><span class="sd">    Attributes</span>
</span><span id="AbsReLUNode-1036"><a href="#AbsReLUNode-1036"><span class="linenos">1036</span></a><span class="sd">    ----------</span>
</span><span id="AbsReLUNode-1037"><a href="#AbsReLUNode-1037"><span class="linenos">1037</span></a><span class="sd">    identifier : str</span>
</span><span id="AbsReLUNode-1038"><a href="#AbsReLUNode-1038"><span class="linenos">1038</span></a><span class="sd">        Identifier of the SingleInputLayerNode.</span>
</span><span id="AbsReLUNode-1039"><a href="#AbsReLUNode-1039"><span class="linenos">1039</span></a>
</span><span id="AbsReLUNode-1040"><a href="#AbsReLUNode-1040"><span class="linenos">1040</span></a><span class="sd">    ref_node : ReLUNode</span>
</span><span id="AbsReLUNode-1041"><a href="#AbsReLUNode-1041"><span class="linenos">1041</span></a><span class="sd">        Reference SingleInputLayerNode for the abstract transformer.</span>
</span><span id="AbsReLUNode-1042"><a href="#AbsReLUNode-1042"><span class="linenos">1042</span></a>
</span><span id="AbsReLUNode-1043"><a href="#AbsReLUNode-1043"><span class="linenos">1043</span></a><span class="sd">    heuristic : str</span>
</span><span id="AbsReLUNode-1044"><a href="#AbsReLUNode-1044"><span class="linenos">1044</span></a><span class="sd">        Heuristic used to decide the refinement level of the abstraction.</span>
</span><span id="AbsReLUNode-1045"><a href="#AbsReLUNode-1045"><span class="linenos">1045</span></a><span class="sd">        At present can be only one of the following:</span>
</span><span id="AbsReLUNode-1046"><a href="#AbsReLUNode-1046"><span class="linenos">1046</span></a><span class="sd">        - complete: for each star all the neurons are processed with a precise abstraction</span>
</span><span id="AbsReLUNode-1047"><a href="#AbsReLUNode-1047"><span class="linenos">1047</span></a><span class="sd">        - mixed: for each star a given number of neurons is processed with a precise abstraction</span>
</span><span id="AbsReLUNode-1048"><a href="#AbsReLUNode-1048"><span class="linenos">1048</span></a><span class="sd">        - overapprox: for each star all the neurons are processed with a coarse abstraction</span>
</span><span id="AbsReLUNode-1049"><a href="#AbsReLUNode-1049"><span class="linenos">1049</span></a>
</span><span id="AbsReLUNode-1050"><a href="#AbsReLUNode-1050"><span class="linenos">1050</span></a><span class="sd">    params : List</span>
</span><span id="AbsReLUNode-1051"><a href="#AbsReLUNode-1051"><span class="linenos">1051</span></a><span class="sd">        Parameters for the heuristic of interest.</span>
</span><span id="AbsReLUNode-1052"><a href="#AbsReLUNode-1052"><span class="linenos">1052</span></a><span class="sd">        It is a List with the number of neurons to process with a precise abstraction in this layer.</span>
</span><span id="AbsReLUNode-1053"><a href="#AbsReLUNode-1053"><span class="linenos">1053</span></a>
</span><span id="AbsReLUNode-1054"><a href="#AbsReLUNode-1054"><span class="linenos">1054</span></a><span class="sd">    Methods</span>
</span><span id="AbsReLUNode-1055"><a href="#AbsReLUNode-1055"><span class="linenos">1055</span></a><span class="sd">    ----------</span>
</span><span id="AbsReLUNode-1056"><a href="#AbsReLUNode-1056"><span class="linenos">1056</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="AbsReLUNode-1057"><a href="#AbsReLUNode-1057"><span class="linenos">1057</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="AbsReLUNode-1058"><a href="#AbsReLUNode-1058"><span class="linenos">1058</span></a><span class="sd">        transformer.</span>
</span><span id="AbsReLUNode-1059"><a href="#AbsReLUNode-1059"><span class="linenos">1059</span></a>
</span><span id="AbsReLUNode-1060"><a href="#AbsReLUNode-1060"><span class="linenos">1060</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="AbsReLUNode-1061"><a href="#AbsReLUNode-1061"><span class="linenos">1061</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="AbsReLUNode-1062"><a href="#AbsReLUNode-1062"><span class="linenos">1062</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="AbsReLUNode-1063"><a href="#AbsReLUNode-1063"><span class="linenos">1063</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="AbsReLUNode-1064"><a href="#AbsReLUNode-1064"><span class="linenos">1064</span></a>
</span><span id="AbsReLUNode-1065"><a href="#AbsReLUNode-1065"><span class="linenos">1065</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1066"><a href="#AbsReLUNode-1066"><span class="linenos">1066</span></a>
</span><span id="AbsReLUNode-1067"><a href="#AbsReLUNode-1067"><span class="linenos">1067</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ReLUNode</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
</span><span id="AbsReLUNode-1068"><a href="#AbsReLUNode-1068"><span class="linenos">1068</span></a>
</span><span id="AbsReLUNode-1069"><a href="#AbsReLUNode-1069"><span class="linenos">1069</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="AbsReLUNode-1070"><a href="#AbsReLUNode-1070"><span class="linenos">1070</span></a>
</span><span id="AbsReLUNode-1071"><a href="#AbsReLUNode-1071"><span class="linenos">1071</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span> <span class="o">=</span> <span class="n">heuristic</span>
</span><span id="AbsReLUNode-1072"><a href="#AbsReLUNode-1072"><span class="linenos">1072</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="AbsReLUNode-1073"><a href="#AbsReLUNode-1073"><span class="linenos">1073</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AbsReLUNode-1074"><a href="#AbsReLUNode-1074"><span class="linenos">1074</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AbsReLUNode-1075"><a href="#AbsReLUNode-1075"><span class="linenos">1075</span></a>
</span><span id="AbsReLUNode-1076"><a href="#AbsReLUNode-1076"><span class="linenos">1076</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">AbstractBounds</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsReLUNode-1077"><a href="#AbsReLUNode-1077"><span class="linenos">1077</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1078"><a href="#AbsReLUNode-1078"><span class="linenos">1078</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsReLUNode-1079"><a href="#AbsReLUNode-1079"><span class="linenos">1079</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsReLUNode-1080"><a href="#AbsReLUNode-1080"><span class="linenos">1080</span></a>
</span><span id="AbsReLUNode-1081"><a href="#AbsReLUNode-1081"><span class="linenos">1081</span></a><span class="sd">        Parameters</span>
</span><span id="AbsReLUNode-1082"><a href="#AbsReLUNode-1082"><span class="linenos">1082</span></a><span class="sd">        ----------</span>
</span><span id="AbsReLUNode-1083"><a href="#AbsReLUNode-1083"><span class="linenos">1083</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsReLUNode-1084"><a href="#AbsReLUNode-1084"><span class="linenos">1084</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsReLUNode-1085"><a href="#AbsReLUNode-1085"><span class="linenos">1085</span></a>
</span><span id="AbsReLUNode-1086"><a href="#AbsReLUNode-1086"><span class="linenos">1086</span></a><span class="sd">        bounds : dict</span>
</span><span id="AbsReLUNode-1087"><a href="#AbsReLUNode-1087"><span class="linenos">1087</span></a><span class="sd">            Optional bounds for this layer as computed by the previous</span>
</span><span id="AbsReLUNode-1088"><a href="#AbsReLUNode-1088"><span class="linenos">1088</span></a>
</span><span id="AbsReLUNode-1089"><a href="#AbsReLUNode-1089"><span class="linenos">1089</span></a><span class="sd">        Returns</span>
</span><span id="AbsReLUNode-1090"><a href="#AbsReLUNode-1090"><span class="linenos">1090</span></a><span class="sd">        ----------</span>
</span><span id="AbsReLUNode-1091"><a href="#AbsReLUNode-1091"><span class="linenos">1091</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsReLUNode-1092"><a href="#AbsReLUNode-1092"><span class="linenos">1092</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsReLUNode-1093"><a href="#AbsReLUNode-1093"><span class="linenos">1093</span></a>
</span><span id="AbsReLUNode-1094"><a href="#AbsReLUNode-1094"><span class="linenos">1094</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1095"><a href="#AbsReLUNode-1095"><span class="linenos">1095</span></a>
</span><span id="AbsReLUNode-1096"><a href="#AbsReLUNode-1096"><span class="linenos">1096</span></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsReLUNode-1097"><a href="#AbsReLUNode-1097"><span class="linenos">1097</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span> <span class="o">=</span> <span class="n">bounds</span>
</span><span id="AbsReLUNode-1098"><a href="#AbsReLUNode-1098"><span class="linenos">1098</span></a>
</span><span id="AbsReLUNode-1099"><a href="#AbsReLUNode-1099"><span class="linenos">1099</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="AbsReLUNode-1100"><a href="#AbsReLUNode-1100"><span class="linenos">1100</span></a>            <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="AbsReLUNode-1101"><a href="#AbsReLUNode-1101"><span class="linenos">1101</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parallel_starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsReLUNode-1102"><a href="#AbsReLUNode-1102"><span class="linenos">1102</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AbsReLUNode-1103"><a href="#AbsReLUNode-1103"><span class="linenos">1103</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsReLUNode-1104"><a href="#AbsReLUNode-1104"><span class="linenos">1104</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsReLUNode-1105"><a href="#AbsReLUNode-1105"><span class="linenos">1105</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="AbsReLUNode-1106"><a href="#AbsReLUNode-1106"><span class="linenos">1106</span></a>
</span><span id="AbsReLUNode-1107"><a href="#AbsReLUNode-1107"><span class="linenos">1107</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsReLUNode-1108"><a href="#AbsReLUNode-1108"><span class="linenos">1108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1109"><a href="#AbsReLUNode-1109"><span class="linenos">1109</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsReLUNode-1110"><a href="#AbsReLUNode-1110"><span class="linenos">1110</span></a>
</span><span id="AbsReLUNode-1111"><a href="#AbsReLUNode-1111"><span class="linenos">1111</span></a><span class="sd">        Parameters</span>
</span><span id="AbsReLUNode-1112"><a href="#AbsReLUNode-1112"><span class="linenos">1112</span></a><span class="sd">        ----------</span>
</span><span id="AbsReLUNode-1113"><a href="#AbsReLUNode-1113"><span class="linenos">1113</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsReLUNode-1114"><a href="#AbsReLUNode-1114"><span class="linenos">1114</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsReLUNode-1115"><a href="#AbsReLUNode-1115"><span class="linenos">1115</span></a>
</span><span id="AbsReLUNode-1116"><a href="#AbsReLUNode-1116"><span class="linenos">1116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1117"><a href="#AbsReLUNode-1117"><span class="linenos">1117</span></a>
</span><span id="AbsReLUNode-1118"><a href="#AbsReLUNode-1118"><span class="linenos">1118</span></a>        <span class="k">pass</span>
</span><span id="AbsReLUNode-1119"><a href="#AbsReLUNode-1119"><span class="linenos">1119</span></a>
</span><span id="AbsReLUNode-1120"><a href="#AbsReLUNode-1120"><span class="linenos">1120</span></a>    <span class="k">def</span> <span class="nf">__parallel_starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="AbsReLUNode-1121"><a href="#AbsReLUNode-1121"><span class="linenos">1121</span></a>
</span><span id="AbsReLUNode-1122"><a href="#AbsReLUNode-1122"><span class="linenos">1122</span></a>        <span class="n">my_pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
</span><span id="AbsReLUNode-1123"><a href="#AbsReLUNode-1123"><span class="linenos">1123</span></a>        <span class="n">parallel_results</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">mixed_single_relu_forward</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">,</span>
</span><span id="AbsReLUNode-1124"><a href="#AbsReLUNode-1124"><span class="linenos">1124</span></a>                                                                          <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span><span class="p">),</span>
</span><span id="AbsReLUNode-1125"><a href="#AbsReLUNode-1125"><span class="linenos">1125</span></a>                                                                          <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
</span><span id="AbsReLUNode-1126"><a href="#AbsReLUNode-1126"><span class="linenos">1126</span></a>                                                                          <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span><span class="p">)))</span>
</span><span id="AbsReLUNode-1127"><a href="#AbsReLUNode-1127"><span class="linenos">1127</span></a>        <span class="n">my_pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AbsReLUNode-1128"><a href="#AbsReLUNode-1128"><span class="linenos">1128</span></a>
</span><span id="AbsReLUNode-1129"><a href="#AbsReLUNode-1129"><span class="linenos">1129</span></a>        <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="AbsReLUNode-1130"><a href="#AbsReLUNode-1130"><span class="linenos">1130</span></a>
</span><span id="AbsReLUNode-1131"><a href="#AbsReLUNode-1131"><span class="linenos">1131</span></a>        <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">)</span>
</span><span id="AbsReLUNode-1132"><a href="#AbsReLUNode-1132"><span class="linenos">1132</span></a>        <span class="n">num_areas</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AbsReLUNode-1133"><a href="#AbsReLUNode-1133"><span class="linenos">1133</span></a>        <span class="k">for</span> <span class="n">star_set</span><span class="p">,</span> <span class="n">areas</span> <span class="ow">in</span> <span class="n">parallel_results</span><span class="p">:</span>
</span><span id="AbsReLUNode-1134"><a href="#AbsReLUNode-1134"><span class="linenos">1134</span></a>            <span class="k">if</span> <span class="n">star_set</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>
</span><span id="AbsReLUNode-1135"><a href="#AbsReLUNode-1135"><span class="linenos">1135</span></a>                <span class="n">num_areas</span> <span class="o">=</span> <span class="n">num_areas</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="AbsReLUNode-1136"><a href="#AbsReLUNode-1136"><span class="linenos">1136</span></a>                <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">+</span> <span class="n">areas</span>
</span><span id="AbsReLUNode-1137"><a href="#AbsReLUNode-1137"><span class="linenos">1137</span></a>            <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">star_set</span><span class="p">)</span>
</span><span id="AbsReLUNode-1138"><a href="#AbsReLUNode-1138"><span class="linenos">1138</span></a>
</span><span id="AbsReLUNode-1139"><a href="#AbsReLUNode-1139"><span class="linenos">1139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">/</span> <span class="n">num_areas</span>
</span><span id="AbsReLUNode-1140"><a href="#AbsReLUNode-1140"><span class="linenos">1140</span></a>
</span><span id="AbsReLUNode-1141"><a href="#AbsReLUNode-1141"><span class="linenos">1141</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="AbsReLUNode-1142"><a href="#AbsReLUNode-1142"><span class="linenos">1142</span></a>
</span><span id="AbsReLUNode-1143"><a href="#AbsReLUNode-1143"><span class="linenos">1143</span></a>    <span class="k">def</span> <span class="nf">__starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="AbsReLUNode-1144"><a href="#AbsReLUNode-1144"><span class="linenos">1144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1145"><a href="#AbsReLUNode-1145"><span class="linenos">1145</span></a><span class="sd">        Forward function specialized for the concrete AbsElement StarSet.</span>
</span><span id="AbsReLUNode-1146"><a href="#AbsReLUNode-1146"><span class="linenos">1146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsReLUNode-1147"><a href="#AbsReLUNode-1147"><span class="linenos">1147</span></a>
</span><span id="AbsReLUNode-1148"><a href="#AbsReLUNode-1148"><span class="linenos">1148</span></a>        <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="AbsReLUNode-1149"><a href="#AbsReLUNode-1149"><span class="linenos">1149</span></a>        <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">)</span>
</span><span id="AbsReLUNode-1150"><a href="#AbsReLUNode-1150"><span class="linenos">1150</span></a>        <span class="n">num_areas</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AbsReLUNode-1151"><a href="#AbsReLUNode-1151"><span class="linenos">1151</span></a>        <span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">:</span>
</span><span id="AbsReLUNode-1152"><a href="#AbsReLUNode-1152"><span class="linenos">1152</span></a>            <span class="n">result</span><span class="p">,</span> <span class="n">areas</span> <span class="o">=</span> <span class="n">mixed_single_relu_forward</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span><span class="p">)</span>
</span><span id="AbsReLUNode-1153"><a href="#AbsReLUNode-1153"><span class="linenos">1153</span></a>            <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="AbsReLUNode-1154"><a href="#AbsReLUNode-1154"><span class="linenos">1154</span></a>            <span class="n">tot_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">+</span> <span class="n">areas</span>
</span><span id="AbsReLUNode-1155"><a href="#AbsReLUNode-1155"><span class="linenos">1155</span></a>            <span class="n">num_areas</span> <span class="o">=</span> <span class="n">num_areas</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="AbsReLUNode-1156"><a href="#AbsReLUNode-1156"><span class="linenos">1156</span></a>
</span><span id="AbsReLUNode-1157"><a href="#AbsReLUNode-1157"><span class="linenos">1157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="n">tot_areas</span> <span class="o">/</span> <span class="n">num_areas</span>
</span><span id="AbsReLUNode-1158"><a href="#AbsReLUNode-1158"><span class="linenos">1158</span></a>
</span><span id="AbsReLUNode-1159"><a href="#AbsReLUNode-1159"><span class="linenos">1159</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span></pre></div>


            <div class="docstring"><p>A class used for our internal representation of a ReLU Abstract transformer.</p>

<h2 id="attributes">Attributes</h2>

<p>identifier : str
    Identifier of the SingleInputLayerNode.</p>

<p>ref_node : ReLUNode
    Reference SingleInputLayerNode for the abstract transformer.</p>

<p>heuristic : str
    Heuristic used to decide the refinement level of the abstraction.
    At present can be only one of the following:
    - complete: for each star all the neurons are processed with a precise abstraction
    - mixed: for each star a given number of neurons is processed with a precise abstraction
    - overapprox: for each star all the neurons are processed with a coarse abstraction</p>

<p>params : List
    Parameters for the heuristic of interest.
    It is a List with the number of neurons to process with a precise abstraction in this layer.</p>

<h2 id="methods">Methods</h2>

<p>forward(AbsElement)
    Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract
    transformer.</p>

<p>backward(RefinementState)
    Function which takes a reference to the refinement state and update both it and the state of the abstract
    transformer to control the refinement component of the abstraction. At present the function is just a
    placeholder for future implementations.</p>
</div>


                            <div id="AbsReLUNode.__init__" class="classattr">
                                        <input id="AbsReLUNode.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AbsReLUNode</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ref_node</span><span class="p">:</span> <span class="n"><a href="../nodes.html#ReLUNode">pynever.nodes.ReLUNode</a></span>,</span><span class="param">	<span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">params</span><span class="p">:</span> <span class="n">List</span></span>)</span>

                <label class="view-source-button" for="AbsReLUNode.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsReLUNode.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsReLUNode.__init__-1067"><a href="#AbsReLUNode.__init__-1067"><span class="linenos">1067</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ReLUNode</span><span class="p">,</span> <span class="n">heuristic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
</span><span id="AbsReLUNode.__init__-1068"><a href="#AbsReLUNode.__init__-1068"><span class="linenos">1068</span></a>
</span><span id="AbsReLUNode.__init__-1069"><a href="#AbsReLUNode.__init__-1069"><span class="linenos">1069</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="AbsReLUNode.__init__-1070"><a href="#AbsReLUNode.__init__-1070"><span class="linenos">1070</span></a>
</span><span id="AbsReLUNode.__init__-1071"><a href="#AbsReLUNode.__init__-1071"><span class="linenos">1071</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heuristic</span> <span class="o">=</span> <span class="n">heuristic</span>
</span><span id="AbsReLUNode.__init__-1072"><a href="#AbsReLUNode.__init__-1072"><span class="linenos">1072</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="AbsReLUNode.__init__-1073"><a href="#AbsReLUNode.__init__-1073"><span class="linenos">1073</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AbsReLUNode.__init__-1074"><a href="#AbsReLUNode.__init__-1074"><span class="linenos">1074</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_areas</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="AbsReLUNode.heuristic" class="classattr">
                                <div class="attr variable">
            <span class="name">heuristic</span>

        
    </div>
    <a class="headerlink" href="#AbsReLUNode.heuristic"></a>
    
    

                            </div>
                            <div id="AbsReLUNode.params" class="classattr">
                                <div class="attr variable">
            <span class="name">params</span>

        
    </div>
    <a class="headerlink" href="#AbsReLUNode.params"></a>
    
    

                            </div>
                            <div id="AbsReLUNode.layer_bounds" class="classattr">
                                <div class="attr variable">
            <span class="name">layer_bounds</span>

        
    </div>
    <a class="headerlink" href="#AbsReLUNode.layer_bounds"></a>
    
    

                            </div>
                            <div id="AbsReLUNode.n_areas" class="classattr">
                                <div class="attr variable">
            <span class="name">n_areas</span>

        
    </div>
    <a class="headerlink" href="#AbsReLUNode.n_areas"></a>
    
    

                            </div>
                            <div id="AbsReLUNode.forward" class="classattr">
                                        <input id="AbsReLUNode.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">abs_input</span><span class="p">:</span> <span class="n"><a href="#AbsElement">AbsElement</a></span>,</span><span class="param">	<span class="n">bounds</span><span class="p">:</span> <span class="n"><a href="bp/bounds.html#AbstractBounds">pynever.strategies.bp.bounds.AbstractBounds</a></span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsElement">AbsElement</a></span>:</span></span>

                <label class="view-source-button" for="AbsReLUNode.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsReLUNode.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsReLUNode.forward-1076"><a href="#AbsReLUNode.forward-1076"><span class="linenos">1076</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">AbstractBounds</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsReLUNode.forward-1077"><a href="#AbsReLUNode.forward-1077"><span class="linenos">1077</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsReLUNode.forward-1078"><a href="#AbsReLUNode.forward-1078"><span class="linenos">1078</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsReLUNode.forward-1079"><a href="#AbsReLUNode.forward-1079"><span class="linenos">1079</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsReLUNode.forward-1080"><a href="#AbsReLUNode.forward-1080"><span class="linenos">1080</span></a>
</span><span id="AbsReLUNode.forward-1081"><a href="#AbsReLUNode.forward-1081"><span class="linenos">1081</span></a><span class="sd">        Parameters</span>
</span><span id="AbsReLUNode.forward-1082"><a href="#AbsReLUNode.forward-1082"><span class="linenos">1082</span></a><span class="sd">        ----------</span>
</span><span id="AbsReLUNode.forward-1083"><a href="#AbsReLUNode.forward-1083"><span class="linenos">1083</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsReLUNode.forward-1084"><a href="#AbsReLUNode.forward-1084"><span class="linenos">1084</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsReLUNode.forward-1085"><a href="#AbsReLUNode.forward-1085"><span class="linenos">1085</span></a>
</span><span id="AbsReLUNode.forward-1086"><a href="#AbsReLUNode.forward-1086"><span class="linenos">1086</span></a><span class="sd">        bounds : dict</span>
</span><span id="AbsReLUNode.forward-1087"><a href="#AbsReLUNode.forward-1087"><span class="linenos">1087</span></a><span class="sd">            Optional bounds for this layer as computed by the previous</span>
</span><span id="AbsReLUNode.forward-1088"><a href="#AbsReLUNode.forward-1088"><span class="linenos">1088</span></a>
</span><span id="AbsReLUNode.forward-1089"><a href="#AbsReLUNode.forward-1089"><span class="linenos">1089</span></a><span class="sd">        Returns</span>
</span><span id="AbsReLUNode.forward-1090"><a href="#AbsReLUNode.forward-1090"><span class="linenos">1090</span></a><span class="sd">        ----------</span>
</span><span id="AbsReLUNode.forward-1091"><a href="#AbsReLUNode.forward-1091"><span class="linenos">1091</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsReLUNode.forward-1092"><a href="#AbsReLUNode.forward-1092"><span class="linenos">1092</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsReLUNode.forward-1093"><a href="#AbsReLUNode.forward-1093"><span class="linenos">1093</span></a>
</span><span id="AbsReLUNode.forward-1094"><a href="#AbsReLUNode.forward-1094"><span class="linenos">1094</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsReLUNode.forward-1095"><a href="#AbsReLUNode.forward-1095"><span class="linenos">1095</span></a>
</span><span id="AbsReLUNode.forward-1096"><a href="#AbsReLUNode.forward-1096"><span class="linenos">1096</span></a>        <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsReLUNode.forward-1097"><a href="#AbsReLUNode.forward-1097"><span class="linenos">1097</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">layer_bounds</span> <span class="o">=</span> <span class="n">bounds</span>
</span><span id="AbsReLUNode.forward-1098"><a href="#AbsReLUNode.forward-1098"><span class="linenos">1098</span></a>
</span><span id="AbsReLUNode.forward-1099"><a href="#AbsReLUNode.forward-1099"><span class="linenos">1099</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="AbsReLUNode.forward-1100"><a href="#AbsReLUNode.forward-1100"><span class="linenos">1100</span></a>            <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="AbsReLUNode.forward-1101"><a href="#AbsReLUNode.forward-1101"><span class="linenos">1101</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parallel_starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsReLUNode.forward-1102"><a href="#AbsReLUNode.forward-1102"><span class="linenos">1102</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AbsReLUNode.forward-1103"><a href="#AbsReLUNode.forward-1103"><span class="linenos">1103</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsReLUNode.forward-1104"><a href="#AbsReLUNode.forward-1104"><span class="linenos">1104</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsReLUNode.forward-1105"><a href="#AbsReLUNode.forward-1105"><span class="linenos">1105</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Compute the output AbsElement based on the input AbsElement and the characteristics of the
concrete abstract transformer.</p>

<h2 id="parameters">Parameters</h2>

<p>abs_input : AbsElement
    The input abstract element.</p>

<p>bounds : dict
    Optional bounds for this layer as computed by the previous</p>

<h2 id="returns">Returns</h2>

<p>AbsElement
    The AbsElement resulting from the computation corresponding to the abstract transformer.</p>
</div>


                            </div>
                            <div id="AbsReLUNode.backward" class="classattr">
                                        <input id="AbsReLUNode.backward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">backward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ref_state</span><span class="p">:</span> <span class="n"><a href="#RefinementState">RefinementState</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsReLUNode.backward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsReLUNode.backward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsReLUNode.backward-1107"><a href="#AbsReLUNode.backward-1107"><span class="linenos">1107</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsReLUNode.backward-1108"><a href="#AbsReLUNode.backward-1108"><span class="linenos">1108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsReLUNode.backward-1109"><a href="#AbsReLUNode.backward-1109"><span class="linenos">1109</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsReLUNode.backward-1110"><a href="#AbsReLUNode.backward-1110"><span class="linenos">1110</span></a>
</span><span id="AbsReLUNode.backward-1111"><a href="#AbsReLUNode.backward-1111"><span class="linenos">1111</span></a><span class="sd">        Parameters</span>
</span><span id="AbsReLUNode.backward-1112"><a href="#AbsReLUNode.backward-1112"><span class="linenos">1112</span></a><span class="sd">        ----------</span>
</span><span id="AbsReLUNode.backward-1113"><a href="#AbsReLUNode.backward-1113"><span class="linenos">1113</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsReLUNode.backward-1114"><a href="#AbsReLUNode.backward-1114"><span class="linenos">1114</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsReLUNode.backward-1115"><a href="#AbsReLUNode.backward-1115"><span class="linenos">1115</span></a>
</span><span id="AbsReLUNode.backward-1116"><a href="#AbsReLUNode.backward-1116"><span class="linenos">1116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsReLUNode.backward-1117"><a href="#AbsReLUNode.backward-1117"><span class="linenos">1117</span></a>
</span><span id="AbsReLUNode.backward-1118"><a href="#AbsReLUNode.backward-1118"><span class="linenos">1118</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the RefinementState. At present the function is just a placeholder for future implementations.</p>

<h2 id="parameters">Parameters</h2>

<p>ref_state: RefinementState
    The RefinementState to update.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AbsLayerNode">AbsLayerNode</a></dt>
                                <dd id="AbsReLUNode.identifier" class="variable"><a href="#AbsLayerNode.identifier">identifier</a></dd>
                <dd id="AbsReLUNode.ref_node" class="variable"><a href="#AbsLayerNode.ref_node">ref_node</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AbsSigmoidNode">
                            <input id="AbsSigmoidNode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsSigmoidNode</span><wbr>(<span class="base"><a href="#AbsLayerNode">AbsLayerNode</a></span>):

                <label class="view-source-button" for="AbsSigmoidNode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSigmoidNode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSigmoidNode-1162"><a href="#AbsSigmoidNode-1162"><span class="linenos">1162</span></a><span class="k">class</span> <span class="nc">AbsSigmoidNode</span><span class="p">(</span><span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="AbsSigmoidNode-1163"><a href="#AbsSigmoidNode-1163"><span class="linenos">1163</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode-1164"><a href="#AbsSigmoidNode-1164"><span class="linenos">1164</span></a><span class="sd">    A class used for our internal representation of a Sigmoid transformer.</span>
</span><span id="AbsSigmoidNode-1165"><a href="#AbsSigmoidNode-1165"><span class="linenos">1165</span></a>
</span><span id="AbsSigmoidNode-1166"><a href="#AbsSigmoidNode-1166"><span class="linenos">1166</span></a><span class="sd">    Attributes</span>
</span><span id="AbsSigmoidNode-1167"><a href="#AbsSigmoidNode-1167"><span class="linenos">1167</span></a><span class="sd">    ----------</span>
</span><span id="AbsSigmoidNode-1168"><a href="#AbsSigmoidNode-1168"><span class="linenos">1168</span></a><span class="sd">    identifier : str</span>
</span><span id="AbsSigmoidNode-1169"><a href="#AbsSigmoidNode-1169"><span class="linenos">1169</span></a><span class="sd">        Identifier of the SingleInputLayerNode.</span>
</span><span id="AbsSigmoidNode-1170"><a href="#AbsSigmoidNode-1170"><span class="linenos">1170</span></a>
</span><span id="AbsSigmoidNode-1171"><a href="#AbsSigmoidNode-1171"><span class="linenos">1171</span></a><span class="sd">    ref_node : SigmoidNode</span>
</span><span id="AbsSigmoidNode-1172"><a href="#AbsSigmoidNode-1172"><span class="linenos">1172</span></a><span class="sd">        SingleInputLayerNode di riferimento per l&#39;abstract transformer.</span>
</span><span id="AbsSigmoidNode-1173"><a href="#AbsSigmoidNode-1173"><span class="linenos">1173</span></a>
</span><span id="AbsSigmoidNode-1174"><a href="#AbsSigmoidNode-1174"><span class="linenos">1174</span></a><span class="sd">    refinement_level : Union[int, List[int]]</span>
</span><span id="AbsSigmoidNode-1175"><a href="#AbsSigmoidNode-1175"><span class="linenos">1175</span></a><span class="sd">        Refinement level for the sigmoid nodes: if it is a single int then that refinement level is applied to all</span>
</span><span id="AbsSigmoidNode-1176"><a href="#AbsSigmoidNode-1176"><span class="linenos">1176</span></a><span class="sd">        the neurons of the layers, otherwise it is a list containing the refinement levels for each layers.</span>
</span><span id="AbsSigmoidNode-1177"><a href="#AbsSigmoidNode-1177"><span class="linenos">1177</span></a>
</span><span id="AbsSigmoidNode-1178"><a href="#AbsSigmoidNode-1178"><span class="linenos">1178</span></a><span class="sd">    Methods</span>
</span><span id="AbsSigmoidNode-1179"><a href="#AbsSigmoidNode-1179"><span class="linenos">1179</span></a><span class="sd">    ----------</span>
</span><span id="AbsSigmoidNode-1180"><a href="#AbsSigmoidNode-1180"><span class="linenos">1180</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="AbsSigmoidNode-1181"><a href="#AbsSigmoidNode-1181"><span class="linenos">1181</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract</span>
</span><span id="AbsSigmoidNode-1182"><a href="#AbsSigmoidNode-1182"><span class="linenos">1182</span></a><span class="sd">        transformer.</span>
</span><span id="AbsSigmoidNode-1183"><a href="#AbsSigmoidNode-1183"><span class="linenos">1183</span></a>
</span><span id="AbsSigmoidNode-1184"><a href="#AbsSigmoidNode-1184"><span class="linenos">1184</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="AbsSigmoidNode-1185"><a href="#AbsSigmoidNode-1185"><span class="linenos">1185</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the abstract</span>
</span><span id="AbsSigmoidNode-1186"><a href="#AbsSigmoidNode-1186"><span class="linenos">1186</span></a><span class="sd">        transformer to control the refinement component of the abstraction. At present the function is just a</span>
</span><span id="AbsSigmoidNode-1187"><a href="#AbsSigmoidNode-1187"><span class="linenos">1187</span></a><span class="sd">        placeholder for future implementations.</span>
</span><span id="AbsSigmoidNode-1188"><a href="#AbsSigmoidNode-1188"><span class="linenos">1188</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode-1189"><a href="#AbsSigmoidNode-1189"><span class="linenos">1189</span></a>
</span><span id="AbsSigmoidNode-1190"><a href="#AbsSigmoidNode-1190"><span class="linenos">1190</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">SigmoidNode</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="AbsSigmoidNode-1191"><a href="#AbsSigmoidNode-1191"><span class="linenos">1191</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="AbsSigmoidNode-1192"><a href="#AbsSigmoidNode-1192"><span class="linenos">1192</span></a>
</span><span id="AbsSigmoidNode-1193"><a href="#AbsSigmoidNode-1193"><span class="linenos">1193</span></a>        <span class="k">if</span> <span class="n">approx_levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1194"><a href="#AbsSigmoidNode-1194"><span class="linenos">1194</span></a>            <span class="n">approx_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="AbsSigmoidNode-1195"><a href="#AbsSigmoidNode-1195"><span class="linenos">1195</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">approx_levels</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AbsSigmoidNode-1196"><a href="#AbsSigmoidNode-1196"><span class="linenos">1196</span></a>            <span class="n">approx_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">approx_levels</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="AbsSigmoidNode-1197"><a href="#AbsSigmoidNode-1197"><span class="linenos">1197</span></a>
</span><span id="AbsSigmoidNode-1198"><a href="#AbsSigmoidNode-1198"><span class="linenos">1198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span> <span class="o">=</span> <span class="n">approx_levels</span>
</span><span id="AbsSigmoidNode-1199"><a href="#AbsSigmoidNode-1199"><span class="linenos">1199</span></a>
</span><span id="AbsSigmoidNode-1200"><a href="#AbsSigmoidNode-1200"><span class="linenos">1200</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1201"><a href="#AbsSigmoidNode-1201"><span class="linenos">1201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode-1202"><a href="#AbsSigmoidNode-1202"><span class="linenos">1202</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsSigmoidNode-1203"><a href="#AbsSigmoidNode-1203"><span class="linenos">1203</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsSigmoidNode-1204"><a href="#AbsSigmoidNode-1204"><span class="linenos">1204</span></a>
</span><span id="AbsSigmoidNode-1205"><a href="#AbsSigmoidNode-1205"><span class="linenos">1205</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSigmoidNode-1206"><a href="#AbsSigmoidNode-1206"><span class="linenos">1206</span></a><span class="sd">        ----------</span>
</span><span id="AbsSigmoidNode-1207"><a href="#AbsSigmoidNode-1207"><span class="linenos">1207</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsSigmoidNode-1208"><a href="#AbsSigmoidNode-1208"><span class="linenos">1208</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsSigmoidNode-1209"><a href="#AbsSigmoidNode-1209"><span class="linenos">1209</span></a>
</span><span id="AbsSigmoidNode-1210"><a href="#AbsSigmoidNode-1210"><span class="linenos">1210</span></a><span class="sd">        Returns</span>
</span><span id="AbsSigmoidNode-1211"><a href="#AbsSigmoidNode-1211"><span class="linenos">1211</span></a><span class="sd">        ----------</span>
</span><span id="AbsSigmoidNode-1212"><a href="#AbsSigmoidNode-1212"><span class="linenos">1212</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsSigmoidNode-1213"><a href="#AbsSigmoidNode-1213"><span class="linenos">1213</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsSigmoidNode-1214"><a href="#AbsSigmoidNode-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode-1215"><a href="#AbsSigmoidNode-1215"><span class="linenos">1215</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="AbsSigmoidNode-1216"><a href="#AbsSigmoidNode-1216"><span class="linenos">1216</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsSigmoidNode-1217"><a href="#AbsSigmoidNode-1217"><span class="linenos">1217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1218"><a href="#AbsSigmoidNode-1218"><span class="linenos">1218</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="AbsSigmoidNode-1219"><a href="#AbsSigmoidNode-1219"><span class="linenos">1219</span></a>
</span><span id="AbsSigmoidNode-1220"><a href="#AbsSigmoidNode-1220"><span class="linenos">1220</span></a>    <span class="k">def</span> <span class="nf">__starset_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">StarSet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StarSet</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1221"><a href="#AbsSigmoidNode-1221"><span class="linenos">1221</span></a>
</span><span id="AbsSigmoidNode-1222"><a href="#AbsSigmoidNode-1222"><span class="linenos">1222</span></a>        <span class="c1"># parallel = True</span>
</span><span id="AbsSigmoidNode-1223"><a href="#AbsSigmoidNode-1223"><span class="linenos">1223</span></a>        <span class="k">if</span> <span class="n">parallel</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1224"><a href="#AbsSigmoidNode-1224"><span class="linenos">1224</span></a>            <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="AbsSigmoidNode-1225"><a href="#AbsSigmoidNode-1225"><span class="linenos">1225</span></a>            <span class="n">my_pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AbsSigmoidNode-1226"><a href="#AbsSigmoidNode-1226"><span class="linenos">1226</span></a>            <span class="n">parallel_results</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span><span class="n">single_sigmoid_forward</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">,</span>
</span><span id="AbsSigmoidNode-1227"><a href="#AbsSigmoidNode-1227"><span class="linenos">1227</span></a>                                                                           <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span><span class="p">)))</span>
</span><span id="AbsSigmoidNode-1228"><a href="#AbsSigmoidNode-1228"><span class="linenos">1228</span></a>            <span class="n">my_pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="AbsSigmoidNode-1229"><a href="#AbsSigmoidNode-1229"><span class="linenos">1229</span></a>            <span class="k">for</span> <span class="n">star_set</span> <span class="ow">in</span> <span class="n">parallel_results</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1230"><a href="#AbsSigmoidNode-1230"><span class="linenos">1230</span></a>                <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">star_set</span><span class="p">)</span>
</span><span id="AbsSigmoidNode-1231"><a href="#AbsSigmoidNode-1231"><span class="linenos">1231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1232"><a href="#AbsSigmoidNode-1232"><span class="linenos">1232</span></a>            <span class="n">abs_output</span> <span class="o">=</span> <span class="n">StarSet</span><span class="p">()</span>
</span><span id="AbsSigmoidNode-1233"><a href="#AbsSigmoidNode-1233"><span class="linenos">1233</span></a>            <span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">abs_input</span><span class="o">.</span><span class="n">stars</span><span class="p">:</span>
</span><span id="AbsSigmoidNode-1234"><a href="#AbsSigmoidNode-1234"><span class="linenos">1234</span></a>                <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span> <span class="o">=</span> <span class="n">abs_output</span><span class="o">.</span><span class="n">stars</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">single_sigmoid_forward</span><span class="p">(</span><span class="n">star</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span><span class="p">))</span>
</span><span id="AbsSigmoidNode-1235"><a href="#AbsSigmoidNode-1235"><span class="linenos">1235</span></a>
</span><span id="AbsSigmoidNode-1236"><a href="#AbsSigmoidNode-1236"><span class="linenos">1236</span></a>        <span class="k">return</span> <span class="n">abs_output</span>
</span><span id="AbsSigmoidNode-1237"><a href="#AbsSigmoidNode-1237"><span class="linenos">1237</span></a>
</span><span id="AbsSigmoidNode-1238"><a href="#AbsSigmoidNode-1238"><span class="linenos">1238</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsSigmoidNode-1239"><a href="#AbsSigmoidNode-1239"><span class="linenos">1239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode-1240"><a href="#AbsSigmoidNode-1240"><span class="linenos">1240</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsSigmoidNode-1241"><a href="#AbsSigmoidNode-1241"><span class="linenos">1241</span></a>
</span><span id="AbsSigmoidNode-1242"><a href="#AbsSigmoidNode-1242"><span class="linenos">1242</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSigmoidNode-1243"><a href="#AbsSigmoidNode-1243"><span class="linenos">1243</span></a><span class="sd">        ----------</span>
</span><span id="AbsSigmoidNode-1244"><a href="#AbsSigmoidNode-1244"><span class="linenos">1244</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsSigmoidNode-1245"><a href="#AbsSigmoidNode-1245"><span class="linenos">1245</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsSigmoidNode-1246"><a href="#AbsSigmoidNode-1246"><span class="linenos">1246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode-1247"><a href="#AbsSigmoidNode-1247"><span class="linenos">1247</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>A class used for our internal representation of a Sigmoid transformer.</p>

<h2 id="attributes">Attributes</h2>

<p>identifier : str
    Identifier of the SingleInputLayerNode.</p>

<p>ref_node : SigmoidNode
    SingleInputLayerNode di riferimento per l'abstract transformer.</p>

<p>refinement_level : Union[int, List[int]]
    Refinement level for the sigmoid nodes: if it is a single int then that refinement level is applied to all
    the neurons of the layers, otherwise it is a list containing the refinement levels for each layers.</p>

<h2 id="methods">Methods</h2>

<p>forward(AbsElement)
    Function which takes an AbsElement and compute the corresponding output AbsElement based on the abstract
    transformer.</p>

<p>backward(RefinementState)
    Function which takes a reference to the refinement state and update both it and the state of the abstract
    transformer to control the refinement component of the abstraction. At present the function is just a
    placeholder for future implementations.</p>
</div>


                            <div id="AbsSigmoidNode.__init__" class="classattr">
                                        <input id="AbsSigmoidNode.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AbsSigmoidNode</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ref_node</span><span class="p">:</span> <span class="n"><a href="../nodes.html#SigmoidNode">pynever.nodes.SigmoidNode</a></span>,</span><span class="param">	<span class="n">approx_levels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="AbsSigmoidNode.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSigmoidNode.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSigmoidNode.__init__-1190"><a href="#AbsSigmoidNode.__init__-1190"><span class="linenos">1190</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">SigmoidNode</span><span class="p">,</span> <span class="n">approx_levels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="AbsSigmoidNode.__init__-1191"><a href="#AbsSigmoidNode.__init__-1191"><span class="linenos">1191</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">ref_node</span><span class="p">)</span>
</span><span id="AbsSigmoidNode.__init__-1192"><a href="#AbsSigmoidNode.__init__-1192"><span class="linenos">1192</span></a>
</span><span id="AbsSigmoidNode.__init__-1193"><a href="#AbsSigmoidNode.__init__-1193"><span class="linenos">1193</span></a>        <span class="k">if</span> <span class="n">approx_levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSigmoidNode.__init__-1194"><a href="#AbsSigmoidNode.__init__-1194"><span class="linenos">1194</span></a>            <span class="n">approx_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="AbsSigmoidNode.__init__-1195"><a href="#AbsSigmoidNode.__init__-1195"><span class="linenos">1195</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">approx_levels</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="AbsSigmoidNode.__init__-1196"><a href="#AbsSigmoidNode.__init__-1196"><span class="linenos">1196</span></a>            <span class="n">approx_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">approx_levels</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ref_node</span><span class="o">.</span><span class="n">in_dim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
</span><span id="AbsSigmoidNode.__init__-1197"><a href="#AbsSigmoidNode.__init__-1197"><span class="linenos">1197</span></a>
</span><span id="AbsSigmoidNode.__init__-1198"><a href="#AbsSigmoidNode.__init__-1198"><span class="linenos">1198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">approx_levels</span> <span class="o">=</span> <span class="n">approx_levels</span>
</span></pre></div>


    

                            </div>
                            <div id="AbsSigmoidNode.approx_levels" class="classattr">
                                <div class="attr variable">
            <span class="name">approx_levels</span>

        
    </div>
    <a class="headerlink" href="#AbsSigmoidNode.approx_levels"></a>
    
    

                            </div>
                            <div id="AbsSigmoidNode.forward" class="classattr">
                                        <input id="AbsSigmoidNode.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">abs_input</span><span class="p">:</span> <span class="n"><a href="#AbsElement">AbsElement</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsElement">AbsElement</a></span>:</span></span>

                <label class="view-source-button" for="AbsSigmoidNode.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSigmoidNode.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSigmoidNode.forward-1200"><a href="#AbsSigmoidNode.forward-1200"><span class="linenos">1200</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsSigmoidNode.forward-1201"><a href="#AbsSigmoidNode.forward-1201"><span class="linenos">1201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode.forward-1202"><a href="#AbsSigmoidNode.forward-1202"><span class="linenos">1202</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsSigmoidNode.forward-1203"><a href="#AbsSigmoidNode.forward-1203"><span class="linenos">1203</span></a><span class="sd">        concrete abstract transformer.</span>
</span><span id="AbsSigmoidNode.forward-1204"><a href="#AbsSigmoidNode.forward-1204"><span class="linenos">1204</span></a>
</span><span id="AbsSigmoidNode.forward-1205"><a href="#AbsSigmoidNode.forward-1205"><span class="linenos">1205</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSigmoidNode.forward-1206"><a href="#AbsSigmoidNode.forward-1206"><span class="linenos">1206</span></a><span class="sd">        ----------</span>
</span><span id="AbsSigmoidNode.forward-1207"><a href="#AbsSigmoidNode.forward-1207"><span class="linenos">1207</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsSigmoidNode.forward-1208"><a href="#AbsSigmoidNode.forward-1208"><span class="linenos">1208</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsSigmoidNode.forward-1209"><a href="#AbsSigmoidNode.forward-1209"><span class="linenos">1209</span></a>
</span><span id="AbsSigmoidNode.forward-1210"><a href="#AbsSigmoidNode.forward-1210"><span class="linenos">1210</span></a><span class="sd">        Returns</span>
</span><span id="AbsSigmoidNode.forward-1211"><a href="#AbsSigmoidNode.forward-1211"><span class="linenos">1211</span></a><span class="sd">        ----------</span>
</span><span id="AbsSigmoidNode.forward-1212"><a href="#AbsSigmoidNode.forward-1212"><span class="linenos">1212</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsSigmoidNode.forward-1213"><a href="#AbsSigmoidNode.forward-1213"><span class="linenos">1213</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsSigmoidNode.forward-1214"><a href="#AbsSigmoidNode.forward-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode.forward-1215"><a href="#AbsSigmoidNode.forward-1215"><span class="linenos">1215</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_input</span><span class="p">,</span> <span class="n">StarSet</span><span class="p">):</span>
</span><span id="AbsSigmoidNode.forward-1216"><a href="#AbsSigmoidNode.forward-1216"><span class="linenos">1216</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__starset_forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsSigmoidNode.forward-1217"><a href="#AbsSigmoidNode.forward-1217"><span class="linenos">1217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSigmoidNode.forward-1218"><a href="#AbsSigmoidNode.forward-1218"><span class="linenos">1218</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Compute the output AbsElement based on the input AbsElement and the characteristics of the
concrete abstract transformer.</p>

<h2 id="parameters">Parameters</h2>

<p>abs_input : AbsElement
    The input abstract element.</p>

<h2 id="returns">Returns</h2>

<p>AbsElement
    The AbsElement resulting from the computation corresponding to the abstract transformer.</p>
</div>


                            </div>
                            <div id="AbsSigmoidNode.backward" class="classattr">
                                        <input id="AbsSigmoidNode.backward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">backward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ref_state</span><span class="p">:</span> <span class="n"><a href="#RefinementState">RefinementState</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsSigmoidNode.backward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSigmoidNode.backward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSigmoidNode.backward-1238"><a href="#AbsSigmoidNode.backward-1238"><span class="linenos">1238</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsSigmoidNode.backward-1239"><a href="#AbsSigmoidNode.backward-1239"><span class="linenos">1239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode.backward-1240"><a href="#AbsSigmoidNode.backward-1240"><span class="linenos">1240</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsSigmoidNode.backward-1241"><a href="#AbsSigmoidNode.backward-1241"><span class="linenos">1241</span></a>
</span><span id="AbsSigmoidNode.backward-1242"><a href="#AbsSigmoidNode.backward-1242"><span class="linenos">1242</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSigmoidNode.backward-1243"><a href="#AbsSigmoidNode.backward-1243"><span class="linenos">1243</span></a><span class="sd">        ----------</span>
</span><span id="AbsSigmoidNode.backward-1244"><a href="#AbsSigmoidNode.backward-1244"><span class="linenos">1244</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsSigmoidNode.backward-1245"><a href="#AbsSigmoidNode.backward-1245"><span class="linenos">1245</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsSigmoidNode.backward-1246"><a href="#AbsSigmoidNode.backward-1246"><span class="linenos">1246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSigmoidNode.backward-1247"><a href="#AbsSigmoidNode.backward-1247"><span class="linenos">1247</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the RefinementState. At present the function is just a placeholder for future implementations.</p>

<h2 id="parameters">Parameters</h2>

<p>ref_state: RefinementState
    The RefinementState to update.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AbsLayerNode">AbsLayerNode</a></dt>
                                <dd id="AbsSigmoidNode.identifier" class="variable"><a href="#AbsLayerNode.identifier">identifier</a></dd>
                <dd id="AbsSigmoidNode.ref_node" class="variable"><a href="#AbsLayerNode.ref_node">ref_node</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AbsNeuralNetwork">
                            <input id="AbsNeuralNetwork-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsNeuralNetwork</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="AbsNeuralNetwork-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsNeuralNetwork"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsNeuralNetwork-1250"><a href="#AbsNeuralNetwork-1250"><span class="linenos">1250</span></a><span class="k">class</span> <span class="nc">AbsNeuralNetwork</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="AbsNeuralNetwork-1251"><a href="#AbsNeuralNetwork-1251"><span class="linenos">1251</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork-1252"><a href="#AbsNeuralNetwork-1252"><span class="linenos">1252</span></a><span class="sd">    An abstract class used for our internal representation of a generic NeuralNetwork for Abstract Interpretation.</span>
</span><span id="AbsNeuralNetwork-1253"><a href="#AbsNeuralNetwork-1253"><span class="linenos">1253</span></a><span class="sd">    It consists of a graph of AbsLayerNodes. The properties of the computational graph are specialized in the</span>
</span><span id="AbsNeuralNetwork-1254"><a href="#AbsNeuralNetwork-1254"><span class="linenos">1254</span></a><span class="sd">    concrete classes. The method forward and backward calls the corresponding methods in the AbsLayerNodes following the</span>
</span><span id="AbsNeuralNetwork-1255"><a href="#AbsNeuralNetwork-1255"><span class="linenos">1255</span></a><span class="sd">    correct order to compute the output AbsElement.</span>
</span><span id="AbsNeuralNetwork-1256"><a href="#AbsNeuralNetwork-1256"><span class="linenos">1256</span></a>
</span><span id="AbsNeuralNetwork-1257"><a href="#AbsNeuralNetwork-1257"><span class="linenos">1257</span></a><span class="sd">    Attributes</span>
</span><span id="AbsNeuralNetwork-1258"><a href="#AbsNeuralNetwork-1258"><span class="linenos">1258</span></a><span class="sd">    ----------</span>
</span><span id="AbsNeuralNetwork-1259"><a href="#AbsNeuralNetwork-1259"><span class="linenos">1259</span></a><span class="sd">    nodes : dict &lt;str, SingleInputLayerNode&gt;</span>
</span><span id="AbsNeuralNetwork-1260"><a href="#AbsNeuralNetwork-1260"><span class="linenos">1260</span></a><span class="sd">        Dictionary containing str keys and AbsLayerNodes values. It contains the nodes of the graph,</span>
</span><span id="AbsNeuralNetwork-1261"><a href="#AbsNeuralNetwork-1261"><span class="linenos">1261</span></a><span class="sd">        the identifier of the node of interest is used as a key in the nodes dictionary.</span>
</span><span id="AbsNeuralNetwork-1262"><a href="#AbsNeuralNetwork-1262"><span class="linenos">1262</span></a>
</span><span id="AbsNeuralNetwork-1263"><a href="#AbsNeuralNetwork-1263"><span class="linenos">1263</span></a><span class="sd">    edges : dict &lt;str, list &lt;str&gt;&gt;</span>
</span><span id="AbsNeuralNetwork-1264"><a href="#AbsNeuralNetwork-1264"><span class="linenos">1264</span></a><span class="sd">        Dictionary of identifiers of AbsLayerNodes, it contains for each nodes identified by the keys, the list of nodes</span>
</span><span id="AbsNeuralNetwork-1265"><a href="#AbsNeuralNetwork-1265"><span class="linenos">1265</span></a><span class="sd">        connected to it.</span>
</span><span id="AbsNeuralNetwork-1266"><a href="#AbsNeuralNetwork-1266"><span class="linenos">1266</span></a>
</span><span id="AbsNeuralNetwork-1267"><a href="#AbsNeuralNetwork-1267"><span class="linenos">1267</span></a><span class="sd">    Methods</span>
</span><span id="AbsNeuralNetwork-1268"><a href="#AbsNeuralNetwork-1268"><span class="linenos">1268</span></a><span class="sd">    ----------</span>
</span><span id="AbsNeuralNetwork-1269"><a href="#AbsNeuralNetwork-1269"><span class="linenos">1269</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="AbsNeuralNetwork-1270"><a href="#AbsNeuralNetwork-1270"><span class="linenos">1270</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the AbsLayerNode</span>
</span><span id="AbsNeuralNetwork-1271"><a href="#AbsNeuralNetwork-1271"><span class="linenos">1271</span></a><span class="sd">        of the network.</span>
</span><span id="AbsNeuralNetwork-1272"><a href="#AbsNeuralNetwork-1272"><span class="linenos">1272</span></a>
</span><span id="AbsNeuralNetwork-1273"><a href="#AbsNeuralNetwork-1273"><span class="linenos">1273</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="AbsNeuralNetwork-1274"><a href="#AbsNeuralNetwork-1274"><span class="linenos">1274</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the AbsLayerNodes</span>
</span><span id="AbsNeuralNetwork-1275"><a href="#AbsNeuralNetwork-1275"><span class="linenos">1275</span></a><span class="sd">        to control the refinement component of the abstraction. At present the function is just a placeholder</span>
</span><span id="AbsNeuralNetwork-1276"><a href="#AbsNeuralNetwork-1276"><span class="linenos">1276</span></a><span class="sd">        for future implementations.</span>
</span><span id="AbsNeuralNetwork-1277"><a href="#AbsNeuralNetwork-1277"><span class="linenos">1277</span></a>
</span><span id="AbsNeuralNetwork-1278"><a href="#AbsNeuralNetwork-1278"><span class="linenos">1278</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork-1279"><a href="#AbsNeuralNetwork-1279"><span class="linenos">1279</span></a>
</span><span id="AbsNeuralNetwork-1280"><a href="#AbsNeuralNetwork-1280"><span class="linenos">1280</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AbsNeuralNetwork-1281"><a href="#AbsNeuralNetwork-1281"><span class="linenos">1281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AbsNeuralNetwork-1282"><a href="#AbsNeuralNetwork-1282"><span class="linenos">1282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AbsNeuralNetwork-1283"><a href="#AbsNeuralNetwork-1283"><span class="linenos">1283</span></a>
</span><span id="AbsNeuralNetwork-1284"><a href="#AbsNeuralNetwork-1284"><span class="linenos">1284</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsNeuralNetwork-1285"><a href="#AbsNeuralNetwork-1285"><span class="linenos">1285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork-1286"><a href="#AbsNeuralNetwork-1286"><span class="linenos">1286</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsNeuralNetwork-1287"><a href="#AbsNeuralNetwork-1287"><span class="linenos">1287</span></a><span class="sd">        concrete abstract transformers.</span>
</span><span id="AbsNeuralNetwork-1288"><a href="#AbsNeuralNetwork-1288"><span class="linenos">1288</span></a>
</span><span id="AbsNeuralNetwork-1289"><a href="#AbsNeuralNetwork-1289"><span class="linenos">1289</span></a><span class="sd">        Parameters</span>
</span><span id="AbsNeuralNetwork-1290"><a href="#AbsNeuralNetwork-1290"><span class="linenos">1290</span></a><span class="sd">        ----------</span>
</span><span id="AbsNeuralNetwork-1291"><a href="#AbsNeuralNetwork-1291"><span class="linenos">1291</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsNeuralNetwork-1292"><a href="#AbsNeuralNetwork-1292"><span class="linenos">1292</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsNeuralNetwork-1293"><a href="#AbsNeuralNetwork-1293"><span class="linenos">1293</span></a>
</span><span id="AbsNeuralNetwork-1294"><a href="#AbsNeuralNetwork-1294"><span class="linenos">1294</span></a><span class="sd">        Returns</span>
</span><span id="AbsNeuralNetwork-1295"><a href="#AbsNeuralNetwork-1295"><span class="linenos">1295</span></a><span class="sd">        ----------</span>
</span><span id="AbsNeuralNetwork-1296"><a href="#AbsNeuralNetwork-1296"><span class="linenos">1296</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsNeuralNetwork-1297"><a href="#AbsNeuralNetwork-1297"><span class="linenos">1297</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsNeuralNetwork-1298"><a href="#AbsNeuralNetwork-1298"><span class="linenos">1298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork-1299"><a href="#AbsNeuralNetwork-1299"><span class="linenos">1299</span></a>        <span class="k">pass</span>
</span><span id="AbsNeuralNetwork-1300"><a href="#AbsNeuralNetwork-1300"><span class="linenos">1300</span></a>
</span><span id="AbsNeuralNetwork-1301"><a href="#AbsNeuralNetwork-1301"><span class="linenos">1301</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AbsNeuralNetwork-1302"><a href="#AbsNeuralNetwork-1302"><span class="linenos">1302</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsNeuralNetwork-1303"><a href="#AbsNeuralNetwork-1303"><span class="linenos">1303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork-1304"><a href="#AbsNeuralNetwork-1304"><span class="linenos">1304</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsNeuralNetwork-1305"><a href="#AbsNeuralNetwork-1305"><span class="linenos">1305</span></a>
</span><span id="AbsNeuralNetwork-1306"><a href="#AbsNeuralNetwork-1306"><span class="linenos">1306</span></a><span class="sd">        Parameters</span>
</span><span id="AbsNeuralNetwork-1307"><a href="#AbsNeuralNetwork-1307"><span class="linenos">1307</span></a><span class="sd">        ----------</span>
</span><span id="AbsNeuralNetwork-1308"><a href="#AbsNeuralNetwork-1308"><span class="linenos">1308</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsNeuralNetwork-1309"><a href="#AbsNeuralNetwork-1309"><span class="linenos">1309</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsNeuralNetwork-1310"><a href="#AbsNeuralNetwork-1310"><span class="linenos">1310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork-1311"><a href="#AbsNeuralNetwork-1311"><span class="linenos">1311</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>An abstract class used for our internal representation of a generic NeuralNetwork for Abstract Interpretation.
It consists of a graph of AbsLayerNodes. The properties of the computational graph are specialized in the
concrete classes. The method forward and backward calls the corresponding methods in the AbsLayerNodes following the
correct order to compute the output AbsElement.</p>

<h2 id="attributes">Attributes</h2>

<p>nodes : dict <str, SingleInputLayerNode>
    Dictionary containing str keys and AbsLayerNodes values. It contains the nodes of the graph,
    the identifier of the node of interest is used as a key in the nodes dictionary.</p>

<p>edges : dict <str, list <str>&gt;
    Dictionary of identifiers of AbsLayerNodes, it contains for each nodes identified by the keys, the list of nodes
    connected to it.</p>

<h2 id="methods">Methods</h2>

<p>forward(AbsElement)
    Function which takes an AbsElement and compute the corresponding output AbsElement based on the AbsLayerNode
    of the network.</p>

<p>backward(RefinementState)
    Function which takes a reference to the refinement state and update both it and the state of the AbsLayerNodes
    to control the refinement component of the abstraction. At present the function is just a placeholder
    for future implementations.</p>
</div>


                            <div id="AbsNeuralNetwork.nodes" class="classattr">
                                <div class="attr variable">
            <span class="name">nodes</span>

        
    </div>
    <a class="headerlink" href="#AbsNeuralNetwork.nodes"></a>
    
    

                            </div>
                            <div id="AbsNeuralNetwork.edges" class="classattr">
                                <div class="attr variable">
            <span class="name">edges</span>

        
    </div>
    <a class="headerlink" href="#AbsNeuralNetwork.edges"></a>
    
    

                            </div>
                            <div id="AbsNeuralNetwork.forward" class="classattr">
                                        <input id="AbsNeuralNetwork.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">abs_input</span><span class="p">:</span> <span class="n"><a href="#AbsElement">AbsElement</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsElement">AbsElement</a></span>:</span></span>

                <label class="view-source-button" for="AbsNeuralNetwork.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsNeuralNetwork.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsNeuralNetwork.forward-1284"><a href="#AbsNeuralNetwork.forward-1284"><span class="linenos">1284</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsNeuralNetwork.forward-1285"><a href="#AbsNeuralNetwork.forward-1285"><span class="linenos">1285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork.forward-1286"><a href="#AbsNeuralNetwork.forward-1286"><span class="linenos">1286</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsNeuralNetwork.forward-1287"><a href="#AbsNeuralNetwork.forward-1287"><span class="linenos">1287</span></a><span class="sd">        concrete abstract transformers.</span>
</span><span id="AbsNeuralNetwork.forward-1288"><a href="#AbsNeuralNetwork.forward-1288"><span class="linenos">1288</span></a>
</span><span id="AbsNeuralNetwork.forward-1289"><a href="#AbsNeuralNetwork.forward-1289"><span class="linenos">1289</span></a><span class="sd">        Parameters</span>
</span><span id="AbsNeuralNetwork.forward-1290"><a href="#AbsNeuralNetwork.forward-1290"><span class="linenos">1290</span></a><span class="sd">        ----------</span>
</span><span id="AbsNeuralNetwork.forward-1291"><a href="#AbsNeuralNetwork.forward-1291"><span class="linenos">1291</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsNeuralNetwork.forward-1292"><a href="#AbsNeuralNetwork.forward-1292"><span class="linenos">1292</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsNeuralNetwork.forward-1293"><a href="#AbsNeuralNetwork.forward-1293"><span class="linenos">1293</span></a>
</span><span id="AbsNeuralNetwork.forward-1294"><a href="#AbsNeuralNetwork.forward-1294"><span class="linenos">1294</span></a><span class="sd">        Returns</span>
</span><span id="AbsNeuralNetwork.forward-1295"><a href="#AbsNeuralNetwork.forward-1295"><span class="linenos">1295</span></a><span class="sd">        ----------</span>
</span><span id="AbsNeuralNetwork.forward-1296"><a href="#AbsNeuralNetwork.forward-1296"><span class="linenos">1296</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsNeuralNetwork.forward-1297"><a href="#AbsNeuralNetwork.forward-1297"><span class="linenos">1297</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsNeuralNetwork.forward-1298"><a href="#AbsNeuralNetwork.forward-1298"><span class="linenos">1298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork.forward-1299"><a href="#AbsNeuralNetwork.forward-1299"><span class="linenos">1299</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Compute the output AbsElement based on the input AbsElement and the characteristics of the
concrete abstract transformers.</p>

<h2 id="parameters">Parameters</h2>

<p>abs_input : AbsElement
    The input abstract element.</p>

<h2 id="returns">Returns</h2>

<p>AbsElement
    The AbsElement resulting from the computation corresponding to the abstract transformer.</p>
</div>


                            </div>
                            <div id="AbsNeuralNetwork.backward" class="classattr">
                                        <input id="AbsNeuralNetwork.backward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abc.abstractmethod</div>

        <span class="def">def</span>
        <span class="name">backward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ref_state</span><span class="p">:</span> <span class="n"><a href="#RefinementState">RefinementState</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsNeuralNetwork.backward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsNeuralNetwork.backward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsNeuralNetwork.backward-1301"><a href="#AbsNeuralNetwork.backward-1301"><span class="linenos">1301</span></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="AbsNeuralNetwork.backward-1302"><a href="#AbsNeuralNetwork.backward-1302"><span class="linenos">1302</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsNeuralNetwork.backward-1303"><a href="#AbsNeuralNetwork.backward-1303"><span class="linenos">1303</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork.backward-1304"><a href="#AbsNeuralNetwork.backward-1304"><span class="linenos">1304</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsNeuralNetwork.backward-1305"><a href="#AbsNeuralNetwork.backward-1305"><span class="linenos">1305</span></a>
</span><span id="AbsNeuralNetwork.backward-1306"><a href="#AbsNeuralNetwork.backward-1306"><span class="linenos">1306</span></a><span class="sd">        Parameters</span>
</span><span id="AbsNeuralNetwork.backward-1307"><a href="#AbsNeuralNetwork.backward-1307"><span class="linenos">1307</span></a><span class="sd">        ----------</span>
</span><span id="AbsNeuralNetwork.backward-1308"><a href="#AbsNeuralNetwork.backward-1308"><span class="linenos">1308</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsNeuralNetwork.backward-1309"><a href="#AbsNeuralNetwork.backward-1309"><span class="linenos">1309</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsNeuralNetwork.backward-1310"><a href="#AbsNeuralNetwork.backward-1310"><span class="linenos">1310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsNeuralNetwork.backward-1311"><a href="#AbsNeuralNetwork.backward-1311"><span class="linenos">1311</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the RefinementState. At present the function is just a placeholder for future implementations.</p>

<h2 id="parameters">Parameters</h2>

<p>ref_state: RefinementState
    The RefinementState to update.</p>
</div>


                            </div>
                </section>
                <section id="AbsSeqNetwork">
                            <input id="AbsSeqNetwork-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsSeqNetwork</span><wbr>(<span class="base"><a href="#AbsNeuralNetwork">AbsNeuralNetwork</a></span>):

                <label class="view-source-button" for="AbsSeqNetwork-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork-1314"><a href="#AbsSeqNetwork-1314"><span class="linenos">1314</span></a><span class="k">class</span> <span class="nc">AbsSeqNetwork</span><span class="p">(</span><span class="n">AbsNeuralNetwork</span><span class="p">):</span>
</span><span id="AbsSeqNetwork-1315"><a href="#AbsSeqNetwork-1315"><span class="linenos">1315</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1316"><a href="#AbsSeqNetwork-1316"><span class="linenos">1316</span></a><span class="sd">    Concrete children of AbsNeuralNetwork representing a sequential AbsNeuralNetwork.</span>
</span><span id="AbsSeqNetwork-1317"><a href="#AbsSeqNetwork-1317"><span class="linenos">1317</span></a><span class="sd">    It consists of a graph of LayerNodes. The computational graph of a SequentialNetwork must</span>
</span><span id="AbsSeqNetwork-1318"><a href="#AbsSeqNetwork-1318"><span class="linenos">1318</span></a><span class="sd">    correspond to a standard list. The method forward and backward calls the corresponding methods</span>
</span><span id="AbsSeqNetwork-1319"><a href="#AbsSeqNetwork-1319"><span class="linenos">1319</span></a><span class="sd">    in the AbsLayerNodes following the correct order to compute the output AbsElement.</span>
</span><span id="AbsSeqNetwork-1320"><a href="#AbsSeqNetwork-1320"><span class="linenos">1320</span></a>
</span><span id="AbsSeqNetwork-1321"><a href="#AbsSeqNetwork-1321"><span class="linenos">1321</span></a><span class="sd">    Attributes</span>
</span><span id="AbsSeqNetwork-1322"><a href="#AbsSeqNetwork-1322"><span class="linenos">1322</span></a><span class="sd">    ----------</span>
</span><span id="AbsSeqNetwork-1323"><a href="#AbsSeqNetwork-1323"><span class="linenos">1323</span></a><span class="sd">    identifier : str</span>
</span><span id="AbsSeqNetwork-1324"><a href="#AbsSeqNetwork-1324"><span class="linenos">1324</span></a><span class="sd">        Identifier of the Sequential AbsNeuralNetwork.</span>
</span><span id="AbsSeqNetwork-1325"><a href="#AbsSeqNetwork-1325"><span class="linenos">1325</span></a>
</span><span id="AbsSeqNetwork-1326"><a href="#AbsSeqNetwork-1326"><span class="linenos">1326</span></a><span class="sd">    Methods</span>
</span><span id="AbsSeqNetwork-1327"><a href="#AbsSeqNetwork-1327"><span class="linenos">1327</span></a><span class="sd">    -------</span>
</span><span id="AbsSeqNetwork-1328"><a href="#AbsSeqNetwork-1328"><span class="linenos">1328</span></a><span class="sd">    add_node(SingleInputLayerNode)</span>
</span><span id="AbsSeqNetwork-1329"><a href="#AbsSeqNetwork-1329"><span class="linenos">1329</span></a><span class="sd">        Procedure to add a new AbsLayerNode to the sequential AbsNeuralNetwork.</span>
</span><span id="AbsSeqNetwork-1330"><a href="#AbsSeqNetwork-1330"><span class="linenos">1330</span></a>
</span><span id="AbsSeqNetwork-1331"><a href="#AbsSeqNetwork-1331"><span class="linenos">1331</span></a><span class="sd">    get_first_node()</span>
</span><span id="AbsSeqNetwork-1332"><a href="#AbsSeqNetwork-1332"><span class="linenos">1332</span></a><span class="sd">        Procedure to extract the first AbsLayerNode of the sequential AbsNeuralNetwork.</span>
</span><span id="AbsSeqNetwork-1333"><a href="#AbsSeqNetwork-1333"><span class="linenos">1333</span></a>
</span><span id="AbsSeqNetwork-1334"><a href="#AbsSeqNetwork-1334"><span class="linenos">1334</span></a><span class="sd">    get_next_node(SingleInputLayerNode)</span>
</span><span id="AbsSeqNetwork-1335"><a href="#AbsSeqNetwork-1335"><span class="linenos">1335</span></a><span class="sd">        Procedure to get the next AbsLayerNode of the AbsNeuralNetwork given an input AbsLayerNode</span>
</span><span id="AbsSeqNetwork-1336"><a href="#AbsSeqNetwork-1336"><span class="linenos">1336</span></a>
</span><span id="AbsSeqNetwork-1337"><a href="#AbsSeqNetwork-1337"><span class="linenos">1337</span></a><span class="sd">    get_last_node()</span>
</span><span id="AbsSeqNetwork-1338"><a href="#AbsSeqNetwork-1338"><span class="linenos">1338</span></a><span class="sd">        Procedure to extract the last AbsLayerNode of the sequential AbsNeuralNetwork.</span>
</span><span id="AbsSeqNetwork-1339"><a href="#AbsSeqNetwork-1339"><span class="linenos">1339</span></a>
</span><span id="AbsSeqNetwork-1340"><a href="#AbsSeqNetwork-1340"><span class="linenos">1340</span></a><span class="sd">    forward(AbsElement)</span>
</span><span id="AbsSeqNetwork-1341"><a href="#AbsSeqNetwork-1341"><span class="linenos">1341</span></a><span class="sd">        Function which takes an AbsElement and compute the corresponding output AbsElement based on the AbsLayerNode</span>
</span><span id="AbsSeqNetwork-1342"><a href="#AbsSeqNetwork-1342"><span class="linenos">1342</span></a><span class="sd">        of the network.</span>
</span><span id="AbsSeqNetwork-1343"><a href="#AbsSeqNetwork-1343"><span class="linenos">1343</span></a>
</span><span id="AbsSeqNetwork-1344"><a href="#AbsSeqNetwork-1344"><span class="linenos">1344</span></a><span class="sd">    backward(RefinementState)</span>
</span><span id="AbsSeqNetwork-1345"><a href="#AbsSeqNetwork-1345"><span class="linenos">1345</span></a><span class="sd">        Function which takes a reference to the refinement state and update both it and the state of the AbsLayerNodes</span>
</span><span id="AbsSeqNetwork-1346"><a href="#AbsSeqNetwork-1346"><span class="linenos">1346</span></a><span class="sd">        to control the refinement component of the abstraction. At present the function is just a placeholder for</span>
</span><span id="AbsSeqNetwork-1347"><a href="#AbsSeqNetwork-1347"><span class="linenos">1347</span></a><span class="sd">        future implementations.</span>
</span><span id="AbsSeqNetwork-1348"><a href="#AbsSeqNetwork-1348"><span class="linenos">1348</span></a>
</span><span id="AbsSeqNetwork-1349"><a href="#AbsSeqNetwork-1349"><span class="linenos">1349</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1350"><a href="#AbsSeqNetwork-1350"><span class="linenos">1350</span></a>
</span><span id="AbsSeqNetwork-1351"><a href="#AbsSeqNetwork-1351"><span class="linenos">1351</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="AbsSeqNetwork-1352"><a href="#AbsSeqNetwork-1352"><span class="linenos">1352</span></a>
</span><span id="AbsSeqNetwork-1353"><a href="#AbsSeqNetwork-1353"><span class="linenos">1353</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="AbsSeqNetwork-1354"><a href="#AbsSeqNetwork-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span><span id="AbsSeqNetwork-1355"><a href="#AbsSeqNetwork-1355"><span class="linenos">1355</span></a>
</span><span id="AbsSeqNetwork-1356"><a href="#AbsSeqNetwork-1356"><span class="linenos">1356</span></a>    <span class="k">def</span> <span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="AbsSeqNetwork-1357"><a href="#AbsSeqNetwork-1357"><span class="linenos">1357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1358"><a href="#AbsSeqNetwork-1358"><span class="linenos">1358</span></a><span class="sd">        Procedure to add a new AbsLayerNode. In sequential network the new node must be connected directly to the</span>
</span><span id="AbsSeqNetwork-1359"><a href="#AbsSeqNetwork-1359"><span class="linenos">1359</span></a><span class="sd">        previous node forming a list.</span>
</span><span id="AbsSeqNetwork-1360"><a href="#AbsSeqNetwork-1360"><span class="linenos">1360</span></a>
</span><span id="AbsSeqNetwork-1361"><a href="#AbsSeqNetwork-1361"><span class="linenos">1361</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSeqNetwork-1362"><a href="#AbsSeqNetwork-1362"><span class="linenos">1362</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork-1363"><a href="#AbsSeqNetwork-1363"><span class="linenos">1363</span></a><span class="sd">        node : AbsLayerNode</span>
</span><span id="AbsSeqNetwork-1364"><a href="#AbsSeqNetwork-1364"><span class="linenos">1364</span></a><span class="sd">            New node to add to the Sequential network.</span>
</span><span id="AbsSeqNetwork-1365"><a href="#AbsSeqNetwork-1365"><span class="linenos">1365</span></a>
</span><span id="AbsSeqNetwork-1366"><a href="#AbsSeqNetwork-1366"><span class="linenos">1366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1367"><a href="#AbsSeqNetwork-1367"><span class="linenos">1367</span></a>
</span><span id="AbsSeqNetwork-1368"><a href="#AbsSeqNetwork-1368"><span class="linenos">1368</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1369"><a href="#AbsSeqNetwork-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="AbsSeqNetwork-1370"><a href="#AbsSeqNetwork-1370"><span class="linenos">1370</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AbsSeqNetwork-1371"><a href="#AbsSeqNetwork-1371"><span class="linenos">1371</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1372"><a href="#AbsSeqNetwork-1372"><span class="linenos">1372</span></a>            <span class="n">previous_node_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_node</span><span class="p">()</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="AbsSeqNetwork-1373"><a href="#AbsSeqNetwork-1373"><span class="linenos">1373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="AbsSeqNetwork-1374"><a href="#AbsSeqNetwork-1374"><span class="linenos">1374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">previous_node_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>
</span><span id="AbsSeqNetwork-1375"><a href="#AbsSeqNetwork-1375"><span class="linenos">1375</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AbsSeqNetwork-1376"><a href="#AbsSeqNetwork-1376"><span class="linenos">1376</span></a>
</span><span id="AbsSeqNetwork-1377"><a href="#AbsSeqNetwork-1377"><span class="linenos">1377</span></a>    <span class="k">def</span> <span class="nf">get_first_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1378"><a href="#AbsSeqNetwork-1378"><span class="linenos">1378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1379"><a href="#AbsSeqNetwork-1379"><span class="linenos">1379</span></a><span class="sd">        Procedure to get the first AbsLayerNode of the network.</span>
</span><span id="AbsSeqNetwork-1380"><a href="#AbsSeqNetwork-1380"><span class="linenos">1380</span></a>
</span><span id="AbsSeqNetwork-1381"><a href="#AbsSeqNetwork-1381"><span class="linenos">1381</span></a><span class="sd">        Return</span>
</span><span id="AbsSeqNetwork-1382"><a href="#AbsSeqNetwork-1382"><span class="linenos">1382</span></a><span class="sd">        ---------</span>
</span><span id="AbsSeqNetwork-1383"><a href="#AbsSeqNetwork-1383"><span class="linenos">1383</span></a><span class="sd">        AbsLayerNode</span>
</span><span id="AbsSeqNetwork-1384"><a href="#AbsSeqNetwork-1384"><span class="linenos">1384</span></a><span class="sd">            The first node of the network.</span>
</span><span id="AbsSeqNetwork-1385"><a href="#AbsSeqNetwork-1385"><span class="linenos">1385</span></a>
</span><span id="AbsSeqNetwork-1386"><a href="#AbsSeqNetwork-1386"><span class="linenos">1386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1387"><a href="#AbsSeqNetwork-1387"><span class="linenos">1387</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="AbsSeqNetwork-1388"><a href="#AbsSeqNetwork-1388"><span class="linenos">1388</span></a>
</span><span id="AbsSeqNetwork-1389"><a href="#AbsSeqNetwork-1389"><span class="linenos">1389</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="AbsSeqNetwork-1390"><a href="#AbsSeqNetwork-1390"><span class="linenos">1390</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="AbsSeqNetwork-1391"><a href="#AbsSeqNetwork-1391"><span class="linenos">1391</span></a>            <span class="k">for</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="AbsSeqNetwork-1392"><a href="#AbsSeqNetwork-1392"><span class="linenos">1392</span></a>                <span class="k">if</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="AbsSeqNetwork-1393"><a href="#AbsSeqNetwork-1393"><span class="linenos">1393</span></a>                    <span class="n">keys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sub_key</span><span class="p">)</span>
</span><span id="AbsSeqNetwork-1394"><a href="#AbsSeqNetwork-1394"><span class="linenos">1394</span></a>
</span><span id="AbsSeqNetwork-1395"><a href="#AbsSeqNetwork-1395"><span class="linenos">1395</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="AbsSeqNetwork-1396"><a href="#AbsSeqNetwork-1396"><span class="linenos">1396</span></a>
</span><span id="AbsSeqNetwork-1397"><a href="#AbsSeqNetwork-1397"><span class="linenos">1397</span></a>    <span class="k">def</span> <span class="nf">get_next_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AbsLayerNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1398"><a href="#AbsSeqNetwork-1398"><span class="linenos">1398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1399"><a href="#AbsSeqNetwork-1399"><span class="linenos">1399</span></a><span class="sd">        Procedure to get the next AbsLayerNode of the network given an input AbsLayerNode.</span>
</span><span id="AbsSeqNetwork-1400"><a href="#AbsSeqNetwork-1400"><span class="linenos">1400</span></a>
</span><span id="AbsSeqNetwork-1401"><a href="#AbsSeqNetwork-1401"><span class="linenos">1401</span></a><span class="sd">        Return</span>
</span><span id="AbsSeqNetwork-1402"><a href="#AbsSeqNetwork-1402"><span class="linenos">1402</span></a><span class="sd">        ---------</span>
</span><span id="AbsSeqNetwork-1403"><a href="#AbsSeqNetwork-1403"><span class="linenos">1403</span></a><span class="sd">        SingleInputLayerNode</span>
</span><span id="AbsSeqNetwork-1404"><a href="#AbsSeqNetwork-1404"><span class="linenos">1404</span></a><span class="sd">            The next node of the network.</span>
</span><span id="AbsSeqNetwork-1405"><a href="#AbsSeqNetwork-1405"><span class="linenos">1405</span></a>
</span><span id="AbsSeqNetwork-1406"><a href="#AbsSeqNetwork-1406"><span class="linenos">1406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1407"><a href="#AbsSeqNetwork-1407"><span class="linenos">1407</span></a>
</span><span id="AbsSeqNetwork-1408"><a href="#AbsSeqNetwork-1408"><span class="linenos">1408</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="AbsSeqNetwork-1409"><a href="#AbsSeqNetwork-1409"><span class="linenos">1409</span></a>
</span><span id="AbsSeqNetwork-1410"><a href="#AbsSeqNetwork-1410"><span class="linenos">1410</span></a>        <span class="n">next_node</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AbsSeqNetwork-1411"><a href="#AbsSeqNetwork-1411"><span class="linenos">1411</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1412"><a href="#AbsSeqNetwork-1412"><span class="linenos">1412</span></a>            <span class="n">current_key</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="AbsSeqNetwork-1413"><a href="#AbsSeqNetwork-1413"><span class="linenos">1413</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">current_key</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1414"><a href="#AbsSeqNetwork-1414"><span class="linenos">1414</span></a>                <span class="n">next_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">current_key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AbsSeqNetwork-1415"><a href="#AbsSeqNetwork-1415"><span class="linenos">1415</span></a>                <span class="n">next_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">next_key</span><span class="p">]</span>
</span><span id="AbsSeqNetwork-1416"><a href="#AbsSeqNetwork-1416"><span class="linenos">1416</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1417"><a href="#AbsSeqNetwork-1417"><span class="linenos">1417</span></a>            <span class="n">next_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="AbsSeqNetwork-1418"><a href="#AbsSeqNetwork-1418"><span class="linenos">1418</span></a>
</span><span id="AbsSeqNetwork-1419"><a href="#AbsSeqNetwork-1419"><span class="linenos">1419</span></a>        <span class="k">return</span> <span class="n">next_node</span>
</span><span id="AbsSeqNetwork-1420"><a href="#AbsSeqNetwork-1420"><span class="linenos">1420</span></a>
</span><span id="AbsSeqNetwork-1421"><a href="#AbsSeqNetwork-1421"><span class="linenos">1421</span></a>    <span class="k">def</span> <span class="nf">get_last_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1422"><a href="#AbsSeqNetwork-1422"><span class="linenos">1422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1423"><a href="#AbsSeqNetwork-1423"><span class="linenos">1423</span></a><span class="sd">        Procedure to get the last AbsLayerNode of the network.</span>
</span><span id="AbsSeqNetwork-1424"><a href="#AbsSeqNetwork-1424"><span class="linenos">1424</span></a>
</span><span id="AbsSeqNetwork-1425"><a href="#AbsSeqNetwork-1425"><span class="linenos">1425</span></a><span class="sd">        Return</span>
</span><span id="AbsSeqNetwork-1426"><a href="#AbsSeqNetwork-1426"><span class="linenos">1426</span></a><span class="sd">        ---------</span>
</span><span id="AbsSeqNetwork-1427"><a href="#AbsSeqNetwork-1427"><span class="linenos">1427</span></a><span class="sd">        AbsLayerNode</span>
</span><span id="AbsSeqNetwork-1428"><a href="#AbsSeqNetwork-1428"><span class="linenos">1428</span></a><span class="sd">            The last node of the network.</span>
</span><span id="AbsSeqNetwork-1429"><a href="#AbsSeqNetwork-1429"><span class="linenos">1429</span></a>
</span><span id="AbsSeqNetwork-1430"><a href="#AbsSeqNetwork-1430"><span class="linenos">1430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1431"><a href="#AbsSeqNetwork-1431"><span class="linenos">1431</span></a>
</span><span id="AbsSeqNetwork-1432"><a href="#AbsSeqNetwork-1432"><span class="linenos">1432</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="AbsSeqNetwork-1433"><a href="#AbsSeqNetwork-1433"><span class="linenos">1433</span></a>
</span><span id="AbsSeqNetwork-1434"><a href="#AbsSeqNetwork-1434"><span class="linenos">1434</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="AbsSeqNetwork-1435"><a href="#AbsSeqNetwork-1435"><span class="linenos">1435</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1436"><a href="#AbsSeqNetwork-1436"><span class="linenos">1436</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span><span id="AbsSeqNetwork-1437"><a href="#AbsSeqNetwork-1437"><span class="linenos">1437</span></a>
</span><span id="AbsSeqNetwork-1438"><a href="#AbsSeqNetwork-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">current_node</span>
</span><span id="AbsSeqNetwork-1439"><a href="#AbsSeqNetwork-1439"><span class="linenos">1439</span></a>
</span><span id="AbsSeqNetwork-1440"><a href="#AbsSeqNetwork-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1441"><a href="#AbsSeqNetwork-1441"><span class="linenos">1441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1442"><a href="#AbsSeqNetwork-1442"><span class="linenos">1442</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsSeqNetwork-1443"><a href="#AbsSeqNetwork-1443"><span class="linenos">1443</span></a><span class="sd">        concrete abstract transformers.</span>
</span><span id="AbsSeqNetwork-1444"><a href="#AbsSeqNetwork-1444"><span class="linenos">1444</span></a>
</span><span id="AbsSeqNetwork-1445"><a href="#AbsSeqNetwork-1445"><span class="linenos">1445</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSeqNetwork-1446"><a href="#AbsSeqNetwork-1446"><span class="linenos">1446</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork-1447"><a href="#AbsSeqNetwork-1447"><span class="linenos">1447</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsSeqNetwork-1448"><a href="#AbsSeqNetwork-1448"><span class="linenos">1448</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsSeqNetwork-1449"><a href="#AbsSeqNetwork-1449"><span class="linenos">1449</span></a>
</span><span id="AbsSeqNetwork-1450"><a href="#AbsSeqNetwork-1450"><span class="linenos">1450</span></a><span class="sd">        Returns</span>
</span><span id="AbsSeqNetwork-1451"><a href="#AbsSeqNetwork-1451"><span class="linenos">1451</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork-1452"><a href="#AbsSeqNetwork-1452"><span class="linenos">1452</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsSeqNetwork-1453"><a href="#AbsSeqNetwork-1453"><span class="linenos">1453</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsSeqNetwork-1454"><a href="#AbsSeqNetwork-1454"><span class="linenos">1454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1455"><a href="#AbsSeqNetwork-1455"><span class="linenos">1455</span></a>
</span><span id="AbsSeqNetwork-1456"><a href="#AbsSeqNetwork-1456"><span class="linenos">1456</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="AbsSeqNetwork-1457"><a href="#AbsSeqNetwork-1457"><span class="linenos">1457</span></a>        <span class="k">while</span> <span class="n">current_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSeqNetwork-1458"><a href="#AbsSeqNetwork-1458"><span class="linenos">1458</span></a>            <span class="n">abs_input</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsSeqNetwork-1459"><a href="#AbsSeqNetwork-1459"><span class="linenos">1459</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span><span id="AbsSeqNetwork-1460"><a href="#AbsSeqNetwork-1460"><span class="linenos">1460</span></a>
</span><span id="AbsSeqNetwork-1461"><a href="#AbsSeqNetwork-1461"><span class="linenos">1461</span></a>        <span class="k">return</span> <span class="n">abs_input</span>
</span><span id="AbsSeqNetwork-1462"><a href="#AbsSeqNetwork-1462"><span class="linenos">1462</span></a>
</span><span id="AbsSeqNetwork-1463"><a href="#AbsSeqNetwork-1463"><span class="linenos">1463</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsSeqNetwork-1464"><a href="#AbsSeqNetwork-1464"><span class="linenos">1464</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1465"><a href="#AbsSeqNetwork-1465"><span class="linenos">1465</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsSeqNetwork-1466"><a href="#AbsSeqNetwork-1466"><span class="linenos">1466</span></a>
</span><span id="AbsSeqNetwork-1467"><a href="#AbsSeqNetwork-1467"><span class="linenos">1467</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSeqNetwork-1468"><a href="#AbsSeqNetwork-1468"><span class="linenos">1468</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork-1469"><a href="#AbsSeqNetwork-1469"><span class="linenos">1469</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsSeqNetwork-1470"><a href="#AbsSeqNetwork-1470"><span class="linenos">1470</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsSeqNetwork-1471"><a href="#AbsSeqNetwork-1471"><span class="linenos">1471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork-1472"><a href="#AbsSeqNetwork-1472"><span class="linenos">1472</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Concrete children of AbsNeuralNetwork representing a sequential AbsNeuralNetwork.
It consists of a graph of LayerNodes. The computational graph of a SequentialNetwork must
correspond to a standard list. The method forward and backward calls the corresponding methods
in the AbsLayerNodes following the correct order to compute the output AbsElement.</p>

<h2 id="attributes">Attributes</h2>

<p>identifier : str
    Identifier of the Sequential AbsNeuralNetwork.</p>

<h2 id="methods">Methods</h2>

<p>add_node(SingleInputLayerNode)
    Procedure to add a new AbsLayerNode to the sequential AbsNeuralNetwork.</p>

<p>get_first_node()
    Procedure to extract the first AbsLayerNode of the sequential AbsNeuralNetwork.</p>

<p>get_next_node(SingleInputLayerNode)
    Procedure to get the next AbsLayerNode of the AbsNeuralNetwork given an input AbsLayerNode</p>

<p>get_last_node()
    Procedure to extract the last AbsLayerNode of the sequential AbsNeuralNetwork.</p>

<p>forward(AbsElement)
    Function which takes an AbsElement and compute the corresponding output AbsElement based on the AbsLayerNode
    of the network.</p>

<p>backward(RefinementState)
    Function which takes a reference to the refinement state and update both it and the state of the AbsLayerNodes
    to control the refinement component of the abstraction. At present the function is just a placeholder for
    future implementations.</p>
</div>


                            <div id="AbsSeqNetwork.__init__" class="classattr">
                                        <input id="AbsSeqNetwork.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AbsSeqNetwork</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="AbsSeqNetwork.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.__init__-1351"><a href="#AbsSeqNetwork.__init__-1351"><span class="linenos">1351</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="AbsSeqNetwork.__init__-1352"><a href="#AbsSeqNetwork.__init__-1352"><span class="linenos">1352</span></a>
</span><span id="AbsSeqNetwork.__init__-1353"><a href="#AbsSeqNetwork.__init__-1353"><span class="linenos">1353</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="AbsSeqNetwork.__init__-1354"><a href="#AbsSeqNetwork.__init__-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
</span></pre></div>


    

                            </div>
                            <div id="AbsSeqNetwork.identifier" class="classattr">
                                <div class="attr variable">
            <span class="name">identifier</span>

        
    </div>
    <a class="headerlink" href="#AbsSeqNetwork.identifier"></a>
    
    

                            </div>
                            <div id="AbsSeqNetwork.add_node" class="classattr">
                                        <input id="AbsSeqNetwork.add_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_node</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node</span><span class="p">:</span> <span class="n"><a href="#AbsLayerNode">AbsLayerNode</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsSeqNetwork.add_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.add_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.add_node-1356"><a href="#AbsSeqNetwork.add_node-1356"><span class="linenos">1356</span></a>    <span class="k">def</span> <span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AbsLayerNode</span><span class="p">):</span>
</span><span id="AbsSeqNetwork.add_node-1357"><a href="#AbsSeqNetwork.add_node-1357"><span class="linenos">1357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.add_node-1358"><a href="#AbsSeqNetwork.add_node-1358"><span class="linenos">1358</span></a><span class="sd">        Procedure to add a new AbsLayerNode. In sequential network the new node must be connected directly to the</span>
</span><span id="AbsSeqNetwork.add_node-1359"><a href="#AbsSeqNetwork.add_node-1359"><span class="linenos">1359</span></a><span class="sd">        previous node forming a list.</span>
</span><span id="AbsSeqNetwork.add_node-1360"><a href="#AbsSeqNetwork.add_node-1360"><span class="linenos">1360</span></a>
</span><span id="AbsSeqNetwork.add_node-1361"><a href="#AbsSeqNetwork.add_node-1361"><span class="linenos">1361</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSeqNetwork.add_node-1362"><a href="#AbsSeqNetwork.add_node-1362"><span class="linenos">1362</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork.add_node-1363"><a href="#AbsSeqNetwork.add_node-1363"><span class="linenos">1363</span></a><span class="sd">        node : AbsLayerNode</span>
</span><span id="AbsSeqNetwork.add_node-1364"><a href="#AbsSeqNetwork.add_node-1364"><span class="linenos">1364</span></a><span class="sd">            New node to add to the Sequential network.</span>
</span><span id="AbsSeqNetwork.add_node-1365"><a href="#AbsSeqNetwork.add_node-1365"><span class="linenos">1365</span></a>
</span><span id="AbsSeqNetwork.add_node-1366"><a href="#AbsSeqNetwork.add_node-1366"><span class="linenos">1366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.add_node-1367"><a href="#AbsSeqNetwork.add_node-1367"><span class="linenos">1367</span></a>
</span><span id="AbsSeqNetwork.add_node-1368"><a href="#AbsSeqNetwork.add_node-1368"><span class="linenos">1368</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.add_node-1369"><a href="#AbsSeqNetwork.add_node-1369"><span class="linenos">1369</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="AbsSeqNetwork.add_node-1370"><a href="#AbsSeqNetwork.add_node-1370"><span class="linenos">1370</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AbsSeqNetwork.add_node-1371"><a href="#AbsSeqNetwork.add_node-1371"><span class="linenos">1371</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.add_node-1372"><a href="#AbsSeqNetwork.add_node-1372"><span class="linenos">1372</span></a>            <span class="n">previous_node_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_node</span><span class="p">()</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="AbsSeqNetwork.add_node-1373"><a href="#AbsSeqNetwork.add_node-1373"><span class="linenos">1373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="AbsSeqNetwork.add_node-1374"><a href="#AbsSeqNetwork.add_node-1374"><span class="linenos">1374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">previous_node_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>
</span><span id="AbsSeqNetwork.add_node-1375"><a href="#AbsSeqNetwork.add_node-1375"><span class="linenos">1375</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Procedure to add a new AbsLayerNode. In sequential network the new node must be connected directly to the
previous node forming a list.</p>

<h2 id="parameters">Parameters</h2>

<p>node : AbsLayerNode
    New node to add to the Sequential network.</p>
</div>


                            </div>
                            <div id="AbsSeqNetwork.get_first_node" class="classattr">
                                        <input id="AbsSeqNetwork.get_first_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_first_node</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsLayerNode">AbsLayerNode</a></span>:</span></span>

                <label class="view-source-button" for="AbsSeqNetwork.get_first_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.get_first_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.get_first_node-1377"><a href="#AbsSeqNetwork.get_first_node-1377"><span class="linenos">1377</span></a>    <span class="k">def</span> <span class="nf">get_first_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_first_node-1378"><a href="#AbsSeqNetwork.get_first_node-1378"><span class="linenos">1378</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.get_first_node-1379"><a href="#AbsSeqNetwork.get_first_node-1379"><span class="linenos">1379</span></a><span class="sd">        Procedure to get the first AbsLayerNode of the network.</span>
</span><span id="AbsSeqNetwork.get_first_node-1380"><a href="#AbsSeqNetwork.get_first_node-1380"><span class="linenos">1380</span></a>
</span><span id="AbsSeqNetwork.get_first_node-1381"><a href="#AbsSeqNetwork.get_first_node-1381"><span class="linenos">1381</span></a><span class="sd">        Return</span>
</span><span id="AbsSeqNetwork.get_first_node-1382"><a href="#AbsSeqNetwork.get_first_node-1382"><span class="linenos">1382</span></a><span class="sd">        ---------</span>
</span><span id="AbsSeqNetwork.get_first_node-1383"><a href="#AbsSeqNetwork.get_first_node-1383"><span class="linenos">1383</span></a><span class="sd">        AbsLayerNode</span>
</span><span id="AbsSeqNetwork.get_first_node-1384"><a href="#AbsSeqNetwork.get_first_node-1384"><span class="linenos">1384</span></a><span class="sd">            The first node of the network.</span>
</span><span id="AbsSeqNetwork.get_first_node-1385"><a href="#AbsSeqNetwork.get_first_node-1385"><span class="linenos">1385</span></a>
</span><span id="AbsSeqNetwork.get_first_node-1386"><a href="#AbsSeqNetwork.get_first_node-1386"><span class="linenos">1386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.get_first_node-1387"><a href="#AbsSeqNetwork.get_first_node-1387"><span class="linenos">1387</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="AbsSeqNetwork.get_first_node-1388"><a href="#AbsSeqNetwork.get_first_node-1388"><span class="linenos">1388</span></a>
</span><span id="AbsSeqNetwork.get_first_node-1389"><a href="#AbsSeqNetwork.get_first_node-1389"><span class="linenos">1389</span></a>        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="AbsSeqNetwork.get_first_node-1390"><a href="#AbsSeqNetwork.get_first_node-1390"><span class="linenos">1390</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="AbsSeqNetwork.get_first_node-1391"><a href="#AbsSeqNetwork.get_first_node-1391"><span class="linenos">1391</span></a>            <span class="k">for</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="AbsSeqNetwork.get_first_node-1392"><a href="#AbsSeqNetwork.get_first_node-1392"><span class="linenos">1392</span></a>                <span class="k">if</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="AbsSeqNetwork.get_first_node-1393"><a href="#AbsSeqNetwork.get_first_node-1393"><span class="linenos">1393</span></a>                    <span class="n">keys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sub_key</span><span class="p">)</span>
</span><span id="AbsSeqNetwork.get_first_node-1394"><a href="#AbsSeqNetwork.get_first_node-1394"><span class="linenos">1394</span></a>
</span><span id="AbsSeqNetwork.get_first_node-1395"><a href="#AbsSeqNetwork.get_first_node-1395"><span class="linenos">1395</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Procedure to get the first AbsLayerNode of the network.</p>

<h2 id="return">Return</h2>

<p>AbsLayerNode
    The first node of the network.</p>
</div>


                            </div>
                            <div id="AbsSeqNetwork.get_next_node" class="classattr">
                                        <input id="AbsSeqNetwork.get_next_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_next_node</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node</span><span class="p">:</span> <span class="n"><a href="#AbsLayerNode">AbsLayerNode</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsLayerNode">AbsLayerNode</a></span>:</span></span>

                <label class="view-source-button" for="AbsSeqNetwork.get_next_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.get_next_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.get_next_node-1397"><a href="#AbsSeqNetwork.get_next_node-1397"><span class="linenos">1397</span></a>    <span class="k">def</span> <span class="nf">get_next_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">AbsLayerNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_next_node-1398"><a href="#AbsSeqNetwork.get_next_node-1398"><span class="linenos">1398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.get_next_node-1399"><a href="#AbsSeqNetwork.get_next_node-1399"><span class="linenos">1399</span></a><span class="sd">        Procedure to get the next AbsLayerNode of the network given an input AbsLayerNode.</span>
</span><span id="AbsSeqNetwork.get_next_node-1400"><a href="#AbsSeqNetwork.get_next_node-1400"><span class="linenos">1400</span></a>
</span><span id="AbsSeqNetwork.get_next_node-1401"><a href="#AbsSeqNetwork.get_next_node-1401"><span class="linenos">1401</span></a><span class="sd">        Return</span>
</span><span id="AbsSeqNetwork.get_next_node-1402"><a href="#AbsSeqNetwork.get_next_node-1402"><span class="linenos">1402</span></a><span class="sd">        ---------</span>
</span><span id="AbsSeqNetwork.get_next_node-1403"><a href="#AbsSeqNetwork.get_next_node-1403"><span class="linenos">1403</span></a><span class="sd">        SingleInputLayerNode</span>
</span><span id="AbsSeqNetwork.get_next_node-1404"><a href="#AbsSeqNetwork.get_next_node-1404"><span class="linenos">1404</span></a><span class="sd">            The next node of the network.</span>
</span><span id="AbsSeqNetwork.get_next_node-1405"><a href="#AbsSeqNetwork.get_next_node-1405"><span class="linenos">1405</span></a>
</span><span id="AbsSeqNetwork.get_next_node-1406"><a href="#AbsSeqNetwork.get_next_node-1406"><span class="linenos">1406</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.get_next_node-1407"><a href="#AbsSeqNetwork.get_next_node-1407"><span class="linenos">1407</span></a>
</span><span id="AbsSeqNetwork.get_next_node-1408"><a href="#AbsSeqNetwork.get_next_node-1408"><span class="linenos">1408</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="AbsSeqNetwork.get_next_node-1409"><a href="#AbsSeqNetwork.get_next_node-1409"><span class="linenos">1409</span></a>
</span><span id="AbsSeqNetwork.get_next_node-1410"><a href="#AbsSeqNetwork.get_next_node-1410"><span class="linenos">1410</span></a>        <span class="n">next_node</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AbsSeqNetwork.get_next_node-1411"><a href="#AbsSeqNetwork.get_next_node-1411"><span class="linenos">1411</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_next_node-1412"><a href="#AbsSeqNetwork.get_next_node-1412"><span class="linenos">1412</span></a>            <span class="n">current_key</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="AbsSeqNetwork.get_next_node-1413"><a href="#AbsSeqNetwork.get_next_node-1413"><span class="linenos">1413</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">current_key</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_next_node-1414"><a href="#AbsSeqNetwork.get_next_node-1414"><span class="linenos">1414</span></a>                <span class="n">next_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">current_key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AbsSeqNetwork.get_next_node-1415"><a href="#AbsSeqNetwork.get_next_node-1415"><span class="linenos">1415</span></a>                <span class="n">next_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">next_key</span><span class="p">]</span>
</span><span id="AbsSeqNetwork.get_next_node-1416"><a href="#AbsSeqNetwork.get_next_node-1416"><span class="linenos">1416</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_next_node-1417"><a href="#AbsSeqNetwork.get_next_node-1417"><span class="linenos">1417</span></a>            <span class="n">next_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="AbsSeqNetwork.get_next_node-1418"><a href="#AbsSeqNetwork.get_next_node-1418"><span class="linenos">1418</span></a>
</span><span id="AbsSeqNetwork.get_next_node-1419"><a href="#AbsSeqNetwork.get_next_node-1419"><span class="linenos">1419</span></a>        <span class="k">return</span> <span class="n">next_node</span>
</span></pre></div>


            <div class="docstring"><p>Procedure to get the next AbsLayerNode of the network given an input AbsLayerNode.</p>

<h2 id="return">Return</h2>

<p>SingleInputLayerNode
    The next node of the network.</p>
</div>


                            </div>
                            <div id="AbsSeqNetwork.get_last_node" class="classattr">
                                        <input id="AbsSeqNetwork.get_last_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_last_node</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsLayerNode">AbsLayerNode</a></span>:</span></span>

                <label class="view-source-button" for="AbsSeqNetwork.get_last_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.get_last_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.get_last_node-1421"><a href="#AbsSeqNetwork.get_last_node-1421"><span class="linenos">1421</span></a>    <span class="k">def</span> <span class="nf">get_last_node</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsLayerNode</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_last_node-1422"><a href="#AbsSeqNetwork.get_last_node-1422"><span class="linenos">1422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.get_last_node-1423"><a href="#AbsSeqNetwork.get_last_node-1423"><span class="linenos">1423</span></a><span class="sd">        Procedure to get the last AbsLayerNode of the network.</span>
</span><span id="AbsSeqNetwork.get_last_node-1424"><a href="#AbsSeqNetwork.get_last_node-1424"><span class="linenos">1424</span></a>
</span><span id="AbsSeqNetwork.get_last_node-1425"><a href="#AbsSeqNetwork.get_last_node-1425"><span class="linenos">1425</span></a><span class="sd">        Return</span>
</span><span id="AbsSeqNetwork.get_last_node-1426"><a href="#AbsSeqNetwork.get_last_node-1426"><span class="linenos">1426</span></a><span class="sd">        ---------</span>
</span><span id="AbsSeqNetwork.get_last_node-1427"><a href="#AbsSeqNetwork.get_last_node-1427"><span class="linenos">1427</span></a><span class="sd">        AbsLayerNode</span>
</span><span id="AbsSeqNetwork.get_last_node-1428"><a href="#AbsSeqNetwork.get_last_node-1428"><span class="linenos">1428</span></a><span class="sd">            The last node of the network.</span>
</span><span id="AbsSeqNetwork.get_last_node-1429"><a href="#AbsSeqNetwork.get_last_node-1429"><span class="linenos">1429</span></a>
</span><span id="AbsSeqNetwork.get_last_node-1430"><a href="#AbsSeqNetwork.get_last_node-1430"><span class="linenos">1430</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.get_last_node-1431"><a href="#AbsSeqNetwork.get_last_node-1431"><span class="linenos">1431</span></a>
</span><span id="AbsSeqNetwork.get_last_node-1432"><a href="#AbsSeqNetwork.get_last_node-1432"><span class="linenos">1432</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
</span><span id="AbsSeqNetwork.get_last_node-1433"><a href="#AbsSeqNetwork.get_last_node-1433"><span class="linenos">1433</span></a>
</span><span id="AbsSeqNetwork.get_last_node-1434"><a href="#AbsSeqNetwork.get_last_node-1434"><span class="linenos">1434</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="AbsSeqNetwork.get_last_node-1435"><a href="#AbsSeqNetwork.get_last_node-1435"><span class="linenos">1435</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.get_last_node-1436"><a href="#AbsSeqNetwork.get_last_node-1436"><span class="linenos">1436</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span><span id="AbsSeqNetwork.get_last_node-1437"><a href="#AbsSeqNetwork.get_last_node-1437"><span class="linenos">1437</span></a>
</span><span id="AbsSeqNetwork.get_last_node-1438"><a href="#AbsSeqNetwork.get_last_node-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">current_node</span>
</span></pre></div>


            <div class="docstring"><p>Procedure to get the last AbsLayerNode of the network.</p>

<h2 id="return">Return</h2>

<p>AbsLayerNode
    The last node of the network.</p>
</div>


                            </div>
                            <div id="AbsSeqNetwork.forward" class="classattr">
                                        <input id="AbsSeqNetwork.forward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">forward</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">abs_input</span><span class="p">:</span> <span class="n"><a href="#AbsElement">AbsElement</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#AbsElement">AbsElement</a></span>:</span></span>

                <label class="view-source-button" for="AbsSeqNetwork.forward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.forward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.forward-1440"><a href="#AbsSeqNetwork.forward-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abs_input</span><span class="p">:</span> <span class="n">AbsElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbsElement</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.forward-1441"><a href="#AbsSeqNetwork.forward-1441"><span class="linenos">1441</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.forward-1442"><a href="#AbsSeqNetwork.forward-1442"><span class="linenos">1442</span></a><span class="sd">        Compute the output AbsElement based on the input AbsElement and the characteristics of the</span>
</span><span id="AbsSeqNetwork.forward-1443"><a href="#AbsSeqNetwork.forward-1443"><span class="linenos">1443</span></a><span class="sd">        concrete abstract transformers.</span>
</span><span id="AbsSeqNetwork.forward-1444"><a href="#AbsSeqNetwork.forward-1444"><span class="linenos">1444</span></a>
</span><span id="AbsSeqNetwork.forward-1445"><a href="#AbsSeqNetwork.forward-1445"><span class="linenos">1445</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSeqNetwork.forward-1446"><a href="#AbsSeqNetwork.forward-1446"><span class="linenos">1446</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork.forward-1447"><a href="#AbsSeqNetwork.forward-1447"><span class="linenos">1447</span></a><span class="sd">        abs_input : AbsElement</span>
</span><span id="AbsSeqNetwork.forward-1448"><a href="#AbsSeqNetwork.forward-1448"><span class="linenos">1448</span></a><span class="sd">            The input abstract element.</span>
</span><span id="AbsSeqNetwork.forward-1449"><a href="#AbsSeqNetwork.forward-1449"><span class="linenos">1449</span></a>
</span><span id="AbsSeqNetwork.forward-1450"><a href="#AbsSeqNetwork.forward-1450"><span class="linenos">1450</span></a><span class="sd">        Returns</span>
</span><span id="AbsSeqNetwork.forward-1451"><a href="#AbsSeqNetwork.forward-1451"><span class="linenos">1451</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork.forward-1452"><a href="#AbsSeqNetwork.forward-1452"><span class="linenos">1452</span></a><span class="sd">        AbsElement</span>
</span><span id="AbsSeqNetwork.forward-1453"><a href="#AbsSeqNetwork.forward-1453"><span class="linenos">1453</span></a><span class="sd">            The AbsElement resulting from the computation corresponding to the abstract transformer.</span>
</span><span id="AbsSeqNetwork.forward-1454"><a href="#AbsSeqNetwork.forward-1454"><span class="linenos">1454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.forward-1455"><a href="#AbsSeqNetwork.forward-1455"><span class="linenos">1455</span></a>
</span><span id="AbsSeqNetwork.forward-1456"><a href="#AbsSeqNetwork.forward-1456"><span class="linenos">1456</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_first_node</span><span class="p">()</span>
</span><span id="AbsSeqNetwork.forward-1457"><a href="#AbsSeqNetwork.forward-1457"><span class="linenos">1457</span></a>        <span class="k">while</span> <span class="n">current_node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsSeqNetwork.forward-1458"><a href="#AbsSeqNetwork.forward-1458"><span class="linenos">1458</span></a>            <span class="n">abs_input</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">abs_input</span><span class="p">)</span>
</span><span id="AbsSeqNetwork.forward-1459"><a href="#AbsSeqNetwork.forward-1459"><span class="linenos">1459</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_next_node</span><span class="p">(</span><span class="n">current_node</span><span class="p">)</span>
</span><span id="AbsSeqNetwork.forward-1460"><a href="#AbsSeqNetwork.forward-1460"><span class="linenos">1460</span></a>
</span><span id="AbsSeqNetwork.forward-1461"><a href="#AbsSeqNetwork.forward-1461"><span class="linenos">1461</span></a>        <span class="k">return</span> <span class="n">abs_input</span>
</span></pre></div>


            <div class="docstring"><p>Compute the output AbsElement based on the input AbsElement and the characteristics of the
concrete abstract transformers.</p>

<h2 id="parameters">Parameters</h2>

<p>abs_input : AbsElement
    The input abstract element.</p>

<h2 id="returns">Returns</h2>

<p>AbsElement
    The AbsElement resulting from the computation corresponding to the abstract transformer.</p>
</div>


                            </div>
                            <div id="AbsSeqNetwork.backward" class="classattr">
                                        <input id="AbsSeqNetwork.backward-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">backward</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ref_state</span><span class="p">:</span> <span class="n"><a href="#RefinementState">RefinementState</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsSeqNetwork.backward-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsSeqNetwork.backward"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsSeqNetwork.backward-1463"><a href="#AbsSeqNetwork.backward-1463"><span class="linenos">1463</span></a>    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_state</span><span class="p">:</span> <span class="n">RefinementState</span><span class="p">):</span>
</span><span id="AbsSeqNetwork.backward-1464"><a href="#AbsSeqNetwork.backward-1464"><span class="linenos">1464</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.backward-1465"><a href="#AbsSeqNetwork.backward-1465"><span class="linenos">1465</span></a><span class="sd">        Update the RefinementState. At present the function is just a placeholder for future implementations.</span>
</span><span id="AbsSeqNetwork.backward-1466"><a href="#AbsSeqNetwork.backward-1466"><span class="linenos">1466</span></a>
</span><span id="AbsSeqNetwork.backward-1467"><a href="#AbsSeqNetwork.backward-1467"><span class="linenos">1467</span></a><span class="sd">        Parameters</span>
</span><span id="AbsSeqNetwork.backward-1468"><a href="#AbsSeqNetwork.backward-1468"><span class="linenos">1468</span></a><span class="sd">        ----------</span>
</span><span id="AbsSeqNetwork.backward-1469"><a href="#AbsSeqNetwork.backward-1469"><span class="linenos">1469</span></a><span class="sd">        ref_state: RefinementState</span>
</span><span id="AbsSeqNetwork.backward-1470"><a href="#AbsSeqNetwork.backward-1470"><span class="linenos">1470</span></a><span class="sd">            The RefinementState to update.</span>
</span><span id="AbsSeqNetwork.backward-1471"><a href="#AbsSeqNetwork.backward-1471"><span class="linenos">1471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AbsSeqNetwork.backward-1472"><a href="#AbsSeqNetwork.backward-1472"><span class="linenos">1472</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Update the RefinementState. At present the function is just a placeholder for future implementations.</p>

<h2 id="parameters">Parameters</h2>

<p>ref_state: RefinementState
    The RefinementState to update.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#AbsNeuralNetwork">AbsNeuralNetwork</a></dt>
                                <dd id="AbsSeqNetwork.nodes" class="variable"><a href="#AbsNeuralNetwork.nodes">nodes</a></dd>
                <dd id="AbsSeqNetwork.edges" class="variable"><a href="#AbsNeuralNetwork.edges">edges</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>